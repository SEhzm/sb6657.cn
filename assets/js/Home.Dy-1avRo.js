const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/wordCloud.D4cyIC9E.js","assets/js/echarts.D13McHMB.js","assets/js/zrender.B_NAtvFA.js","assets/js/tslib.BDyQ-Jie.js","assets/js/echarts-wordcloud.tk4DMxWl.js","assets/js/index.uyXwXNh9.js","assets/js/@vue.BltuATdo.js","assets/js/pinia.DfSVr1RC.js","assets/js/axios.ngrFHoWO.js","assets/js/js-cookie.Cz0CWeBA.js","assets/js/element-plus.DQRrSmQa.js","assets/js/lodash-es.CDeyng3v.js","assets/js/@vueuse.7i1SIcsD.js","assets/js/@element-plus.BgPfl9pw.js","assets/js/@popperjs.D_chPuIy.js","assets/js/@ctrl.r5W6hzzQ.js","assets/js/dayjs.BKG3DVjA.js","assets/js/async-validator.9PlIezaS.js","assets/js/memoize-one.BdPwpGay.js","assets/js/normalize-wheel-es.BQoi3Ox2.js","assets/js/@floating-ui.D0iZPv2f.js","assets/js/vue-router.oDprkwHL.js","assets/css/index.C0sUvfrJ.css","assets/css/wordCloud.qpx4COKE.css"])))=>i.map(i=>d[i]);
import{_ as se,C as oe,h as M,A as U,b as le}from"./index.uyXwXNh9.js";import{h as m,l as ne,f as re,al as b,c,o as n,aU as ie,a as t,R as s,J as l,u as _,E as ce,P as p,L as N,Q as A,a6 as B,O as u,W as de,I,aV as ue,aI as me}from"./@vue.BltuATdo.js";import{S as q,T as W,F as j}from"./@element-plus.BgPfl9pw.js";import{f as ve,t as pe}from"./flip-num.MKDMjiBh.js";import{c as fe,a as be,p as G,l as _e,b as he}from"./setMeme.DaQB3076.js";import{u as ge}from"./memeTags.Br-s2yM3.js";import{b as h}from"./element-plus.DQRrSmQa.js";import"./pinia.DfSVr1RC.js";import"./axios.ngrFHoWO.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.oDprkwHL.js";import"./lodash-es.CDeyng3v.js";import"./@vueuse.7i1SIcsD.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";const ye={class:"home"},ke={class:"card third-card"},Ce={class:"random-barrage-header"},De={class:"refresh-controls"},Ee={key:0,class:"modern-barrage-container"},we={class:"barrage-main-content"},Te={class:"barrage-text-wrapper"},xe={class:"barrage-text"},Me={class:"barrage-meta-info"},Ve={key:0,class:"tags-container"},Se=["src"],Re={class:"tag-label"},Ue={class:"submit-time"},Ne={class:"meme-id"},Ae={class:"copy-count"},Be={key:1,class:"no-data"},Ie={class:"card fifth-card"},ze={class:"preset-tags-container"},Le={class:"preset-tags"},Pe={class:"tag-icon-wrapper"},$e=["src"],Fe={class:"tag-text"},Oe={class:"added-tags"},qe={class:"match-association-container"},We={class:"match-section-home"},je={key:0,class:"match-details-box-home"},Ge={class:"match-info-row-home"},He=["src","alt"],Je={class:"match-name-home"},Qe={class:"match-time-home"},Ke={key:1,class:"no-match-info-home"},Xe={class:"wordCloudDiv"},Ye={class:"word-cloud-title"},Ze={__name:"Home",setup(et){const w=ge(),k=m(!0),V=m(!1),r=ne({tableData:[]}),S=m([]);w.tagsLoaded.then(()=>{console.log("dictData",w.memeTags),S.value=w.memeTags,C.value=w.memeTags.map(a=>({iconUrl:a.iconUrl,label:a.dictLabel,value:a.dictValue}))});const z=a=>{if(!a||a.trim()==="")return[];const e=Array.from(new Set(a.split(",").map(v=>v.trim())));if(!S.value)return e.map(()=>({label:"",iconUrl:""}));const d=new Map(S.value.map(v=>[String(v.dictValue).trim(),v]));return e.map(v=>{const y=d.get(v);return y?{label:y.dictLabel,iconUrl:y.iconUrl}:{label:"",iconUrl:""}})},g=m(""),C=m([]),D=m([]),f=m([]),i=m(null),T=m(!1);function H(){M.get("/machine/InProgressMatch").then(a=>{a.code===200&&a.data?i.value=a.data:i.value=null,console.log("Fetched match data:",i.value)}).catch(a=>{console.error("Failed to fetch in progress match:",a),i.value=null})}re(()=>{H()});const L=a=>{D.value=D.value.filter(e=>e.value!==a.value),f.value=f.value.filter(e=>e!==a.value),C.value.push(a)},P=a=>{if(f.value.length>=5){h.info("最多5个标签");return}D.value.some(e=>e.value===a.value)||(D.value.push(a),f.value.push(a.value),C.value=C.value.filter(e=>e.value!==a.value))},J=()=>{if(f.value.length===0||g.value===""||g.value===null)h.error("请选择标签或输入弹幕");else{if(f.value.length>5){h.error("最少一个标签，最多五个标签。");return}const a={tags:f.value.join(","),barrage:g.value};T.value&&i.value&&(a.matchId=i.value.id),M.post(U.SUBMIT_MEME,a).then(e=>{g.value="",T.value=!1,e.code===200?h.success("投稿成功，待审核(一天内)"):e.code===500?h.error("烂梗已经有了，勿重复提交"):h.error("请求失败")}).catch(e=>{console.error("投稿失败",e),h.error("请求失败")})}},Q=()=>{M.get(U.GET_RAND_ONE_MEME).then(a=>{r.tableData=[a.data],k.value=!1}).catch(a=>{console.error("随机失败")})},$=async()=>{if(!k.value){V.value=!0,k.value=!0;try{await M.get(U.GET_RAND_ONE_MEME).then(a=>{r.tableData=[a.data],k.value=!1})}catch{console.error("随机失败"),k.value=!1}setTimeout(()=>{V.value=!1},600)}},K=pe(he,_e,2e3);async function F(a){const e=K(a.barrage);if(!(!e||e==="limitedSuccess")){fe();try{await be("",a.id)?r.tableData[0].cnt=`${+r.tableData[0].cnt+1}`:G()}catch(d){console.error("更新复制计数失败:",d),G()}}}Q();const O=m(null),X=ue(()=>le(()=>import("./wordCloud.D4cyIC9E.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])));function Y(){var a,e;(e=(a=O.value)==null?void 0:a.getData)==null||e.call(a)}const Z=a=>a?a.replace("T"," ").split(".")[0]:"";return(a,e)=>{const d=b("el-icon"),x=b("el-popover"),v=b("el-button"),y=b("el-tag"),ee=b("el-input"),te=b("el-checkbox"),ae=b("el-backtop");return n(),c("div",ye,[e[22]||(e[22]=ie('<div class="boomouder" data-v-98e1c5e7><img src="https://gcore.jsdelivr.net/gh/9WiSHao/AnythingStorage/img/6657boom.webp" alt="6657boom" class="boom6657" data-v-98e1c5e7></div><div class="card first-card" data-v-98e1c5e7><div data-v-98e1c5e7><b data-v-98e1c5e7><p class="announcement" data-v-98e1c5e7> 因为GreasyFork被墙，你可以 <a href="https://cdn.hguofichp.cn/sb6657.cn%E6%96%97%E9%B1%BC%E7%8E%A9%E6%9C%BA%E5%99%A8%E7%83%82%E6%A2%97%E6%94%B6%E9%9B%86.user.js" target="_blank" data-v-98e1c5e7>点击我下载最新的油猴插件</a> ，你只需要将下载的文件拖入油猴管理面板即可 </p></b></div></div><div class="card second-card" data-v-98e1c5e7><p data-v-98e1c5e7> 这是一个收集6657烂梗的网站: <span class="dgq63136" data-v-98e1c5e7><a href="https://sb6657.cn" data-v-98e1c5e7>sb6657.cn</a></span> 尽情欣赏你们的烂梗吧。 <b data-v-98e1c5e7>开放注册功能，可能会出现收不到邮件的情况。</b><b data-v-98e1c5e7>目前已支持玩机器直播间开播提醒</b></p></div>',3)),t("div",ke,[t("div",Ce,[e[5]||(e[5]=t("h3",{class:"random-barrage-title"},"随机一条烂梗",-1)),t("div",De,[t("span",{class:"refresh-text",onClick:$},"换一换"),s(d,{class:ce(["refresh-icon",{rotating:V.value}]),onClick:$,size:"18"},{default:l(()=>[s(_(q))]),_:1},8,["class"])])]),r.tableData&&r.tableData.length>0?(n(),c("div",Ee,[t("div",{class:"modern-barrage-card",onClick:e[1]||(e[1]=o=>F(r.tableData[0]))},[t("div",we,[t("div",Te,[t("span",xe,p(r.tableData[0].barrage),1)]),t("div",Me,[z(r.tableData[0].tags).length>0?(n(),c("div",Ve,[(n(!0),c(A,null,B(z(r.tableData[0].tags),(o,E)=>(n(),c("div",{key:E,class:"modern-tag"},[o.iconUrl?(n(),c("img",{key:0,src:o.iconUrl,class:"tag-icon"},null,8,Se)):N("",!0),t("span",Re,p(o.label),1)]))),128))])):N("",!0),t("div",Ue,[t("span",Ne,"#"+p(r.tableData[0].id),1),u(p(Z(r.tableData[0].submitTime)),1)])])]),t("div",{class:"modern-copy-button",onClick:e[0]||(e[0]=de(o=>F(r.tableData[0]),["stop"]))},[e[6]||(e[6]=t("div",{class:"copy-text"},"复制",-1)),e[7]||(e[7]=t("div",{class:"copy-icon"},"📋",-1)),t("div",Ae,[s(ve,{num:r.tableData[0].cnt||0},null,8,["num"])]),e[8]||(e[8]=t("div",{class:"copy-ripple"},null,-1))])])])):(n(),c("div",Be,"暂无弹幕数据"))]),t("div",Ie,[t("div",null,[t("span",null,[e[15]||(e[15]=u(" 可选标签 ",-1)),s(x,{width:300},{reference:l(()=>[s(d,{size:"16"},{default:l(()=>[s(_(W))]),_:1})]),default:l(()=>[e[9]||(e[9]=u(" 为解决烂梗分栏不足和分类不清晰问题。 ",-1)),e[10]||(e[10]=t("br",null,null,-1)),e[11]||(e[11]=t("b",null,"点击标签即可添加",-1))]),_:1}),s(v,{link:"",type:"success",class:"submit-tag-button"},{default:l(()=>[e[14]||(e[14]=u(" 投稿标签 ",-1)),s(x,{width:300},{reference:l(()=>[s(d,{size:"16"},{default:l(()=>[s(_(j))]),_:1})]),default:l(()=>[e[12]||(e[12]=t("b",null,"请在上方(建议/提交)问卷投稿。",-1)),e[13]||(e[13]=t("br",null,null,-1))]),_:1})]),_:1})]),t("div",ze,[t("div",Le,[(n(!0),c(A,null,B(C.value,(o,E)=>(n(),I(y,{round:"",key:E,closable:"",onClose:R=>P(o),onClick:R=>P(o),class:"preset-tag",type:"primary"},{default:l(()=>[t("div",Pe,[o.iconUrl?(n(),c("img",{key:0,src:o.iconUrl,class:"tag-icon"},null,8,$e)):N("",!0),t("span",Fe,p(o.label),1)])]),_:2},1032,["onClose","onClick"]))),128))])]),t("span",null,[e[17]||(e[17]=u(" 已选标签 ",-1)),s(x,{width:250},{reference:l(()=>[s(d,{size:"16"},{default:l(()=>[s(_(W))]),_:1})]),default:l(()=>[e[16]||(e[16]=t("b",null,"最少一个标签，最多五个标签。",-1))]),_:1})]),t("div",Oe,[(n(!0),c(A,null,B(D.value,(o,E)=>(n(),I(y,{round:"",key:E,closable:"",onClick:R=>L(o),onClose:R=>L(o),class:"added-tag",effect:"dark"},{default:l(()=>[u(p(o.label),1)]),_:2},1032,["onClick","onClose"]))),128))]),s(ee,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=o=>g.value=o),maxlength:"255",autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea",placeholder:" 烂梗...."},null,8,["modelValue"]),t("div",qe,[t("div",We,[s(te,{modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=o=>T.value=o),disabled:!i.value,class:"match-checkbox-home"},{default:l(()=>[e[18]||(e[18]=u(" 关联赛事库 ",-1)),s(d,{color:"#3db302ff",size:"16"},{default:l(()=>[s(_(j))]),_:1})]),_:1},8,["modelValue","disabled"]),i.value?(n(),c("div",je,[t("div",Ge,[t("img",{src:i.value.matchesImg,class:"match-image-home",alt:i.value.matchesName},null,8,He),t("span",Je,p(i.value.matchesName),1)]),t("div",Qe,p(i.value.startTime)+" 至 "+p(i.value.endTime),1)])):(n(),c("div",Ke,"当前无正在进行的大型赛事")),s(v,{class:"saveBnt",type:"primary",onClick:J},{default:l(()=>[...e[19]||(e[19]=[u("投稿",-1)])]),_:1})])])]),s(ae,{right:50,bottom:50})]),s(oe,{class:"ChatRoom card"}),e[23]||(e[23]=t("div",{class:"card sixth-card"},[u(" 友情链接 "),t("a",{href:"https://dgq63136.cn",target:"_blank"},"dgq63136.cn"),u("     "),t("a",{href:"https://sb6657.cn/#/Starrysky",target:"_blank"},"星空背景")],-1)),t("div",Xe,[t("span",Ye,[e[20]||(e[20]=u(" 搜索词云 ",-1)),s(d,{size:"20",class:"word-cloud-refresh-icon",onClick:e[4]||(e[4]=o=>Y())},{default:l(()=>[s(_(q))]),_:1})]),(n(),I(me,null,{default:l(()=>[s(_(X),{ref_key:"wordCloudRef",ref:O},null,512)]),fallback:l(()=>[...e[21]||(e[21]=[t("div",{class:"word-cloud-loading"},"词云加载中...",-1)])]),_:1}))])])}}},kt=se(Ze,[["__scopeId","data-v-98e1c5e7"]]);export{kt as default};
