import{n as p,a as de,b as pe,f as me,h as fe,v as ve,o as K,E as ge,d as be,e as ye,g as he,p as _e}from"./element-plus.BOB1eDCd.js";import{o as c,c as m,r as f,X as xe,a as o,L as r,P as a,H as l,I as W,G as B,u as X,a5 as Ce,K as L,O as I,a4 as $,M as x,V as we,ag as G}from"./@vue.BkZGu_Ap.js";import{_ as Y,h as C,A as ke,C as Te}from"./index.Bq5RheCp.js";import{M as Ee}from"./@element-plus.imH8POSc.js";import{_ as Ie}from"./favicon.CJfgpdIL.js";import{f as Se,c as Ve,t as Me,l as Be,a as $e}from"./flip-num.BhPEbBfd.js";/* empty css                                                                 */import"./lodash-es.C-zDejYo.js";import"./@vueuse.B3BMR0ps.js";import"./@popperjs.D9SI2xQl.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.DXEKZA6n.js";import"./async-validator.DKvM95Vc.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.B6fDCfyv.js";import"./@floating-ui.8uccrNCM.js";import"./axios.CCb-kr4I.js";import"./vue-router.CJ_8Ucol.js";const De={},Pe={src:Ie,alt:"",style:{width:"30px"}};function Ue(J,R){return c(),m("img",Pe)}const ze=Y(De,[["render",Ue]]),Le={class:"home"},Re={class:"card third-card"},Ne=["onTouchstart","onTouchend"],Oe={class:"barrage-text"},He={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Qe=["src"],je={class:"card fourth-card"},qe={style:{cursor:"pointer"}},Ae={class:"barrage-text"},Fe={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Ke=["src"],We={class:"card fifth-card"},Xe={class:"preset-tags-container"},Ge={class:"preset-tags"},Ye={class:"added-tags"},Je="custom-popover",Ze={__name:"Home",setup(J){const R=()=>{const t=document.getElementById("diaocha");t?t.click():console.error('Element with id "diaocha" not found')},S=f(!0),D=f(!1),w=xe({getRandOne:[],filteredItems:[],tableData:[],table:"",barrage:""});(()=>{sessionStorage.getItem("firstOpening")||C.get("https://api.vvhan.com/api/visitor.info").then(t=>{const e=t;localStorage.setItem("ip",t.ip),p({icon:ze,dangerouslyUseHTMLString:!0,title:"你好",message:`
            <p>
                欢迎来自<b>${e.location||"地球"}</b>的朋友<br/>  
                ${e.system||"外星操作系统"} ${e.browser||"牛逼浏览器"}<br/>
                IP: ${e.ip||"地球"}
            </p>
            `,offset:50,customClass:"myClass",duration:1e3}),sessionStorage.setItem("firstOpening",1)})})();const P=f([]),Z=()=>{C.get("/machine/dictList").then(t=>{t.code==="200"&&(P.value=t.data,k.value=t.data.map(e=>({label:e.dictLabel,value:e.dictValue})))}).catch(t=>{console.error("获取字典数据失败",t)})},N=t=>{if(!t||t.trim()==="")return[];const e=Array.from(new Set(t.split(",").map(s=>s.trim())));if(!P.value)return e.map(()=>({label:"",iconUrl:""}));const i=new Map(P.value.map(s=>[String(s.dictValue).trim(),s]));return e.map(s=>{const d=i.get(s);return d?{label:d.dictLabel,iconUrl:d.iconUrl}:{label:"",iconUrl:""}})};Z();const V=f(""),h=f(""),k=f([]),T=f([]),v=f([]),O=t=>{T.value=T.value.filter(e=>e.value!==t.value),v.value=v.value.filter(e=>e!==t.value),k.value.push(t)},H=t=>{if(v.value.length>=5){p.info("最多5个标签");return}T.value.some(e=>e.value===t.value)||(T.value.push(t),v.value.push(t.value),k.value=k.value.filter(e=>e.value!==t.value))},ee=()=>{if(v.value.length===0||h.value===""||h.value===null)p.error("请选择标签或输入弹幕");else{if(v.value.length>5){p.error("最少一个标签，最多五个标签。");return}C.post(ke.SUBMIT_MEME,{tags:v.value.join(","),barrage:h.value}).then(t=>{h.value="",t.code==="200"?p.success("投稿成功，待审核(一天内)"):t.code==="500"?p.error("烂梗已经有了，勿重复提交"):p.error("请求失败")}).catch(t=>{console.error("投稿失败",t),p.error("请求失败")})}},U=()=>{console.log(V.value),C.post("/machine/Query",{barrage:V.value}).then(t=>{D.value=!0,S.value=!1,w.filteredItems=t.data||[]})};var te=f("搜索烂梗...");const Q=()=>{C.get("/machine/getRandOne").then(t=>{w.tableData=[t.data],S.value=!1}).catch(t=>{console.error("随机失败")})};Q();const oe=()=>{K({message:"复制成功",type:"success"})},le=()=>{K({message:"复制失败，请检查浏览器是否禁用navigator.clipboard对象或手动复制,请勿使用夸克浏览器",type:"error"})};let z=0,E=null,M=0;const j=t=>{const e=new Date().getTime(),i={x:event.clientX,y:event.clientY};if(E&&E.x===i.x&&E.y===i.y?(M++,console.log(M),M>4&&ge.alert("😡😡😡你在刷次数😡😡😡","请勿使用连点器",{confirmButtonText:"好吧，我错了"})):M=0,e-z<1500){p({title:"请勿刷次数",message:"复制成功，但次数没有增加",type:"warning"});const d=t.barrage;let b=document.createElement("input");b.value=d,document.body.appendChild(b),b.select();try{document.execCommand("Copy")}catch(_){p({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",_)}document.body.removeChild(b),z=e,E=i;return}E=i,z=e;const g=t.barrage;let s=document.createElement("input");s.value=g,document.body.appendChild(s),s.select();try{document.execCommand("Copy"),oe(),console.log("内容已复制到剪贴板"),C.get(`/machine/addCnt/${t.id}`).then(()=>{})}catch(d){p({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",d),le()}document.body.removeChild(s)},ae=()=>{w.filteredItems=[],D.value=!1},ne=t=>{t.touchStartTime=Date.now()},re=t=>{Date.now()-t.touchStartTime>200&&(t.popoverVisible=!0,setTimeout(()=>{t.popoverVisible=!1},1500))},se=Me($e,Be,2e3);async function ie(t){const e=t.content,i=se(e);!i||i==="limitedSuccess"||(Ve(),await U())}return(t,e)=>{const i=de,g=be,s=pe,d=ye,b=me,_=he,q=fe,A=G("Warning"),ue=G("QuestionFilled"),ce=_e,F=ve;return c(),m(I,null,[e[24]||(e[24]=o("div",{class:"boomouder"},[o("img",{src:"https://gcore.jsdelivr.net/gh/9WiSHao/AnythingStorage/img/6657boom.webp",alt:"6657boom",class:"boom6657"})],-1)),o("div",Le,[e[22]||(e[22]=o("div",{class:"card first-card"},[o("div",null,[o("b",null,[o("p",{class:"announcement"}," 新增时光相册(可评论)，新增在线投稿弹幕。玩神照片可以在上方上传照片上传至相册 ")])])],-1)),o("div",{class:"card second-card"},[o("p",null,[e[4]||(e[4]=r(" 这是一个收集6657烂梗的网站: ")),e[5]||(e[5]=o("span",{class:"dgq63136"},[o("a",{href:"https://sb6657.cn"},"sb6657.cn")],-1)),e[6]||(e[6]=r(" 尽情欣赏你们的烂梗吧。 另寻几位玩神老观众(21级牌子或3000h观看时长)，获得后台审核和记录的资格！！ ")),e[7]||(e[7]=o("br",null,null,-1)),o("b",null,[e[2]||(e[2]=r("为了更深入了解用户的需求以及作者需编写论文，特开展玩机器sb6657.cn 用户调研 ")),o("a",{style:{color:"blue",cursor:"pointer"},onClick:R},"点击我参加"),e[3]||(e[3]=r(" 为了感谢您抽出宝贵的时间参与调研，会在结束时抽取三个后台审核资格。"))])])]),o("div",Re,[o("div",null,[a(i,{type:"primary",onClick:Q},{default:l(()=>e[8]||(e[8]=[r("点我随机一条弹幕")])),_:1}),W((c(),B(b,{data:w.tableData,class:"barrage-table",onRowClick:j},{default:l(()=>[a(d,{prop:"barrage"},{default:l(n=>[a(s,{placement:"top",width:"auto",trigger:"hover",visible:n.row.popoverVisible},{reference:l(()=>[o("div",{style:{cursor:"pointer"},onTouchstart:u=>ne(n.row),onTouchend:u=>re(n.row)},[o("span",Oe,x(n.row.barrage),1)],40,Ne)]),default:l(()=>[o("div",He,[(c(!0),m(I,null,$(N(n.row.tags),(u,y)=>(c(),m("div",{key:y,style:{"margin-right":"8px"}},[a(g,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:l(()=>[u.iconUrl?(c(),m("img",{key:0,src:u.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,Qe)):L("",!0),r(" "+x(u.label),1)]),_:2},1024)]))),128))])]),_:2},1032,["visible"])]),_:1}),a(d,{label:"",align:"center",width:"85"},{default:l(()=>[a(i,{type:"primary"},{default:l(()=>e[9]||(e[9]=[r("复制")])),_:1})]),_:1})]),_:1},8,["data"])),[[F,S.value]])])]),o("div",je,[o("div",null,[a(q,{modelValue:V.value,"onUpdate:modelValue":e[0]||(e[0]=n=>V.value=n),placeholder:X(te),onKeydown:Ce(U,["enter"]),clearable:"",class:"search-input",onInput:ae},{append:l(()=>[a(i,{type:"primary",onClick:U},{default:l(()=>[a(_,null,{default:l(()=>[a(X(Ee))]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"]),D.value?W((c(),B(b,{key:0,data:w.filteredItems,stripe:"",onRowClick:j,"cell-style":{cursor:"Pointer",fontSize:"large"}},{default:l(()=>[a(d,{prop:"barrage"},{default:l(n=>[a(s,{placement:"top",width:"auto",trigger:"hover","popper-class":Je},{reference:l(()=>[o("div",qe,[o("span",Ae,x(n.row.barrage),1)])]),default:l(()=>[o("div",Fe,[(c(!0),m(I,null,$(N(n.row.tags),(u,y)=>(c(),m("div",{key:y,style:{"margin-right":"8px"}},[a(g,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:l(()=>[u.iconUrl?(c(),m("img",{key:0,src:u.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,Ke)):L("",!0),r(" "+x(u.label),1)]),_:2},1024)]))),128))])]),_:2},1024)]),_:1}),a(d,{align:"center",width:"100"},{default:l(n=>[a(i,{type:"primary",class:"copy-btn",onClick:we(u=>ie(n.row),["stop"])},{default:l(()=>[e[10]||(e[10]=r("复制 🎈")),a(Se,{num:n.row.cnt},null,8,["num"])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,S.value]]):L("",!0)])]),o("div",We,[o("div",null,[o("span",null,[e[18]||(e[18]=r("可选标签")),a(s,{width:300},{reference:l(()=>[a(_,{size:"16"},{default:l(()=>[a(A)]),_:1})]),default:l(()=>[e[11]||(e[11]=r(" 为解决烂梗分栏不足和分类不清晰问题。")),e[12]||(e[12]=o("br",null,null,-1)),e[13]||(e[13]=o("b",null,"点击标签即可添加",-1))]),_:1}),a(i,{link:"",type:"success",style:{"margin-left":"50%"}},{default:l(()=>[e[17]||(e[17]=r("投稿标签 ")),a(s,{width:300},{reference:l(()=>[a(_,{size:"16"},{default:l(()=>[a(ue)]),_:1})]),default:l(()=>[e[14]||(e[14]=o("b",null,"功能待完善(后续更新将添加)，请在上方(建议/提交)问卷投稿，sry。",-1)),e[15]||(e[15]=o("br",null,null,-1)),e[16]||(e[16]=o("b",null,"审核巨严格，(重复，相似等)将不通过",-1))]),_:1})]),_:1})]),o("div",Xe,[o("div",Ge,[(c(!0),m(I,null,$(k.value,(n,u)=>(c(),B(g,{round:"",key:u,closable:"",onClose:y=>H(n),onClick:y=>H(n),style:{padding:"15px",cursor:"pointer","font-size":"16px"},type:"primary"},{default:l(()=>[r(x(n.label),1)]),_:2},1032,["onClose","onClick"]))),128))])]),o("span",null,[e[20]||(e[20]=r("已选标签 ")),a(s,{width:250},{reference:l(()=>[a(_,{size:"16"},{default:l(()=>[a(A)]),_:1})]),default:l(()=>[e[19]||(e[19]=o("b",null,"最少一个标签，最多五个标签。",-1))]),_:1})]),o("div",Ye,[(c(!0),m(I,null,$(T.value,(n,u)=>(c(),B(g,{round:"",key:u,closable:"",onClick:y=>O(n),onClose:y=>O(n),style:{padding:"15px",cursor:"pointer","font-size":"16px"},effect:"dark"},{default:l(()=>[r(x(n.label),1)]),_:2},1032,["onClick","onClose"]))),128))]),a(q,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=n=>h.value=n),maxlength:"255",autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea",placeholder:" 烂梗...."},null,8,["modelValue"]),a(i,{class:"saveBnt",type:"primary",onClick:ee},{default:l(()=>e[21]||(e[21]=[r("投稿")])),_:1})]),a(ce,{right:50,bottom:50})]),a(Te,{class:"ChatRoom card"}),e[23]||(e[23]=o("div",{class:"card sixth-card"},[r(" 友情链接 "),o("a",{href:"https://dgq63136.cn",target:"_blank"},"dgq63136.cn"),r("    "),o("a",{href:"https://sb6657.cn/#/Starrysky",target:"_blank"},"星空背景")],-1))])],64)}}},ht=Y(Ze,[["__scopeId","data-v-14388c67"]]);export{ht as default};
