import{h as w,_ as T}from"./index.DVmEW_cL.js";import{a as n}from"./element-plus.DvA9XFyU.js";import{d as L,h as C,al as g,c as r,o as a,a as i,R as m,L as M,O as p,P as k,J as h,D as F,Q as P,a6 as $,I as S,f as G}from"./@vue.BltuATdo.js";const s0="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%20viewBox='0%200%2016%2016'%3e%3cpath%20fill='currentColor'%20fill-rule='evenodd'%20d='M7.98.03C3.56.03-.028%203.596-.028%207.999s3.587%207.968%208.006%207.968%208.007-3.564%208.007-7.968q0-.334-.028-.661a.627.627%200%200%200-1.25.103q.024.276.024.558c0%203.705-3.02%206.714-6.753%206.714s-6.752-3.009-6.752-6.714c0-3.704%203.02-6.713%206.752-6.713.655%200%201.286.092%201.883.264A.627.627%200%200%200%2010.21.344%208%208%200%200%200%207.98.031m2.839%209.98a.627.627%200%201%200-1.067-.659%201.3%201.3%200%200%201-.27.307c-.327.273-.822.433-1.356.43s-1.03-.17-1.359-.45a1.3%201.3%200%200%201-.257-.294.627.627%200%200%200-1.059.673c.14.22.312.413.503.576.6.51%201.401.743%202.164.748.762.005%201.565-.218%202.167-.72.205-.17.388-.374.534-.611M6.55%206.4c0%20.553-.45%201-1.007%201a1.004%201.004%200%200%201-1.006-1c0-.553.45-1.001%201.006-1.001s1.007.448%201.007%201m4.259%201c.556%200%201.006-.447%201.006-1s-.45-1.001-1.006-1.001-1.006.448-1.006%201c0%20.554.45%201.002%201.006%201.002m-.448-4.495c0-.34.276-.616.616-.616h1.385V.92a.619.619%200%200%201%201.238%200v1.37h1.383a.616.616%200%200%201%200%201.231H13.6v1.37a.619.619%200%201%201-1.238%200V3.52h-1.385a.616.616%200%200%201-.616-.615'%20clip-rule='evenodd'%3e%3c/path%3e%3c/svg%3e",o0="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1745075487822'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3634'%20width='32'%20height='32'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cpath%20d='M157.568%20751.296c-11.008-18.688-18.218667-31.221333-21.802667-37.909333A424.885333%20424.885333%200%200%201%2085.333333%20512C85.333333%20276.362667%20276.362667%2085.333333%20512%2085.333333s426.666667%20191.029333%20426.666667%20426.666667-191.029333%20426.666667-426.666667%20426.666667a424.778667%20424.778667%200%200%201-219.125333-60.501334%202786.56%202786.56%200%200%200-20.053334-11.765333l-104.405333%2028.48c-23.893333%206.506667-45.802667-15.413333-39.285333-39.296l28.437333-104.288z%20m65.301333%203.786667l-17.258666%2063.306666%2063.306666-17.258666a32%2032%200%200%201%2024.522667%203.210666%204515.84%204515.84%200%200%201%2032.352%2018.944A360.789333%20360.789333%200%200%200%20512%20874.666667c200.298667%200%20362.666667-162.368%20362.666667-362.666667S712.298667%20149.333333%20512%20149.333333%20149.333333%20311.701333%20149.333333%20512c0%2060.586667%2014.848%20118.954667%2042.826667%20171.136%203.712%206.912%2012.928%2022.826667%2027.370667%2047.232a32%2032%200%200%201%203.338666%2024.714667z%20m145.994667-70.773334a32%2032%200%201%201%2040.917333-49.205333A159.189333%20159.189333%200%200%200%20512%20672c37.888%200%2073.674667-13.173333%20102.186667-36.885333a32%2032%200%200%201%2040.917333%2049.216A223.178667%20223.178667%200%200%201%20512%20736a223.178667%20223.178667%200%200%201-143.136-51.690667z'%20fill='%23000000'%20p-id='3635'%3e%3c/path%3e%3c/svg%3e",a0="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1745075790056'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='7971'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M692.586667%20103.893333c25.173333-1.706667%2050.346667-1.706667%2075.413333%200.32%2014.4%206.506667%2029.653333%208.32%2045.226667%209.706667%201.706667%202.026667%205.12%206.186667%206.933333%208.32%2094.4%2031.466667%20162.026667%20129.6%20157.12%20229.226667%204.16%2080.96-42.346667%20153.173333-92.48%20212.693333-105.066667%20108.8-213.76%20214.08-320.533333%20321.28-19.093333%2016.533333-35.093333%2046.293333-64.853334%2038.293333C393.173333%20811.413333%20277.546667%20708.373333%20170.666667%20596.48%20102.933333%20533.333333%2043.84%20448.64%2047.146667%20352.213333c-5.12-119.253333%2090.986667-229.76%20208.533333-245.44%2021.866667-5.973333%2044.8-4.586667%2067.2-3.52%2016.853333%206.08%2034.453333%209.6%2052.053333%2012.266667%2056.64%2021.013333%20103.573333%2059.733333%20137.706667%20109.226667%2041.6-62.4%20106.346667-106.026667%20179.946667-120.853334m7.573333%2073.813334c-2.453333%2016.96-2.666667%2034.026667-0.64%2051.093333%2072.64-3.306667%20147.946667%2037.226667%20167.36%20110.826667%201.813333%2014.933333%201.92%2030.4%206.933333%2044.8%2014.72%2011.2%2032.96%207.146667%2049.6%203.84%2021.973333-122.773333-103.573333-235.84-223.253333-210.56z'%20fill='%23DB4100'%20p-id='7972'%3e%3c/path%3e%3cpath%20d='M700.16%20177.706667c119.68-25.28%20245.226667%2087.786667%20223.253333%20210.56-16.64%203.306667-34.88%207.36-49.6-3.84-5.013333-14.4-5.12-29.866667-6.933333-44.8-19.413333-73.6-94.72-114.133333-167.36-110.826667-2.026667-17.066667-1.813333-34.133333%200.64-51.093333z'%20fill='%23FFFFFF'%20p-id='7973'%3e%3c/path%3e%3c/svg%3e",U="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1745075576333'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5784'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M171.712%20571.648l0.352%200.32%20287.904%20252.8a64%2064%200%200%200%2082.912%201.344l296.832-244.544a215.584%20215.584%200%201%200-301.824-300.576L512%20316.672l-25.888-35.616a215.584%20215.584%200%201%200-314.4%20290.624zM32%20407.584a279.584%20279.584%200%200%201%20480-194.944%20279.584%20279.584%200%200%201%20480%20194.944%20278.144%20278.144%200%200%201-113.024%20224.512l-295.36%20243.392a128%20128%200%200%201-165.888-2.592L129.984%20620.16A278.976%20278.976%200%200%201%2032%20407.584z'%20fill='%23d81e06'%20p-id='5785'%3e%3c/path%3e%3c/svg%3e",E={class:"comment-item"},A={class:"comment-header"},R=["src"],O={class:"username"},W={key:0,style:{color:"#808080ff"}},Y={key:1},q={class:"time"},j=L({__name:"CommentItem",props:{comment:{},level:{}},emits:["refresh"],setup(x,{emit:I}){const c=x,y=I,_=["https://pic1.imgdb.cn/item/6806fcac58cb8da5c8bdab62.jpg","https://pic1.imgdb.cn/item/6806fcac58cb8da5c8bdab65.png","https://pic1.imgdb.cn/item/6806fcac58cb8da5c8bdab66.png","https://pic1.imgdb.cn/item/6806fcac58cb8da5c8bdab66.png","https://pic1.imgdb.cn/item/6806fcac58cb8da5c8bdab64.png","https://pic1.imgdb.cn/item/6807007258cb8da5c8bdbbbc.png","https://pic1.imgdb.cn/item/680700ab58cb8da5c8bdbce4.png","https://pic1.imgdb.cn/item/680700ab58cb8da5c8bdbce7.png","https://pic1.imgdb.cn/item/680700ab58cb8da5c8bdbce3.png","https://pic1.imgdb.cn/item/680700aa58cb8da5c8bdbce1.png","https://pic1.imgdb.cn/item/680700d458cb8da5c8bdbdd7.png","https://pic1.imgdb.cn/item/680700d458cb8da5c8bdbdd6.png","https://pic1.imgdb.cn/item/680700d458cb8da5c8bdbdd1.png","https://pic1.imgdb.cn/item/680700d458cb8da5c8bdbdd5.png","https://pic1.imgdb.cn/item/680700d458cb8da5c8bdbdd3.png","https://pic1.imgdb.cn/item/680700f858cb8da5c8bdbe94.png","https://pic1.imgdb.cn/item/6807011a58cb8da5c8bdbf61.png","https://pic1.imgdb.cn/item/6807011b58cb8da5c8bdbf64.png","https://pic1.imgdb.cn/item/6807011b58cb8da5c8bdbf62.png","https://pic1.imgdb.cn/item/6807011b58cb8da5c8bdbf63.png"],o=e=>{const t=Math.floor(Math.random()*20);return _[t]},l=e=>new Date(e).toLocaleString(),V=async e=>{try{(await w.post(`/machine/Post/Comment/like/${e}`)).code===200?(n.success("点赞成功"),y("refresh")):n.error("点赞失败")}catch{}},u=C(""),b=C(!1),N=()=>{u.value="",b.value=!0},s=async()=>{if(!u.value.trim()){n.warning("请输入回复内容");return}try{(await w.post("/machine/Post/Comment/reply",{postId:c.comment.postId,parentId:c.comment.id,toUserName:c.comment.userName,content:u.value})).code===200?(n.success("回复成功"),b.value=!1,y("refresh")):n.error("回复失败")}catch{}};return(e,t)=>{var B;const f=g("el-button"),D=g("el-input"),z=g("el-dialog"),v=g("CommentItem",!0);return a(),r("div",E,[i("div",A,[i("img",{class:"avatar",src:o(e.comment.userId)},null,8,R),i("span",O,[p(k(e.comment.userName)+" ",1),e.comment.toUserName?(a(),r("span",W,[t[5]||(t[5]=i("span",{style:{color:"#000","font-size":"12px"}},"回复",-1)),p(" "+k(e.comment.toUserName)+" :",1)])):(a(),r("span",Y,"："))]),i("span",null,k(e.comment.content),1)]),i("span",q,k(l(e.comment.createTime)),1),m(f,{text:"",size:"small",onClick:t[0]||(t[0]=d=>V(e.comment.id))},{default:h(()=>[t[6]||(t[6]=i("img",{class:"likeImg",src:U},null,-1)),p(" "+k(e.comment.likeCount),1)]),_:1}),m(f,{text:"",size:"small",onClick:N},{default:h(()=>[...t[7]||(t[7]=[p("回复",-1)])]),_:1}),m(z,{modelValue:b.value,"onUpdate:modelValue":t[3]||(t[3]=d=>b.value=d),title:"回复评论"},{footer:h(()=>[m(f,{onClick:t[2]||(t[2]=d=>b.value=!1)},{default:h(()=>[...t[8]||(t[8]=[p("取消",-1)])]),_:1}),m(f,{type:"primary",onClick:s},{default:h(()=>[...t[9]||(t[9]=[p("发送",-1)])]),_:1})]),default:h(()=>[m(D,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=d=>u.value=d),type:"textarea",placeholder:"请输入回复内容",rows:"4"},null,8,["modelValue"])]),_:1},8,["modelValue"]),(B=e.comment.children)!=null&&B.length?(a(),r("div",{key:0,style:F({marginLeft:e.level===1?"15px":"0"}),class:"child-comments"},[(a(!0),r(P,null,$(e.comment.children,d=>(a(),S(v,{key:d.id,comment:d,level:(e.level||0)+1,onRefresh:t[4]||(t[4]=Z=>y("refresh"))},null,8,["comment","level"]))),128))],4)):M("",!0)])}}}),H=T(j,[["__scopeId","data-v-0a8da0c0"]]),J={style:{display:"flex","margin-top":"10px"}},Q={key:0,class:"comment-list"},K={key:1},X=L({__name:"CommentList",props:{postId:{}},setup(x,{expose:I}){const c=C("");C(0);const y=x,_=C([]),o=C({pageNum:1,pageSize:10,total:0}),l=async(s=1)=>{try{const e=await w.get(`/machine/Post/Comment/getComment/${y.postId}`,{params:{pageNum:s,pageSize:o.value.pageSize}});e.code===200?(_.value=e.data.list,o.value.total=e.data.total,o.value.pageNum=e.data.pageNum):n.error("获取评论失败")}catch{n.error("网络请求失败")}};I({getComments:l});const V=s=>{o.value.pageNum=s,l(s)},u=async s=>{try{(await w.post(`/machine/Post/Comment/like/${s}`)).code===200?(n.success("点赞成功"),l(o.value.pageNum)):n.error("点赞失败")}catch{n.error("请求点赞接口失败")}},b=async s=>{console.log("回复评论：",s);try{(await w.post("/machine/Post/Comment/reply",{parentId:s.id,postId:s.postId,content:"这里是回复内容"})).code===200?(n.success("回复成功"),l(o.value.pageNum)):n.error("回复失败")}catch{n.error("请求回复接口失败")}};function N(s){if(!c.value.trim()){n.warning("评论内容不能为空");return}w.post("/machine/Post/Comment/add",{postId:s,content:c.value.trim()}).then(e=>{e.code===200?(n.success("评论成功"),c.value="",l(o.value.pageNum)):n.error(e.msg||"评论失败")}).catch(e=>{n.error("网络错误，评论失败")})}return G(()=>{l()}),(s,e)=>{const t=g("el-input"),f=g("el-button"),D=g("el-divider"),z=g("el-pagination");return a(),r(P,null,[i("div",J,[m(t,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=v=>c.value=v),placeholder:"评论一下吧~"},null,8,["modelValue"]),e[3]||(e[3]=p(" ",-1)),m(f,{onClick:e[1]||(e[1]=v=>N(s.postId)),color:"#FF9933",disabled:c.value.length===0},{default:h(()=>[...e[2]||(e[2]=[p("评论",-1)])]),_:1},8,["disabled"])]),_.value.length?(a(),r("div",Q,[(a(!0),r(P,null,$(_.value,v=>(a(),S(H,{key:v.id,comment:v,onLike:u,onReply:b,onRefresh:l},null,8,["comment"]))),128)),m(D),o.value.total>o.value.pageSize?(a(),S(z,{key:0,"current-page":o.value.pageNum,"page-size":o.value.pageSize,total:o.value.total,onCurrentChange:V,layout:"prev, pager, next",background:"",class:"pagination"},null,8,["current-page","page-size","total"])):M("",!0)])):(a(),r("div",K,[...e[4]||(e[4]=[i("p",{style:{color:"#999"}},"暂无评论，期待您的评论~",-1)])]))],64)}}}),c0=T(X,[["__scopeId","data-v-f68a4f09"]]);export{c0 as C,s0 as _,o0 as a,a0 as b,U as c};
