import{m as p,a as fe,d as ge,e as be,h as ye,v as _e,n as F,E as he,b as Ce,c as we,g as xe,o as ke}from"./element-plus.DVYLd97e.js";import{o as d,c as m,r as v,X as Te,a as l,aw as Ee,P as o,H as a,I as K,G as $,u as W,a5 as Se,K as z,L as c,O as I,a4 as B,M as C,V as X,ag as G}from"./@vue.BkZGu_Ap.js";import{_ as Z,h as w,A as Ie,C as Me}from"./index.C_NblXT8.js";import{M as Ve}from"./@element-plus.imH8POSc.js";import{_ as Pe}from"./favicon.CJfgpdIL.js";import{f as $e,c as Be,b as De,d as Le,t as Y,e as Ue,g as J,h as ze}from"./flip-num.SzPvNpjy.js";import{L as Re}from"./like-num.CR_9Vh4Z.js";import"./lodash-es.C-zDejYo.js";import"./@vueuse.B3BMR0ps.js";import"./@popperjs.D9SI2xQl.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.DXEKZA6n.js";import"./async-validator.DKvM95Vc.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.B6fDCfyv.js";import"./@floating-ui.8uccrNCM.js";import"./axios.CCb-kr4I.js";import"./vue-router.CJ_8Ucol.js";const Ne={},Oe={src:Pe,alt:"",style:{width:"30px"}};function He(ee,x){return d(),m("img",Oe)}const Qe=Z(Ne,[["render",He]]),je={class:"home"},qe={class:"card third-card"},Ae=["onTouchstart","onTouchend"],Fe={class:"barrage-text"},Ke={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},We=["src"],Xe={class:"card fourth-card"},Ge={style:{cursor:"pointer"}},Ye={class:"barrage-text"},Je={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Ze=["src"],et={class:"card fifth-card"},tt={class:"preset-tags-container"},ot={class:"preset-tags"},at={class:"added-tags"},lt="custom-popover",nt={__name:"Home",setup(ee){const x=v(!0),D=v(!1),k=Te({getRandOne:[],filteredItems:[],tableData:[],table:"",barrage:""});(()=>{sessionStorage.getItem("firstOpening")||w.get("https://api.vvhan.com/api/visitor.info").then(t=>{const e=t;localStorage.setItem("ip",t.ip),p({icon:Qe,dangerouslyUseHTMLString:!0,title:"你好",message:`
            <p>
                欢迎来自<b>${e.location||"地球"}</b>的朋友<br/>  
                ${e.system||"外星操作系统"} ${e.browser||"牛逼浏览器"}<br/>
                IP: ${e.ip||"地球"}
            </p>
            `,offset:50,customClass:"myClass",duration:1e3}),sessionStorage.setItem("firstOpening",1)})})();const L=v([]),te=()=>{w.get("/machine/dictList").then(t=>{t.code==="200"&&(L.value=t.data,T.value=t.data.map(e=>({label:e.dictLabel,value:e.dictValue})))}).catch(t=>{console.error("获取字典数据失败",t)})},R=t=>{if(!t||t.trim()==="")return[];const e=Array.from(new Set(t.split(",").map(s=>s.trim())));if(!L.value)return e.map(()=>({label:"",iconUrl:""}));const r=new Map(L.value.map(s=>[String(s.dictValue).trim(),s]));return e.map(s=>{const u=r.get(s);return u?{label:u.dictLabel,iconUrl:u.iconUrl}:{label:"",iconUrl:""}})};te();const M=v(""),_=v(""),T=v([]),E=v([]),f=v([]),N=t=>{E.value=E.value.filter(e=>e.value!==t.value),f.value=f.value.filter(e=>e!==t.value),T.value.push(t)},O=t=>{if(f.value.length>=5){p.info("最多5个标签");return}E.value.some(e=>e.value===t.value)||(E.value.push(t),f.value.push(t.value),T.value=T.value.filter(e=>e.value!==t.value))},oe=()=>{if(f.value.length===0||_.value===""||_.value===null)p.error("请选择标签或输入弹幕");else{if(f.value.length>5){p.error("最少一个标签，最多五个标签。");return}w.post(Ie.SUBMIT_MEME,{tags:f.value.join(","),barrage:_.value}).then(t=>{_.value="",t.code==="200"?p.success("投稿成功，待审核(一天内)"):t.code==="500"?p.error("烂梗已经有了，勿重复提交"):p.error("请求失败")}).catch(t=>{console.error("投稿失败",t),p.error("请求失败")})}},V=()=>{console.log(M.value),w.post("/machine/Query",{barrage:M.value}).then(t=>{D.value=!0,x.value=!1,k.filteredItems=t.data||[]})};var ae=v("搜索烂梗...");const H=()=>{w.get("/machine/getRandOne").then(t=>{k.tableData=[t.data],x.value=!1}).catch(t=>{console.error("随机失败")})};H();const le=()=>{F({message:"复制成功",type:"success"})},ne=()=>{F({message:"复制失败，请检查浏览器是否禁用navigator.clipboard对象或手动复制,请勿使用夸克浏览器",type:"error"})};let U=0,S=null,P=0;const Q=t=>{const e=new Date().getTime(),r={x:event.clientX,y:event.clientY};if(S&&S.x===r.x&&S.y===r.y?(P++,console.log(P),P>4&&he.alert("😡😡😡你在刷次数😡😡😡","请勿使用连点器",{confirmButtonText:"好吧，我错了"})):P=0,e-U<1500){p({title:"请勿刷次数",message:"复制成功，但次数没有增加",type:"warning"});const u=t.barrage;let b=document.createElement("input");b.value=u,document.body.appendChild(b),b.select();try{document.execCommand("Copy")}catch(h){p({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",h)}document.body.removeChild(b),U=e,S=r;return}S=r,U=e;const g=t.barrage;let s=document.createElement("input");s.value=g,document.body.appendChild(s),s.select();try{document.execCommand("Copy"),le(),console.log("内容已复制到剪贴板"),w.get(`/machine/addCnt/${t.id}`).then(()=>{})}catch(u){p({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",u),ne()}document.body.removeChild(s)},re=()=>{k.filteredItems=[],D.value=!1},se=t=>{t.touchStartTime=Date.now()},ie=t=>{Date.now()-t.touchStartTime>200&&(t.popoverVisible=!0,setTimeout(()=>{t.popoverVisible=!1},1500))},ce=Y(J,Ue,2e3),de=Y(J,ze,2e3);async function ue(t){const e=t.content,r=ce(e);!r||r==="limitedSuccess"||(Be(),await V())}async function pe(t){const e=t.content,r=de(e);if(!(!r||r==="limitedSuccess")){if(await De(t.id)){await V();return}Le()}}return(t,e)=>{const r=fe,g=Ce,s=ge,u=we,b=be,h=xe,j=ye,q=G("Warning"),me=G("QuestionFilled"),ve=ke,A=_e;return d(),m(I,null,[e[18]||(e[18]=l("div",{class:"boomouder"},[l("img",{src:"https://gcore.jsdelivr.net/gh/9WiSHao/AnythingStorage/img/6657boom.webp",alt:"6657boom",class:"boom6657"})],-1)),l("div",je,[e[16]||(e[16]=Ee('<div class="card first-card" data-v-7c7ed24e><div data-v-7c7ed24e><b data-v-7c7ed24e><p class="announcement" data-v-7c7ed24e> 新增时光相册(可评论)，新增在线投稿弹幕。玩神照片可以在上方上传照片上传至相册 </p></b></div></div><div class="card second-card" data-v-7c7ed24e><p data-v-7c7ed24e> 这是一个收集6657烂梗的网站: <span class="dgq63136" data-v-7c7ed24e><a href="https://sb6657.cn" data-v-7c7ed24e>sb6657.cn</a></span> 尽情欣赏你们的烂梗吧。 另寻几位玩神老观众(21级牌子或3000h观看时长)，获得后台审核和记录的资格！！ </p></div>',2)),l("div",qe,[l("div",null,[o(r,{type:"primary",onClick:H},{default:a(()=>e[2]||(e[2]=[c("点我随机一条弹幕")])),_:1}),K((d(),$(b,{data:k.tableData,class:"barrage-table",onRowClick:Q},{default:a(()=>[o(u,{prop:"barrage"},{default:a(n=>[o(s,{placement:"top",width:"auto",trigger:"hover",visible:n.row.popoverVisible},{reference:a(()=>[l("div",{style:{cursor:"pointer"},onTouchstart:i=>se(n.row),onTouchend:i=>ie(n.row)},[l("span",Fe,C(n.row.barrage),1)],40,Ae)]),default:a(()=>[l("div",Ke,[(d(!0),m(I,null,B(R(n.row.tags),(i,y)=>(d(),m("div",{key:y,style:{"margin-right":"8px"}},[o(g,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:a(()=>[i.iconUrl?(d(),m("img",{key:0,src:i.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,We)):z("",!0),c(" "+C(i.label),1)]),_:2},1024)]))),128))])]),_:2},1032,["visible"])]),_:1}),o(u,{label:"",align:"center",width:"85"},{default:a(()=>[o(r,{type:"primary"},{default:a(()=>e[3]||(e[3]=[c("复制")])),_:1})]),_:1})]),_:1},8,["data"])),[[A,x.value]])])]),l("div",Xe,[l("div",null,[o(j,{modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=n=>M.value=n),placeholder:W(ae),onKeydown:Se(V,["enter"]),clearable:"",class:"search-input",onInput:re},{append:a(()=>[o(r,{type:"primary",onClick:V},{default:a(()=>[o(h,null,{default:a(()=>[o(W(Ve))]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"]),D.value?K((d(),$(b,{key:0,data:k.filteredItems,stripe:"",onRowClick:Q,"cell-style":{cursor:"Pointer",fontSize:"large"}},{default:a(()=>[o(u,{prop:"barrage"},{default:a(n=>[o(s,{placement:"top",width:"auto",trigger:"hover","popper-class":lt},{reference:a(()=>[l("div",Ge,[l("span",Ye,C(n.row.barrage),1)])]),default:a(()=>[l("div",Je,[(d(!0),m(I,null,B(R(n.row.tags),(i,y)=>(d(),m("div",{key:y,style:{"margin-right":"8px"}},[o(g,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:a(()=>[i.iconUrl?(d(),m("img",{key:0,src:i.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,Ze)):z("",!0),c(" "+C(i.label),1)]),_:2},1024)]))),128))])]),_:2},1024)]),_:1}),o(u,{align:"center",width:"40"},{default:a(n=>[o(Re,{likeCount:n.row.likes,onClick:X(i=>pe(n.row),["stop"])},null,8,["likeCount","onClick"])]),_:1}),o(u,{align:"center",width:"100"},{default:a(n=>[o(r,{type:"primary",class:"copy-btn",onClick:X(i=>ue(n.row),["stop"])},{default:a(()=>[e[4]||(e[4]=c("复制 🎈")),o($e,{num:n.row.cnt},null,8,["num"])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[A,x.value]]):z("",!0)])]),l("div",et,[l("div",null,[l("span",null,[e[12]||(e[12]=c("可选标签")),o(s,{width:300},{reference:a(()=>[o(h,{size:"16"},{default:a(()=>[o(q)]),_:1})]),default:a(()=>[e[5]||(e[5]=c(" 为解决烂梗分栏不足和分类不清晰问题。")),e[6]||(e[6]=l("br",null,null,-1)),e[7]||(e[7]=l("b",null,"点击标签即可添加",-1))]),_:1}),o(r,{link:"",type:"success",style:{"margin-left":"50%"}},{default:a(()=>[e[11]||(e[11]=c("投稿标签 ")),o(s,{width:300},{reference:a(()=>[o(h,{size:"16"},{default:a(()=>[o(me)]),_:1})]),default:a(()=>[e[8]||(e[8]=l("b",null,"功能待完善(后续更新将添加)，请在上方(建议/提交)问卷投稿，sry。",-1)),e[9]||(e[9]=l("br",null,null,-1)),e[10]||(e[10]=l("b",null,"审核巨严格，(重复，相似等)将不通过",-1))]),_:1})]),_:1})]),l("div",tt,[l("div",ot,[(d(!0),m(I,null,B(T.value,(n,i)=>(d(),$(g,{round:"",key:i,closable:"",onClose:y=>O(n),onClick:y=>O(n),style:{padding:"15px",cursor:"pointer","font-size":"16px"},type:"primary"},{default:a(()=>[c(C(n.label),1)]),_:2},1032,["onClose","onClick"]))),128))])]),l("span",null,[e[14]||(e[14]=c("已选标签 ")),o(s,{width:250},{reference:a(()=>[o(h,{size:"16"},{default:a(()=>[o(q)]),_:1})]),default:a(()=>[e[13]||(e[13]=l("b",null,"最少一个标签，最多五个标签。",-1))]),_:1})]),l("div",at,[(d(!0),m(I,null,B(E.value,(n,i)=>(d(),$(g,{round:"",key:i,closable:"",onClick:y=>N(n),onClose:y=>N(n),style:{padding:"15px",cursor:"pointer","font-size":"16px"},effect:"dark"},{default:a(()=>[c(C(n.label),1)]),_:2},1032,["onClick","onClose"]))),128))]),o(j,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=n=>_.value=n),maxlength:"255",autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea",placeholder:" 烂梗...."},null,8,["modelValue"]),o(r,{class:"saveBnt",type:"primary",onClick:oe},{default:a(()=>e[15]||(e[15]=[c("投稿")])),_:1})]),o(ve,{right:50,bottom:50})]),o(Me,{class:"ChatRoom card"}),e[17]||(e[17]=l("div",{class:"card sixth-card"},[c(" 友情链接 "),l("a",{href:"https://dgq63136.cn",target:"_blank"},"dgq63136.cn"),c("    "),l("a",{href:"https://sb6657.cn/#/Starrysky",target:"_blank"},"星空背景")],-1))])],64)}}},Tt=Z(nt,[["__scopeId","data-v-7c7ed24e"]]);export{Tt as default};
