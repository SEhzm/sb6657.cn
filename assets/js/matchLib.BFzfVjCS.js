import{K as se,f as ne,g as le,h as re,d as ie,c as ce,v as de,e as ue,a as b,n as me,A as pe}from"./element-plus.nxJ_dmmw.js";import{d as _e,r as l,i as he,S as ve,c as h,o as d,a as t,Q as s,P as $,a6 as j,I as n,J as ge,H as L,M as E,O as r,K as A,V as fe,u as k}from"./@vue.Ca5AQEsS.js";import{S as be,n as K}from"./@element-plus.BuV21Ltw.js";import{h as S,_ as we}from"./index.eeKMCR7J.js";import{f as ye,t as Te}from"./flip-num.BvOo5SKV.js";import{c as Ce,l as xe,a as Le}from"./clipboard.E41oT7BO.js";import{c as Ee,p as ke}from"./setMeme.BpyK6K7D.js";import"./lodash-es.S0Y0Up6J.js";import"./@vueuse.BFkoDYlQ.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.DcnvBwdO.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.58V2siOx.js";import"./pinia.Dz8zdBJG.js";import"./axios.xsH4HHeE.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.DhOS9MZH.js";const Se={class:"match-library"},Me={class:"match-list"},Ve={class:"card-content"},ze={class:"image-container"},Pe=["src"],Ue={class:"match-info"},Be={class:"match-header"},De={class:"match-name"},Ne={class:"match-details"},Ie={class:"match-location"},$e={class:"match-time"},je={class:"time-item"},Ae={class:"time-item"},Ke={class:"pagination-container"},Re={class:"memes-view"},We={class:"card-table"},Fe=["onTouchstart","onTouchend"],He={class:"barrage-text"},Je={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Oe=["src"],Qe={style:{"vertical-align":"middle"}},qe={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},Ge={class:"pagination-wrapper"},Xe=_e({__name:"matchLib",setup(Ye){const M=l([]),V=l(0),v=l(1),R=l(5),w=l(!1),g=l(null),z=l([]),f=l(!1),P=l(0),y=l(50),_=l(1),T=l([]),W=Te(Le,xe,2e3),U=l(window.innerWidth<=768),B=()=>{U.value=window.innerWidth<=768},D=async()=>{try{const e=await S.get("/machine/getMatchList",{params:{pageNum:v.value,pageSize:R.value}});e.code===200?(M.value=e.data.list,V.value=e.data.total):b.error(e.msg||"Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•")}catch(e){b.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•:",e)}},F=e=>{v.value=e,D()},H=e=>{g.value=e,w.value=!0,_.value=1,C(1)},C=async e=>{if(g.value){f.value=!0;try{const o=await S.get("/machine/matchPageList",{params:{pageNum:e,pageSize:y.value,matchId:g.value.id}});o.code===200?(z.value=o.data.list,P.value=o.data.total):b.error(o.msg||"Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•")}catch(o){b.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•:",o)}finally{f.value=!1}}},N=async e=>{const o=e.barrage,i=W(o);if(!(!i||i==="limitedSuccess")){Ce();try{if(await Ee("match",e.id,_.value,y.value)){await C(_.value);return}}catch(m){console.error("Â§çÂà∂Ê¨°Êï∞+1Â§±Ë¥•:",m)}ke()}},J=e=>{_.value=e,C(e)},O=e=>{if(!e||e.trim()==="")return[];const o=Array.from(new Set(e.split(",").map(c=>c.trim())));if(!T.value)return o.map(()=>({label:"",iconUrl:""}));const i=new Map(T.value.map(c=>[String(c.dictValue).trim(),c]));return o.map(c=>{const p=i.get(c);return p?{label:p.dictLabel,iconUrl:p.iconUrl}:{label:"",iconUrl:""}})},Q=()=>{S.get("/machine/dictList").then(e=>{e.code===200&&(T.value=e.data)}).catch(e=>{console.error("Ëé∑ÂèñÂ≠óÂÖ∏Êï∞ÊçÆÂ§±Ë¥•",e)})},q=e=>{e.touchStartTime=Date.now()},G=e=>{Date.now()-e.touchStartTime>100&&(e.popoverVisible=!0,setTimeout(()=>{e.popoverVisible=!1},1500))},X=e=>e?e.replace("T"," ").split(".")[0]:"";return he(()=>{Q(),D(),window.addEventListener("resize",B)}),ve(()=>{window.removeEventListener("resize",B)}),(e,o)=>{var I;const i=re,m=me,c=pe,p=se,x=le,Y=ie,Z=ce,ee=ne,te=ue,ae=de;return d(),h("div",Se,[o[3]||(o[3]=t("div",{class:"card"},[t("span",null,"ÊäïÁ®øÊó∂ÂãæÈÄâÂÖ≥ËÅîËµõ‰∫ãÂ∫ìÂ∞ÜÂä†ÂÖ•Êüê‰∏ÄËµõ‰∫ãÂàõ‰ΩúÁöÑÁÉÇÊ¢óÔºåÁõÆÂâçÂè™Êî∂ÂΩïÂ§ßÂûãËµõ‰∫ã"),t("p",null,"È°µÈù¢‰ªÖÂ±ïÁ§∫Êî∂ÂΩï‰∫éËµõ‰∫ãÊúüÈó¥Âàõ‰ΩúÁöÑÁÉÇÊ¢ó")],-1)),t("div",Me,[(d(!0),h($,null,j(M.value,a=>(d(),L(c,{key:a.id,class:"match-card","body-style":{padding:"0px"},onClick:u=>H(a)},{default:n(()=>[t("div",Ve,[t("div",ze,[t("img",{src:a.matchesImg,class:"match-image"},null,8,Pe)]),t("div",Ue,[t("div",Be,[t("h3",De,r(a.matchesName),1),s(i,{size:"small",type:"success",class:"match-level"},{default:n(()=>[E(r(a.level),1)]),_:2},1024)]),t("div",Ne,[t("div",Ie,[s(m,null,{default:n(()=>[s(k(be))]),_:1}),t("span",null,r(a.matchesLocation),1)]),t("div",$e,[t("div",je,[s(m,null,{default:n(()=>[s(k(K))]),_:1}),t("span",null,"ÂºÄÂßãÔºö"+r(a.startTime),1)]),t("div",Ae,[s(m,null,{default:n(()=>[s(k(K))]),_:1}),t("span",null,"ÁªìÊùüÔºö"+r(a.endTime),1)])])])])])]),_:2},1032,["onClick"]))),128))]),t("div",Ke,[s(p,{"current-page":v.value,"onUpdate:currentPage":o[0]||(o[0]=a=>v.value=a),total:V.value,layout:"total,prev, pager, next",onCurrentChange:F},null,8,["current-page","total"])]),s(te,{modelValue:w.value,"onUpdate:modelValue":o[1]||(o[1]=a=>w.value=a),title:(I=g.value)==null?void 0:I.matchesName,width:U.value?"100%":"75%",class:"match-dialog","destroy-on-close":""},{default:n(()=>[t("div",Re,[t("div",We,[ge((d(),L(ee,{data:z.value,stripe:"","cell-class-name":"hover-pointer","empty-text":"ÊöÇÊó†ÁÉÇÊ¢óÔºåÂø´Êù•ÊäïÁ®øÂêßÔºÅ",onRowClick:N},{default:n(()=>[s(x,{align:"center",width:"60"},{default:n(a=>[s(i,{round:"",effect:"plain"},{default:n(()=>[E(r(a.row.id),1)]),_:2},1024)]),_:1}),s(x,{prop:"barrage"},{default:n(a=>[s(Y,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:n(()=>[t("div",{style:{cursor:"pointer"},onTouchstart:u=>q(a.row),onTouchend:u=>G(a.row)},[t("span",He,r(a.row.barrage),1)],40,Fe)]),default:n(()=>[t("div",Je,[(d(!0),h($,null,j(O(a.row.tags),(u,oe)=>(d(),h("div",{key:oe,style:{"margin-right":"8px"}},[s(i,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:n(()=>[u.iconUrl?(d(),h("img",{key:0,src:u.iconUrl,style:{width:"16px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,Oe)):A("",!0),t("span",Qe,r(u.label),1)]),_:2},1024)]))),128)),t("span",qe," ÊäïÁ®øÊó∂Èó¥: "+r(X(a.row.submitTime)),1)])]),_:2},1032,["visible"])]),_:1}),s(x,{align:"center",width:"100"},{default:n(a=>[s(Z,{type:"primary",class:"copy-btn",onClick:fe(u=>N(a.row),["stop"])},{default:n(()=>[o[2]||(o[2]=E(" Â§çÂà∂ üåà")),s(ye,{num:a.row.cnt},null,8,["num"])]),_:2,__:[2]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ae,f.value]]),t("div",Ge,[f.value?A("",!0):(d(),L(p,{key:0,background:"",layout:"prev, pager, next, jumper","current-page":_.value,total:P.value,"pager-count":3,"page-size":y.value,onCurrentChange:J},null,8,["current-page","total","page-size"]))])])])]),_:1},8,["modelValue","title","width"])])}}}),bt=we(Xe,[["__scopeId","data-v-f104519b"]]);export{bt as default};
