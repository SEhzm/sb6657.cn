import{d as se,h as l,f as le,U as re,al as r,ar as ie,c as v,o as u,a as t,R as n,Q as R,a6 as W,J as s,K as ce,I as k,O as M,P as i,L as j,W as de,u as S}from"./@vue.BltuATdo.js";import{V as ue,n as A}from"./@element-plus.BgPfl9pw.js";import{h as V,_ as me}from"./index.C7cp5ExU.js";import{f as pe}from"./flip-num.DV-hWSiA.js";import{c as _e,l as he,a as ve}from"./clipboard.u-mZdnyc.js";import{t as ge}from"./throttle.DXAb9wGD.js";import{c as fe,p as be}from"./setMeme.lgruYVRR.js";import{a as w}from"./element-plus.DQRrSmQa.js";import"./pinia.DfSVr1RC.js";import"./axios.ngrFHoWO.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.oDprkwHL.js";import"./lodash-es.CDeyng3v.js";import"./@vueuse.7i1SIcsD.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";const we={class:"match-library"},ye={class:"match-list"},Ce={class:"card-content"},Te={class:"image-container"},xe=["src"],Le={class:"match-info"},ke={class:"match-header"},Me={class:"match-name"},Se={class:"match-details"},Ve={class:"match-location"},ze={class:"match-time"},Ue={class:"time-item"},Pe={class:"time-item"},De={class:"pagination-container"},Ee={class:"memes-view"},Ne={class:"card-table"},Be=["onTouchstart","onTouchend"],Ie={class:"barrage-text"},$e={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Re=["src"],We={style:{"vertical-align":"middle"}},je={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},Ae={class:"pagination-wrapper"},Fe=se({__name:"matchLib",setup(Je){const z=l([]),U=l(0),g=l(1),F=l(20),y=l(!1),f=l(null),P=l([]),b=l(!1),D=l(0),C=l(50),h=l(1),T=l([]),J=ge(ve,he,2e3),E=l(window.innerWidth<=768),N=()=>{E.value=window.innerWidth<=768},B=async()=>{try{const e=await V.get("/machine/getMatchList",{params:{pageNum:g.value,pageSize:F.value}});e.code===200?(z.value=e.data.list,U.value=e.data.total):w.error(e.msg||"Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•")}catch(e){w.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•:",e)}},K=e=>{g.value=e,B()},O=e=>{f.value=e,y.value=!0,h.value=1,x(1)},x=async e=>{if(f.value){b.value=!0;try{const o=await V.get("/machine/matchPageList",{params:{pageNum:e,pageSize:C.value,matchId:f.value.id}});o.code===200?(P.value=o.data.list,D.value=o.data.total):w.error(o.msg||"Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•")}catch(o){w.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•:",o)}finally{b.value=!1}}},I=async e=>{const o=e.barrage,c=J(o);if(!(!c||c==="limitedSuccess")){_e();try{if(await fe("match",e.id,h.value,C.value)){await x(h.value);return}}catch(p){console.error("Â§çÂà∂Ê¨°Êï∞+1Â§±Ë¥•:",p)}be()}},Q=e=>{h.value=e,x(e)},q=e=>{if(!e||e.trim()==="")return[];const o=Array.from(new Set(e.split(",").map(d=>d.trim())));if(!T.value)return o.map(()=>({label:"",iconUrl:""}));const c=new Map(T.value.map(d=>[String(d.dictValue).trim(),d]));return o.map(d=>{const _=c.get(d);return _?{label:_.dictLabel,iconUrl:_.iconUrl}:{label:"",iconUrl:""}})},G=()=>{V.get("/machine/dictList").then(e=>{e.code===200&&(T.value=e.data)}).catch(e=>{console.error("Ëé∑ÂèñÂ≠óÂÖ∏Êï∞ÊçÆÂ§±Ë¥•",e)})},H=e=>{e.touchStartTime=Date.now()},X=e=>{Date.now()-e.touchStartTime>100&&(e.popoverVisible=!0,setTimeout(()=>{e.popoverVisible=!1},1500))},Y=e=>e?e.replace("T"," ").split(".")[0]:"";return le(()=>{G(),B(),window.addEventListener("resize",N)}),re(()=>{window.removeEventListener("resize",N)}),(e,o)=>{var $;const c=r("el-tag"),p=r("el-icon"),d=r("el-card"),_=r("el-pagination"),L=r("el-table-column"),Z=r("el-popover"),ee=r("el-button"),te=r("el-table"),ae=r("el-dialog"),oe=ie("loading");return u(),v("div",we,[o[3]||(o[3]=t("div",{class:"card"},[t("span",null,"ÊäïÁ®øÊó∂ÂãæÈÄâÂÖ≥ËÅîËµõ‰∫ãÂ∫ìÂ∞ÜÂä†ÂÖ•Êüê‰∏ÄËµõ‰∫ãÂàõ‰ΩúÁöÑÁÉÇÊ¢óÔºåÁõÆÂâçÂè™Êî∂ÂΩïÂ§ßÂûãËµõ‰∫ã"),t("p",null,"È°µÈù¢‰ªÖÂ±ïÁ§∫Êî∂ÂΩï‰∫éËµõ‰∫ãÊúüÈó¥Âàõ‰ΩúÁöÑÁÉÇÊ¢ó")],-1)),t("div",ye,[(u(!0),v(R,null,W(z.value,a=>(u(),k(d,{key:a.id,class:"match-card","body-style":{padding:"0px"},onClick:m=>O(a)},{default:s(()=>[t("div",Ce,[t("div",Te,[t("img",{src:a.matchesImg,class:"match-image"},null,8,xe)]),t("div",Le,[t("div",ke,[t("h3",Me,i(a.matchesName),1),n(c,{size:"small",type:"success",class:"match-level"},{default:s(()=>[M(i(a.level),1)]),_:2},1024)]),t("div",Se,[t("div",Ve,[n(p,null,{default:s(()=>[n(S(ue))]),_:1}),t("span",null,i(a.matchesLocation),1)]),t("div",ze,[t("div",Ue,[n(p,null,{default:s(()=>[n(S(A))]),_:1}),t("span",null,"ÂºÄÂßãÔºö"+i(a.startTime),1)]),t("div",Pe,[n(p,null,{default:s(()=>[n(S(A))]),_:1}),t("span",null,"ÁªìÊùüÔºö"+i(a.endTime),1)])])])])])]),_:2},1032,["onClick"]))),128))]),t("div",De,[n(_,{"current-page":g.value,"onUpdate:currentPage":o[0]||(o[0]=a=>g.value=a),total:U.value,layout:"total,prev, pager, next",onCurrentChange:K},null,8,["current-page","total"])]),n(ae,{modelValue:y.value,"onUpdate:modelValue":o[1]||(o[1]=a=>y.value=a),title:($=f.value)==null?void 0:$.matchesName,width:E.value?"100%":"75%",class:"match-dialog","destroy-on-close":""},{default:s(()=>[t("div",Ee,[t("div",Ne,[ce((u(),k(te,{data:P.value,stripe:"","cell-class-name":"hover-pointer","empty-text":"ÊöÇÊó†ÁÉÇÊ¢óÔºåÂø´Êù•ÊäïÁ®øÂêßÔºÅ",onRowClick:I},{default:s(()=>[n(L,{align:"center",width:"60"},{default:s(a=>[n(c,{round:"",effect:"plain"},{default:s(()=>[M(i(a.row.id),1)]),_:2},1024)]),_:1}),n(L,{prop:"barrage"},{default:s(a=>[n(Z,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:s(()=>[t("div",{style:{cursor:"pointer"},onTouchstart:m=>H(a.row),onTouchend:m=>X(a.row)},[t("span",Ie,i(a.row.barrage),1)],40,Be)]),default:s(()=>[t("div",$e,[(u(!0),v(R,null,W(q(a.row.tags),(m,ne)=>(u(),v("div",{key:ne,style:{"margin-right":"8px"}},[n(c,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:s(()=>[m.iconUrl?(u(),v("img",{key:0,src:m.iconUrl,style:{width:"16px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,Re)):j("",!0),t("span",We,i(m.label),1)]),_:2},1024)]))),128)),t("span",je," ÊäïÁ®øÊó∂Èó¥: "+i(Y(a.row.submitTime)),1)])]),_:2},1032,["visible"])]),_:1}),n(L,{align:"center",width:"100"},{default:s(a=>[n(ee,{type:"primary",class:"copy-btn",onClick:de(m=>I(a.row),["stop"])},{default:s(()=>[o[2]||(o[2]=M(" Â§çÂà∂ üåà",-1)),n(pe,{num:a.row.cnt},null,8,["num"])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[oe,b.value]]),t("div",Ae,[b.value?j("",!0):(u(),k(_,{key:0,background:"",layout:"prev, pager, next, jumper","current-page":h.value,total:D.value,"pager-count":3,"page-size":C.value,onCurrentChange:Q},null,8,["current-page","total","page-size"]))])])])]),_:1},8,["modelValue","title","width"])])}}}),mt=me(Fe,[["__scopeId","data-v-a0976a07"]]);export{mt as default};
