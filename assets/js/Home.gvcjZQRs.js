import{n as p,f as be,a as ye,d as _e,e as he,h as we,v as Ce,o as W,E as xe,b as ke,c as Te,g as Ee,p as Me}from"./element-plus.mnS0KK5-.js";import{o as d,c as v,r as f,X as Se,a as o,L as s,P as l,H as n,I as X,G as B,u as G,a5 as Ve,K as N,O as E,a4 as U,M as h,V as Y,ag as J}from"./@vue.BkZGu_Ap.js";import{_ as te,h as w,A as Ie,C as $e}from"./index.BRelUR03.js";import{M as De}from"./@element-plus.imH8POSc.js";import{_ as Pe}from"./favicon.CJfgpdIL.js";import{L as Be,f as Ue,c as Le,b as ze,d as Re,t as Z,e as Ne,g as ee,h as Oe}from"./like-num.CVUcxe7J.js";import"./lodash-es.C-zDejYo.js";import"./@vueuse.B3BMR0ps.js";import"./@popperjs.D9SI2xQl.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.DXEKZA6n.js";import"./async-validator.DKvM95Vc.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.B6fDCfyv.js";import"./@floating-ui.8uccrNCM.js";import"./axios.CCb-kr4I.js";import"./vue-router.CJ_8Ucol.js";/* empty css                                                                 */const je={},He={src:Pe,alt:"",style:{width:"30px"}};function Qe(oe,M){return d(),v("img",He)}const qe=te(je,[["render",Qe]]),Ae={class:"home"},Fe={class:"card second-card"},Ke={class:"card third-card"},We=["onTouchstart","onTouchend"],Xe={class:"barrage-text"},Ge={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Ye=["src"],Je={class:"card fourth-card"},Ze={style:{cursor:"pointer"}},et={class:"barrage-text"},tt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},ot=["src"],lt={class:"card fifth-card"},nt={class:"preset-tags-container"},at={class:"preset-tags"},st={class:"added-tags"},rt="custom-popover",it={__name:"Home",setup(oe){const M=f(!1),S=f(!0),L=f(!1),C=Se({getRandOne:[],filteredItems:[],tableData:[],table:"",barrage:""});(()=>{sessionStorage.getItem("firstOpening")||w.get("https://api.vvhan.com/api/visitor.info").then(t=>{const e=t;localStorage.setItem("ip",t.ip),p({icon:qe,dangerouslyUseHTMLString:!0,title:"你好",message:`
            <p>
                欢迎来自<b>${e.location||"地球"}</b>的朋友<br/>  
                ${e.system||"外星操作系统"} ${e.browser||"牛逼浏览器"}<br/>
                IP: ${e.ip||"地球"}
            </p>
            `,offset:50,customClass:"myClass",duration:1e3}),sessionStorage.setItem("firstOpening",1)})})();const z=f([]),le=()=>{w.get("/machine/dictList").then(t=>{t.code==="200"&&(z.value=t.data,x.value=t.data.map(e=>({label:e.dictLabel,value:e.dictValue})))}).catch(t=>{console.error("获取字典数据失败",t)})},O=t=>{if(!t||t.trim()==="")return[];const e=Array.from(new Set(t.split(",").map(r=>r.trim())));if(!z.value)return e.map(()=>({label:"",iconUrl:""}));const u=new Map(z.value.map(r=>[String(r.dictValue).trim(),r]));return e.map(r=>{const c=u.get(r);return c?{label:c.dictLabel,iconUrl:c.iconUrl}:{label:"",iconUrl:""}})};le();const V=f(""),_=f(""),x=f([]),k=f([]),b=f([]),j=t=>{k.value=k.value.filter(e=>e.value!==t.value),b.value=b.value.filter(e=>e!==t.value),x.value.push(t)},H=t=>{if(b.value.length>=5){p.info("最多5个标签");return}k.value.some(e=>e.value===t.value)||(k.value.push(t),b.value.push(t.value),x.value=x.value.filter(e=>e.value!==t.value))},ne=()=>{if(b.value.length===0||_.value===""||_.value===null)p.error("请选择标签或输入弹幕");else{if(b.value.length>5){p.error("最少一个标签，最多五个标签。");return}w.post(Ie.SUBMIT_MEME,{tags:b.value.join(","),barrage:_.value}).then(t=>{_.value="",t.code==="200"?p.success("投稿成功，待审核(一天内)"):t.code==="500"?p.error("烂梗已经有了，勿重复提交"):p.error("请求失败")}).catch(t=>{console.error("投稿失败",t),p.error("请求失败")})}},I=()=>{console.log(V.value),w.post("/machine/Query",{barrage:V.value}).then(t=>{L.value=!0,S.value=!1,C.filteredItems=t.data||[]})};var ae=f("搜索烂梗...");const Q=()=>{w.get("/machine/getRandOne").then(t=>{C.tableData=[t.data],S.value=!1}).catch(t=>{console.error("随机失败")})};Q();const se=()=>{W({message:"复制成功",type:"success"})},re=()=>{W({message:"复制失败，请检查浏览器是否禁用navigator.clipboard对象或手动复制,请勿使用夸克浏览器",type:"error"})};let R=0,T=null,$=0;const q=t=>{const e=new Date().getTime(),u={x:event.clientX,y:event.clientY};if(T&&T.x===u.x&&T.y===u.y?($++,console.log($),$>4&&xe.alert("😡😡😡你在刷次数😡😡😡","请勿使用连点器",{confirmButtonText:"好吧，我错了"})):$=0,e-R<1500){p({title:"请勿刷次数",message:"复制成功，但次数没有增加",type:"warning"});const c=t.barrage;let m=document.createElement("input");m.value=c,document.body.appendChild(m),m.select();try{document.execCommand("Copy")}catch(D){p({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",D)}document.body.removeChild(m),R=e,T=u;return}T=u,R=e;const g=t.barrage;let r=document.createElement("input");r.value=g,document.body.appendChild(r),r.select();try{document.execCommand("Copy"),se(),console.log("内容已复制到剪贴板"),w.get(`/machine/addCnt/${t.id}`).then(()=>{})}catch(c){p({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",c),re()}document.body.removeChild(r)},ie=()=>{C.filteredItems=[],L.value=!1},ue=t=>{t.touchStartTime=Date.now()},de=t=>{Date.now()-t.touchStartTime>200&&(t.popoverVisible=!0,setTimeout(()=>{t.popoverVisible=!1},1500))},ce=Z(ee,Ne,2e3),pe=Z(ee,Oe,2e3);async function me(t){const e=t.content,u=ce(e);!u||u==="limitedSuccess"||(Le(),await I())}async function fe(t){const e=t.content,u=pe(e);if(!(!u||u==="limitedSuccess")){if(await ze(t.id)){await I();return}Re()}}return(t,e)=>{const u=be,g=ye,r=ke,c=_e,m=Te,D=he,P=Ee,A=we,F=J("Warning"),ve=J("QuestionFilled"),ge=Me,K=Ce;return d(),v(E,null,[e[27]||(e[27]=o("div",{class:"boomouder"},[o("img",{src:"https://gcore.jsdelivr.net/gh/9WiSHao/AnythingStorage/img/6657boom.webp",alt:"6657boom",class:"boom6657"})],-1)),o("div",Ae,[e[25]||(e[25]=o("div",{class:"card first-card"},[o("div",null,[o("b",null,[o("p",{class:"announcement"}," 新增时光相册(可评论)，新增在线投稿弹幕。玩神照片可以在上方上传照片上传至相册 ")])])],-1)),o("div",Fe,[o("p",null,[e[6]||(e[6]=s(" 这是一个收集6657烂梗的网站: ")),e[7]||(e[7]=o("span",{class:"dgq63136"},[o("a",{href:"https://sb6657.cn"},"sb6657.cn")],-1)),e[8]||(e[8]=s(" 尽情欣赏你们的烂梗吧。 另寻几位玩神老观众(21级牌子或3000h观看时长)，获得后台审核和记录的资格！！ ")),e[9]||(e[9]=o("br",null,null,-1)),o("b",null,[e[4]||(e[4]=s("为了更深入了解用户的需求以及作者需编写论文，特开展玩机器sb6657.cn 用户调研 ")),o("span",{style:{cursor:"pointer",color:"slateblue"},onClick:e[0]||(e[0]=a=>M.value=!0)},"点击我参加"),e[5]||(e[5]=s(" 为了感谢您抽出宝贵的时间参与调研，会在结束时抽取三个后台审核资格。"))])])]),l(u,{modelValue:M.value,"onUpdate:modelValue":e[1]||(e[1]=a=>M.value=a),title:"用户调研",width:"800"},{default:n(()=>e[10]||(e[10]=[o("iframe",{src:"https://www.wjx.cn/vm/OEMMMbD.aspx?width=750&source=iframe&s=t",width:"789",height:"750",frameborder:"0",style:{overflow:"auto"}},null,-1)])),_:1},8,["modelValue"]),o("div",Ke,[o("div",null,[l(g,{type:"primary",onClick:Q},{default:n(()=>e[11]||(e[11]=[s("点我随机一条弹幕")])),_:1}),X((d(),B(D,{data:C.tableData,class:"barrage-table",onRowClick:q},{default:n(()=>[l(m,{prop:"barrage"},{default:n(a=>[l(c,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:n(()=>[o("div",{style:{cursor:"pointer"},onTouchstart:i=>ue(a.row),onTouchend:i=>de(a.row)},[o("span",Xe,h(a.row.barrage),1)],40,We)]),default:n(()=>[o("div",Ge,[(d(!0),v(E,null,U(O(a.row.tags),(i,y)=>(d(),v("div",{key:y,style:{"margin-right":"8px"}},[l(r,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:n(()=>[i.iconUrl?(d(),v("img",{key:0,src:i.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,Ye)):N("",!0),s(" "+h(i.label),1)]),_:2},1024)]))),128))])]),_:2},1032,["visible"])]),_:1}),l(m,{label:"",align:"center",width:"85"},{default:n(()=>[l(g,{type:"primary"},{default:n(()=>e[12]||(e[12]=[s("复制")])),_:1})]),_:1})]),_:1},8,["data"])),[[K,S.value]])])]),o("div",Je,[o("div",null,[l(A,{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=a=>V.value=a),placeholder:G(ae),onKeydown:Ve(I,["enter"]),clearable:"",class:"search-input",onInput:ie},{append:n(()=>[l(g,{type:"primary",onClick:I},{default:n(()=>[l(P,null,{default:n(()=>[l(G(De))]),_:1})]),_:1})]),_:1},8,["modelValue","placeholder"]),L.value?X((d(),B(D,{key:0,data:C.filteredItems,stripe:"",onRowClick:q,"cell-style":{cursor:"Pointer",fontSize:"large"}},{default:n(()=>[l(m,{prop:"barrage"},{default:n(a=>[l(c,{placement:"top",width:"auto",trigger:"hover","popper-class":rt},{reference:n(()=>[o("div",Ze,[o("span",et,h(a.row.barrage),1)])]),default:n(()=>[o("div",tt,[(d(!0),v(E,null,U(O(a.row.tags),(i,y)=>(d(),v("div",{key:y,style:{"margin-right":"8px"}},[l(r,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:n(()=>[i.iconUrl?(d(),v("img",{key:0,src:i.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,ot)):N("",!0),s(" "+h(i.label),1)]),_:2},1024)]))),128))])]),_:2},1024)]),_:1}),l(m,{align:"center",width:"40"},{default:n(a=>[l(Be,{likeCount:a.row.likes,onClick:Y(i=>fe(a.row),["stop"])},null,8,["likeCount","onClick"])]),_:1}),l(m,{align:"center",width:"100"},{default:n(a=>[l(g,{type:"primary",class:"copy-btn",onClick:Y(i=>me(a.row),["stop"])},{default:n(()=>[e[13]||(e[13]=s("复制 🎈")),l(Ue,{num:a.row.cnt},null,8,["num"])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,S.value]]):N("",!0)])]),o("div",lt,[o("div",null,[o("span",null,[e[21]||(e[21]=s("可选标签")),l(c,{width:300},{reference:n(()=>[l(P,{size:"16"},{default:n(()=>[l(F)]),_:1})]),default:n(()=>[e[14]||(e[14]=s(" 为解决烂梗分栏不足和分类不清晰问题。")),e[15]||(e[15]=o("br",null,null,-1)),e[16]||(e[16]=o("b",null,"点击标签即可添加",-1))]),_:1}),l(g,{link:"",type:"success",style:{"margin-left":"50%"}},{default:n(()=>[e[20]||(e[20]=s("投稿标签 ")),l(c,{width:300},{reference:n(()=>[l(P,{size:"16"},{default:n(()=>[l(ve)]),_:1})]),default:n(()=>[e[17]||(e[17]=o("b",null,"功能待完善(后续更新将添加)，请在上方(建议/提交)问卷投稿，sry。",-1)),e[18]||(e[18]=o("br",null,null,-1)),e[19]||(e[19]=o("b",null,"审核巨严格，(重复，相似等)将不通过",-1))]),_:1})]),_:1})]),o("div",nt,[o("div",at,[(d(!0),v(E,null,U(x.value,(a,i)=>(d(),B(r,{round:"",key:i,closable:"",onClose:y=>H(a),onClick:y=>H(a),style:{padding:"15px",cursor:"pointer","font-size":"16px"},type:"primary"},{default:n(()=>[s(h(a.label),1)]),_:2},1032,["onClose","onClick"]))),128))])]),o("span",null,[e[23]||(e[23]=s("已选标签 ")),l(c,{width:250},{reference:n(()=>[l(P,{size:"16"},{default:n(()=>[l(F)]),_:1})]),default:n(()=>[e[22]||(e[22]=o("b",null,"最少一个标签，最多五个标签。",-1))]),_:1})]),o("div",st,[(d(!0),v(E,null,U(k.value,(a,i)=>(d(),B(r,{round:"",key:i,closable:"",onClick:y=>j(a),onClose:y=>j(a),style:{padding:"15px",cursor:"pointer","font-size":"16px"},effect:"dark"},{default:n(()=>[s(h(a.label),1)]),_:2},1032,["onClick","onClose"]))),128))]),l(A,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=a=>_.value=a),maxlength:"255",autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea",placeholder:" 烂梗...."},null,8,["modelValue"]),l(g,{class:"saveBnt",type:"primary",onClick:ne},{default:n(()=>e[24]||(e[24]=[s("投稿")])),_:1})]),l(ge,{right:50,bottom:50})]),l($e,{class:"ChatRoom card"}),e[26]||(e[26]=o("div",{class:"card sixth-card"},[s(" 友情链接 "),o("a",{href:"https://dgq63136.cn",target:"_blank"},"dgq63136.cn"),s("    "),o("a",{href:"https://sb6657.cn/#/Starrysky",target:"_blank"},"星空背景")],-1))])],64)}}},St=te(it,[["__scopeId","data-v-2cc45fe2"]]);export{St as default};
