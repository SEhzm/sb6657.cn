import{N as se,f as ne,g as le,h as re,d as ie,c as ce,v as de,e as ue,a as b,n as me,D as pe}from"./element-plus.Td0FvVtG.js";import{d as _e,r as l,i as he,U as ve,c as h,o as d,a as t,R as s,Q as $,a6 as R,J as n,K as ge,I as L,O as E,P as r,L as W,W as fe,u as k}from"./@vue.kiFpFjC4.js";import{T as be,n as j}from"./@element-plus.CD6l22se.js";import{h as M,_ as we}from"./index.Cj6V41Ui.js";import{f as ye,t as Te}from"./flip-num.CwbM4THT.js";import{c as Ce,l as xe,a as Le}from"./clipboard.D23mOi9I.js";import{c as Ee,p as ke}from"./setMeme.-B-Tk-x0.js";import"./lodash-es.S0Y0Up6J.js";import"./@vueuse.DR1wJ5Y1.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";import"./pinia.C1jrEj6N.js";import"./axios.NIGUFBhG.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.DfLJYrxF.js";const Me={class:"match-library"},Se={class:"match-list"},ze={class:"card-content"},Ve={class:"image-container"},Pe=["src"],Ue={class:"match-info"},De={class:"match-header"},Ne={class:"match-name"},Be={class:"match-details"},Ie={class:"match-location"},$e={class:"match-time"},Re={class:"time-item"},We={class:"time-item"},je={class:"pagination-container"},Ae={class:"memes-view"},Fe={class:"card-table"},Je=["onTouchstart","onTouchend"],Ke={class:"barrage-text"},Oe={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Qe=["src"],qe={style:{"vertical-align":"middle"}},Ge={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},He={class:"pagination-wrapper"},Xe=_e({__name:"matchLib",setup(Ye){const S=l([]),z=l(0),v=l(1),A=l(20),w=l(!1),g=l(null),V=l([]),f=l(!1),P=l(0),y=l(50),_=l(1),T=l([]),F=Te(Le,xe,2e3),U=l(window.innerWidth<=768),D=()=>{U.value=window.innerWidth<=768},N=async()=>{try{const e=await M.get("/machine/getMatchList",{params:{pageNum:v.value,pageSize:A.value}});e.code===200?(S.value=e.data.list,z.value=e.data.total):b.error(e.msg||"Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•")}catch(e){b.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•:",e)}},J=e=>{v.value=e,N()},K=e=>{g.value=e,w.value=!0,_.value=1,C(1)},C=async e=>{if(g.value){f.value=!0;try{const o=await M.get("/machine/matchPageList",{params:{pageNum:e,pageSize:y.value,matchId:g.value.id}});o.code===200?(V.value=o.data.list,P.value=o.data.total):b.error(o.msg||"Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•")}catch(o){b.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•:",o)}finally{f.value=!1}}},B=async e=>{const o=e.barrage,i=F(o);if(!(!i||i==="limitedSuccess")){Ce();try{if(await Ee("match",e.id,_.value,y.value)){await C(_.value);return}}catch(m){console.error("Â§çÂà∂Ê¨°Êï∞+1Â§±Ë¥•:",m)}ke()}},O=e=>{_.value=e,C(e)},Q=e=>{if(!e||e.trim()==="")return[];const o=Array.from(new Set(e.split(",").map(c=>c.trim())));if(!T.value)return o.map(()=>({label:"",iconUrl:""}));const i=new Map(T.value.map(c=>[String(c.dictValue).trim(),c]));return o.map(c=>{const p=i.get(c);return p?{label:p.dictLabel,iconUrl:p.iconUrl}:{label:"",iconUrl:""}})},q=()=>{M.get("/machine/dictList").then(e=>{e.code===200&&(T.value=e.data)}).catch(e=>{console.error("Ëé∑ÂèñÂ≠óÂÖ∏Êï∞ÊçÆÂ§±Ë¥•",e)})},G=e=>{e.touchStartTime=Date.now()},H=e=>{Date.now()-e.touchStartTime>100&&(e.popoverVisible=!0,setTimeout(()=>{e.popoverVisible=!1},1500))},X=e=>e?e.replace("T"," ").split(".")[0]:"";return he(()=>{q(),N(),window.addEventListener("resize",D)}),ve(()=>{window.removeEventListener("resize",D)}),(e,o)=>{var I;const i=re,m=me,c=pe,p=se,x=le,Y=ie,Z=ce,ee=ne,te=ue,ae=de;return d(),h("div",Me,[o[3]||(o[3]=t("div",{class:"card"},[t("span",null,"ÊäïÁ®øÊó∂ÂãæÈÄâÂÖ≥ËÅîËµõ‰∫ãÂ∫ìÂ∞ÜÂä†ÂÖ•Êüê‰∏ÄËµõ‰∫ãÂàõ‰ΩúÁöÑÁÉÇÊ¢óÔºåÁõÆÂâçÂè™Êî∂ÂΩïÂ§ßÂûãËµõ‰∫ã"),t("p",null,"È°µÈù¢‰ªÖÂ±ïÁ§∫Êî∂ÂΩï‰∫éËµõ‰∫ãÊúüÈó¥Âàõ‰ΩúÁöÑÁÉÇÊ¢ó")],-1)),t("div",Se,[(d(!0),h($,null,R(S.value,a=>(d(),L(c,{key:a.id,class:"match-card","body-style":{padding:"0px"},onClick:u=>K(a)},{default:n(()=>[t("div",ze,[t("div",Ve,[t("img",{src:a.matchesImg,class:"match-image"},null,8,Pe)]),t("div",Ue,[t("div",De,[t("h3",Ne,r(a.matchesName),1),s(i,{size:"small",type:"success",class:"match-level"},{default:n(()=>[E(r(a.level),1)]),_:2},1024)]),t("div",Be,[t("div",Ie,[s(m,null,{default:n(()=>[s(k(be))]),_:1}),t("span",null,r(a.matchesLocation),1)]),t("div",$e,[t("div",Re,[s(m,null,{default:n(()=>[s(k(j))]),_:1}),t("span",null,"ÂºÄÂßãÔºö"+r(a.startTime),1)]),t("div",We,[s(m,null,{default:n(()=>[s(k(j))]),_:1}),t("span",null,"ÁªìÊùüÔºö"+r(a.endTime),1)])])])])])]),_:2},1032,["onClick"]))),128))]),t("div",je,[s(p,{"current-page":v.value,"onUpdate:currentPage":o[0]||(o[0]=a=>v.value=a),total:z.value,layout:"total,prev, pager, next",onCurrentChange:J},null,8,["current-page","total"])]),s(te,{modelValue:w.value,"onUpdate:modelValue":o[1]||(o[1]=a=>w.value=a),title:(I=g.value)==null?void 0:I.matchesName,width:U.value?"100%":"75%",class:"match-dialog","destroy-on-close":""},{default:n(()=>[t("div",Ae,[t("div",Fe,[ge((d(),L(ee,{data:V.value,stripe:"","cell-class-name":"hover-pointer","empty-text":"ÊöÇÊó†ÁÉÇÊ¢óÔºåÂø´Êù•ÊäïÁ®øÂêßÔºÅ",onRowClick:B},{default:n(()=>[s(x,{align:"center",width:"60"},{default:n(a=>[s(i,{round:"",effect:"plain"},{default:n(()=>[E(r(a.row.id),1)]),_:2},1024)]),_:1}),s(x,{prop:"barrage"},{default:n(a=>[s(Y,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:n(()=>[t("div",{style:{cursor:"pointer"},onTouchstart:u=>G(a.row),onTouchend:u=>H(a.row)},[t("span",Ke,r(a.row.barrage),1)],40,Je)]),default:n(()=>[t("div",Oe,[(d(!0),h($,null,R(Q(a.row.tags),(u,oe)=>(d(),h("div",{key:oe,style:{"margin-right":"8px"}},[s(i,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:n(()=>[u.iconUrl?(d(),h("img",{key:0,src:u.iconUrl,style:{width:"16px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,Qe)):W("",!0),t("span",qe,r(u.label),1)]),_:2},1024)]))),128)),t("span",Ge," ÊäïÁ®øÊó∂Èó¥: "+r(X(a.row.submitTime)),1)])]),_:2},1032,["visible"])]),_:1}),s(x,{align:"center",width:"100"},{default:n(a=>[s(Z,{type:"primary",class:"copy-btn",onClick:fe(u=>B(a.row),["stop"])},{default:n(()=>[o[2]||(o[2]=E(" Â§çÂà∂ üåà",-1)),s(ye,{num:a.row.cnt},null,8,["num"])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ae,f.value]]),t("div",He,[f.value?W("",!0):(d(),L(p,{key:0,background:"",layout:"prev, pager, next, jumper","current-page":_.value,total:P.value,"pager-count":3,"page-size":y.value,onCurrentChange:O},null,8,["current-page","total","page-size"]))])])])]),_:1},8,["modelValue","title","width"])])}}}),bt=we(Xe,[["__scopeId","data-v-a0976a07"]]);export{bt as default};
