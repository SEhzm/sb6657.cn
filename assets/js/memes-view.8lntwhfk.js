import{c as m,a as N,d as R,e as q,r as $,n as j,o as A,p as L,b as O,l as W,f as Z,q as H,v as J,E as X}from"./element-plus.C4TNmNpl.js";import{h as w,M as Y,_ as G}from"./index.BNUZDu90.js";import{u as K}from"./vue-router.DkBAQHKx.js";import{d as ee,k as te,r as ae,Z as oe,w as le,o as V,c as re,a as b,U as a,O as o,S as u,P as ne,M as ie,F as se}from"./@vue.kwc71ESp.js";import"./lodash-es.CiJSjksT.js";import"./@vueuse.Bmvu7DnR.js";import"./@element-plus.CQ2moJ0T.js";import"./@popperjs.D9SI2xQl.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.CdCgAjqw.js";import"./async-validator.DKvM95Vc.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.B6fDCfyv.js";import"./@floating-ui.8uccrNCM.js";import"./axios.CCb-kr4I.js";const me={class:"cardTable",style:{position:"relative"}},pe={class:"pagination-wrapper"},de={class:"dialog-footer"},ue=ee({__name:"memes-view",setup(ce){const x=K(),y=te(()=>Y.find(l=>l.path===x.path)),v=ae(!0),E={table:[{required:!0,message:"请选择分栏",trigger:"blur"}],barrage:[{required:!0,message:"请输入弹幕",trigger:"blur"}]},t=oe({tableData:[],total:0,pageSize:50,currentPage:1,dialogFormVisible:!1,table:"",barrage:""}),c=(l=1)=>{w.get(y.value.api,{params:{pageNum:l,pageSize:t.pageSize}}).then(e=>{var r,i;t.tableData=((r=e.data)==null?void 0:r.list)||[],t.total=((i=e.data)==null?void 0:i.total)||0,v.value=!1}).catch(e=>{console.error("加载数据失败:",e)})};c(t.currentPage),le(()=>x.path,()=>{t.currentPage=1,v.value=!0,c(1)});const T=()=>{window.scrollTo({top:0,behavior:"smooth"})},k=l=>{t.currentPage=l,T(),c(l)},z=()=>{m({message:"复制成功",type:"success"})},F=()=>{m({message:"复制失败",type:"error"})};let h=0,g=null,C=0;const U=l=>{var _;const e=new Date().getTime(),r={x:event.clientX,y:event.clientY};if(g&&g.x===r.x&&g.y===r.y?(C++,C>4&&X.alert("😡😡😡你在刷次数😡😡😡","请勿使用连点器",{confirmButtonText:"好吧，我错了"})):C=0,e-h<1500){m({title:"请勿刷次数",message:"复制成功，但次数没有增加",type:"warning"});const n=l.barrage;let d=document.createElement("input");d.value=n,document.body.appendChild(d),d.select();try{document.execCommand("Copy")}catch(f){m({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",f)}document.body.removeChild(d),h=e,g=r;return}g=r,h=e;const i=l.barrage;let p=document.createElement("input");p.value=i,document.body.appendChild(p),p.select();try{document.execCommand("Copy"),z(),console.log("内容已复制到剪贴板",y),w.post("/machine/addCnt",{PageNum:t.currentPage,PageSize:t.pageSize,table:(_=y.value)==null?void 0:_.category,id:l.id}).then(n=>{setTimeout(()=>c(t.currentPage),200)})}catch(n){m({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",n),F()}document.body.removeChild(p)},B=()=>{t.table="",t.barrage="",t.dialogFormVisible=!0},P=l=>{t.table===""||t.barrage===""?m.error("请选择分栏或输入弹幕"):w.post("/machine/addUnaudit",{table:t.table,barrage:t.barrage}).then(e=>{c(),l===1&&(t.dialogFormVisible=!1),e.code==="200"?(m.success("投稿成功，待审核(一天内)"),t.barrage=""):m.error("投稿失败，必要时请及时反馈")})};return(l,e)=>{const r=N,i=R,p=q,_=$,n=j,d=A,f=L,S=O,M=W,D=Z,I=H,Q=J;return V(),re(se,null,[b("div",null,[b("div",me,[a(r,{type:"primary",class:"handleAdd",onClick:B},{default:o(()=>e[6]||(e[6]=[u("投稿弹幕")])),_:1}),ne((V(),ie(p,{stripe:"",data:t.tableData,"empty-text":"我还没有加载完喔~~",class:"eldtable","header-cell-style":{color:"#ff0000",fontSize:"13px",whitespace:"normal !important"},"cell-style":{cursor:"Pointer"},onRowClick:U},{default:o(()=>[a(i,{width:"58",prop:"id",label:"序号"}),a(i,{prop:"barrage","min-width":"90",label:"弹幕"}),a(i,{label:"",align:"center",width:"85"},{default:o(()=>[a(r,{type:"primary",label:"操作"},{default:o(()=>e[7]||(e[7]=[u("复制")])),_:1})]),_:1}),a(i,{prop:"cnt",label:"复制次数",width:"55"})]),_:1},8,["data"])),[[Q,v.value]])]),b("div",pe,[b("div",null,[a(_,{background:"red",layout:"prev, pager, next, jumper","current-page":t.currentPage,total:t.total,"pager-count":4,"page-size":t.pageSize,onCurrentChange:k},null,8,["current-page","total","page-size"])])]),a(D,{modelValue:t.dialogFormVisible,"onUpdate:modelValue":e[5]||(e[5]=s=>t.dialogFormVisible=s),draggable:"",title:"投稿弹幕",width:"82%"},{footer:o(()=>[b("div",de,[a(r,{onClick:e[2]||(e[2]=s=>t.dialogFormVisible=!1)},{default:o(()=>e[8]||(e[8]=[u("关闭")])),_:1}),a(r,{type:"primary",onClick:e[3]||(e[3]=s=>P(1))},{default:o(()=>e[9]||(e[9]=[u("投稿并关闭")])),_:1}),a(r,{type:"primary",onClick:e[4]||(e[4]=s=>P(2))},{default:o(()=>e[10]||(e[10]=[u("连续投稿")])),_:1})])]),default:o(()=>[a(M,{model:t,"label-width":"100px",rules:E,"label-position":"right"},{default:o(()=>[a(f,{label:"分栏","label-width":100,prop:"table"},{default:o(()=>[a(d,{modelValue:t.table,"onUpdate:modelValue":e[0]||(e[0]=s=>t.table=s),placeholder:"选择上传的分栏"},{default:o(()=>[a(n,{label:"喷玩机器篇",value:"machine_penWJQ"}),a(n,{label:"木柜子篇",value:"machine_mygo"}),a(n,{label:"直播间互喷篇",value:"machine_ZbjHuPen"}),a(n,{label:"喷选手篇",value:"machine_penPlayer"}),a(n,{label:"+1",value:"machine_p1"}),a(n,{label:"群魔乱舞篇",value:"machine_QMLW"}),a(n,{label:"QUQU",value:"machine_QUQU"})]),_:1},8,["modelValue"])]),_:1}),a(f,{label:"弹幕内容",prop:"barrage"},{default:o(()=>[a(S,{maxlength:"255",modelValue:t.barrage,"onUpdate:modelValue":e[1]||(e[1]=s=>t.barrage=s),autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),a(I,{right:50,bottom:50},{default:o(()=>e[11]||(e[11]=[u("UP")])),_:1})],64)}}}),ze=G(ue,[["__scopeId","data-v-69632dee"]]);export{ze as default};
