const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/wordCloud.CI0i8QEt.js","assets/js/echarts.D13McHMB.js","assets/js/zrender.B_NAtvFA.js","assets/js/tslib.BDyQ-Jie.js","assets/js/echarts-wordcloud.tk4DMxWl.js","assets/js/index.tTq2osAo.js","assets/js/@vue.BltuATdo.js","assets/js/pinia.DfSVr1RC.js","assets/js/axios.ngrFHoWO.js","assets/js/js-cookie.Cz0CWeBA.js","assets/js/element-plus.DQRrSmQa.js","assets/js/lodash-es.CDeyng3v.js","assets/js/@vueuse.7i1SIcsD.js","assets/js/@element-plus.BgPfl9pw.js","assets/js/@popperjs.D_chPuIy.js","assets/js/@ctrl.r5W6hzzQ.js","assets/js/dayjs.BKG3DVjA.js","assets/js/async-validator.9PlIezaS.js","assets/js/memoize-one.BdPwpGay.js","assets/js/normalize-wheel-es.BQoi3Ox2.js","assets/js/@floating-ui.D0iZPv2f.js","assets/js/vue-router.oDprkwHL.js","assets/css/index.C0sUvfrJ.css","assets/css/wordCloud.qpx4COKE.css"])))=>i.map(i=>d[i]);
import{_ as de,C as ce,h as V,A as P,b as ue}from"./index.tTq2osAo.js";import{h as v,l as me,f as ve,al as g,c,o as r,aU as pe,a,R as o,J as l,u as y,E as fe,P as h,L as z,Q as L,a6 as $,W as be,O as p,I as F,aV as he,aI as _e}from"./@vue.BltuATdo.js";import{S as J,T as Q,F as X}from"./@element-plus.BgPfl9pw.js";import{f as ge}from"./flip-num.sbzszbaQ.js";import{c as ye,p as Ce}from"./setMeme.CIq6_tLn.js";import{b as f,a as Y,E as ke}from"./element-plus.DQRrSmQa.js";import"./pinia.DfSVr1RC.js";import"./axios.ngrFHoWO.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.oDprkwHL.js";import"./lodash-es.CDeyng3v.js";import"./@vueuse.7i1SIcsD.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";const Ee={class:"home"},De={class:"card third-card"},Te={class:"random-barrage-header"},xe={class:"refresh-controls"},we={key:0,class:"modern-barrage-container"},Me={class:"barrage-main-content"},Ve={class:"barrage-text-wrapper"},Se={class:"barrage-text"},Be={class:"barrage-meta-info"},Ie={key:0,class:"tags-container"},Ne=["src"],Ue={class:"tag-label"},Re={class:"submit-time"},Ae={class:"copy-count"},Pe={key:1,class:"no-data"},ze={class:"card fifth-card"},Le={class:"preset-tags-container"},$e={class:"preset-tags"},Fe={class:"tag-icon-wrapper"},Oe=["src"],qe={class:"tag-text"},We={class:"added-tags"},je={class:"match-association-container"},Ge={class:"match-section-home"},He={key:0,class:"match-details-box-home"},Je={class:"match-info-row-home"},Qe=["src","alt"],Xe={class:"match-name-home"},Ye={class:"match-time-home"},Ke={key:1,class:"no-match-info-home"},Ze={class:"wordCloudDiv"},et={class:"word-cloud-title"},tt={__name:"Home",setup(at){const D=v(!0),B=v(!1),n=me({tableData:[]}),I=v([]),K=()=>{V.get("/machine/dictList").then(t=>{t.code===200&&(I.value=t.data,T.value=t.data.map(e=>({iconUrl:e.iconUrl,label:e.dictLabel,value:e.dictValue})))}).catch(t=>{console.error("获取字典数据失败",t)})},O=t=>{if(!t||t.trim()==="")return[];const e=Array.from(new Set(t.split(",").map(u=>u.trim())));if(!I.value)return e.map(()=>({label:"",iconUrl:""}));const d=new Map(I.value.map(u=>[String(u.dictValue).trim(),u]));return e.map(u=>{const m=d.get(u);return m?{label:m.dictLabel,iconUrl:m.iconUrl}:{label:"",iconUrl:""}})};K();const C=v(""),T=v([]),x=v([]),_=v([]),i=v(null),S=v(!1);function Z(){V.get("/machine/InProgressMatch").then(t=>{t.code===200&&t.data?i.value=t.data:i.value=null,console.log("Fetched match data:",i.value)}).catch(t=>{console.error("Failed to fetch in progress match:",t),i.value=null})}ve(()=>{Z()});const q=t=>{x.value=x.value.filter(e=>e.value!==t.value),_.value=_.value.filter(e=>e!==t.value),T.value.push(t)},W=t=>{if(_.value.length>=5){f.info("最多5个标签");return}x.value.some(e=>e.value===t.value)||(x.value.push(t),_.value.push(t.value),T.value=T.value.filter(e=>e.value!==t.value))},ee=()=>{if(_.value.length===0||C.value===""||C.value===null)f.error("请选择标签或输入弹幕");else{if(_.value.length>5){f.error("最少一个标签，最多五个标签。");return}const t={tags:_.value.join(","),barrage:C.value};S.value&&i.value&&(t.matchId=i.value.id),V.post(P.SUBMIT_MEME,t).then(e=>{C.value="",S.value=!1,e.code===200?f.success("投稿成功，待审核(一天内)"):e.code===500?f.error("烂梗已经有了，勿重复提交"):f.error("请求失败")}).catch(e=>{console.error("投稿失败",e),f.error("请求失败")})}},te=()=>{V.get(P.GET_RAND_ONE_MEME).then(t=>{n.tableData=[t.data],D.value=!1}).catch(t=>{console.error("随机失败")})},j=async()=>{if(!D.value){B.value=!0,D.value=!0;try{await V.get(P.GET_RAND_ONE_MEME).then(t=>{n.tableData=[t.data],D.value=!1})}catch{console.error("随机失败"),D.value=!1}setTimeout(()=>{B.value=!1},600)}};let N=0,w=null,U=0;const G=async(t,e)=>{const d=Date.now(),b={x:e.clientX,y:e.clientY};if(w&&w.x===b.x&&w.y===b.y?(U++,U>4&&ke.alert("😡😡😡你在刷次数😡😡😡","请勿使用连点器",{confirmButtonText:"好吧，我错了"})):U=0,d-N<1500){f({title:"请勿刷次数",message:"复制成功，但次数没有增加",type:"warning"});const k=t.barrage;let E=document.createElement("input");E.value=k,document.body.appendChild(E),E.select();try{document.execCommand("Copy")}catch(R){f({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",R)}document.body.removeChild(E),N=d,w=b;return}w=b,N=d;const u=t.barrage;let m=document.createElement("input");m.value=u,document.body.appendChild(m),m.select();try{document.execCommand("Copy"),ae(),console.log("内容已复制到剪贴板"),await ye("",t.id)?n.tableData[0]&&n.tableData[0].id===t.id&&(n.tableData[0].cnt=String(Number(n.tableData[0].cnt||0)+1)):Ce()}catch(k){f({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",k),se()}document.body.removeChild(m)};te();const ae=()=>{Y({message:"复制成功",type:"success"})},se=()=>{Y({message:"复制失败，请检查浏览器是否禁用navigator.clipboard对象或手动复制,请勿使用夸克浏览器",type:"error"})},oe=t=>{t.touchStartTime=Date.now()},le=t=>{Date.now()-t.touchStartTime>100&&(t.popoverVisible=!0,setTimeout(()=>{t.popoverVisible=!1},1500))},H=v(null),ne=he(()=>ue(()=>import("./wordCloud.CI0i8QEt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])));function re(){var t,e;(e=(t=H.value)==null?void 0:t.getData)==null||e.call(t)}const ie=t=>t?t.replace("T"," ").split(".")[0]:"";return(t,e)=>{const d=g("el-icon"),b=g("el-popover"),u=g("el-button"),m=g("el-tag"),k=g("el-input"),E=g("el-checkbox"),R=g("el-backtop");return r(),c("div",Ee,[e[24]||(e[24]=pe('<div class="boomouder" data-v-a4fdd727><img src="https://gcore.jsdelivr.net/gh/9WiSHao/AnythingStorage/img/6657boom.webp" alt="6657boom" class="boom6657" data-v-a4fdd727></div><div class="card first-card" data-v-a4fdd727><div data-v-a4fdd727><b data-v-a4fdd727><p class="announcement" data-v-a4fdd727> 因为GreasyFork被墙，你可以 <a href="https://cdn.hguofichp.cn/sb6657.cn%E6%96%97%E9%B1%BC%E7%8E%A9%E6%9C%BA%E5%99%A8%E7%83%82%E6%A2%97%E6%94%B6%E9%9B%86.user.js" target="_blank" data-v-a4fdd727>点击我下载最新的油猴插件</a> ，你只需要将下载的文件拖入油猴管理面板即可 </p></b></div></div><div class="card second-card" data-v-a4fdd727><p data-v-a4fdd727> 这是一个收集6657烂梗的网站: <span class="dgq63136" data-v-a4fdd727><a href="https://sb6657.cn" data-v-a4fdd727>sb6657.cn</a></span> 尽情欣赏你们的烂梗吧。 <b data-v-a4fdd727>开放注册功能，可能会出现收不到邮件的情况。</b><b data-v-a4fdd727>目前已支持玩机器直播间开播提醒</b></p></div>',3)),a("div",De,[a("div",Te,[e[7]||(e[7]=a("h3",{class:"random-barrage-title"},"随机一条烂梗",-1)),a("div",xe,[a("span",{class:"refresh-text",onClick:j},"换一换"),o(d,{class:fe(["refresh-icon",{rotating:B.value}]),onClick:j,size:"18"},{default:l(()=>[o(y(J))]),_:1},8,["class"])])]),n.tableData&&n.tableData.length>0?(r(),c("div",we,[a("div",{class:"modern-barrage-card",onClick:e[1]||(e[1]=s=>G(n.tableData[0],s)),onTouchstart:e[2]||(e[2]=s=>oe(n.tableData[0])),onTouchend:e[3]||(e[3]=s=>le(n.tableData[0]))},[a("div",Me,[a("div",Ve,[a("span",Se,h(n.tableData[0].barrage),1)]),a("div",Be,[O(n.tableData[0].tags).length>0?(r(),c("div",Ie,[(r(!0),c(L,null,$(O(n.tableData[0].tags),(s,M)=>(r(),c("div",{key:M,class:"modern-tag"},[s.iconUrl?(r(),c("img",{key:0,src:s.iconUrl,class:"tag-icon"},null,8,Ne)):z("",!0),a("span",Ue,h(s.label),1)]))),128))])):z("",!0),a("div",Re,h(ie(n.tableData[0].submitTime)),1)])]),a("div",{class:"modern-copy-button",onClick:e[0]||(e[0]=be(s=>G(n.tableData[0],s),["stop"]))},[e[8]||(e[8]=a("div",{class:"copy-text"},"复制",-1)),e[9]||(e[9]=a("div",{class:"copy-icon"},"📋",-1)),a("div",Ae,[o(ge,{num:n.tableData[0].cnt||0},null,8,["num"])]),e[10]||(e[10]=a("div",{class:"copy-ripple"},null,-1))])],32)])):(r(),c("div",Pe,"暂无弹幕数据"))]),a("div",ze,[a("div",null,[a("span",null,[e[17]||(e[17]=p(" 可选标签 ",-1)),o(b,{width:300},{reference:l(()=>[o(d,{size:"16"},{default:l(()=>[o(y(Q))]),_:1})]),default:l(()=>[e[11]||(e[11]=p(" 为解决烂梗分栏不足和分类不清晰问题。 ",-1)),e[12]||(e[12]=a("br",null,null,-1)),e[13]||(e[13]=a("b",null,"点击标签即可添加",-1))]),_:1}),o(u,{link:"",type:"success",class:"submit-tag-button"},{default:l(()=>[e[16]||(e[16]=p(" 投稿标签 ",-1)),o(b,{width:300},{reference:l(()=>[o(d,{size:"16"},{default:l(()=>[o(y(X))]),_:1})]),default:l(()=>[e[14]||(e[14]=a("b",null,"请在上方(建议/提交)问卷投稿。",-1)),e[15]||(e[15]=a("br",null,null,-1))]),_:1})]),_:1})]),a("div",Le,[a("div",$e,[(r(!0),c(L,null,$(T.value,(s,M)=>(r(),F(m,{round:"",key:M,closable:"",onClose:A=>W(s),onClick:A=>W(s),class:"preset-tag",type:"primary"},{default:l(()=>[a("div",Fe,[s.iconUrl?(r(),c("img",{key:0,src:s.iconUrl,class:"tag-icon"},null,8,Oe)):z("",!0),a("span",qe,h(s.label),1)])]),_:2},1032,["onClose","onClick"]))),128))])]),a("span",null,[e[19]||(e[19]=p(" 已选标签 ",-1)),o(b,{width:250},{reference:l(()=>[o(d,{size:"16"},{default:l(()=>[o(y(Q))]),_:1})]),default:l(()=>[e[18]||(e[18]=a("b",null,"最少一个标签，最多五个标签。",-1))]),_:1})]),a("div",We,[(r(!0),c(L,null,$(x.value,(s,M)=>(r(),F(m,{round:"",key:M,closable:"",onClick:A=>q(s),onClose:A=>q(s),class:"added-tag",effect:"dark"},{default:l(()=>[p(h(s.label),1)]),_:2},1032,["onClick","onClose"]))),128))]),o(k,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=s=>C.value=s),maxlength:"255",autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea",placeholder:" 烂梗...."},null,8,["modelValue"]),a("div",je,[a("div",Ge,[o(E,{modelValue:S.value,"onUpdate:modelValue":e[5]||(e[5]=s=>S.value=s),disabled:!i.value,class:"match-checkbox-home"},{default:l(()=>[e[20]||(e[20]=p(" 关联赛事库 ",-1)),o(d,{color:"#3db302ff",size:"16"},{default:l(()=>[o(y(X))]),_:1})]),_:1},8,["modelValue","disabled"]),i.value?(r(),c("div",He,[a("div",Je,[a("img",{src:i.value.matchesImg,class:"match-image-home",alt:i.value.matchesName},null,8,Qe),a("span",Xe,h(i.value.matchesName),1)]),a("div",Ye,h(i.value.startTime)+" 至 "+h(i.value.endTime),1)])):(r(),c("div",Ke,"当前无正在进行的大型赛事")),o(u,{class:"saveBnt",type:"primary",onClick:ee},{default:l(()=>[...e[21]||(e[21]=[p("投稿",-1)])]),_:1})])])]),o(R,{right:50,bottom:50})]),o(ce,{class:"ChatRoom card"}),e[25]||(e[25]=a("div",{class:"card sixth-card"},[p(" 友情链接 "),a("a",{href:"https://dgq63136.cn",target:"_blank"},"dgq63136.cn"),p("     "),a("a",{href:"https://sb6657.cn/#/Starrysky",target:"_blank"},"星空背景")],-1)),a("div",Ze,[a("span",et,[e[22]||(e[22]=p(" 搜索词云 ",-1)),o(d,{size:"20",class:"word-cloud-refresh-icon",onClick:e[6]||(e[6]=s=>re())},{default:l(()=>[o(y(J))]),_:1})]),(r(),F(_e,null,{default:l(()=>[o(y(ne),{ref_key:"wordCloudRef",ref:H},null,512)]),fallback:l(()=>[...e[23]||(e[23]=[a("div",{class:"word-cloud-loading"},"词云加载中...",-1)])]),_:1}))])])}}},kt=de(tt,[["__scopeId","data-v-a4fdd727"]]);export{kt as default};
