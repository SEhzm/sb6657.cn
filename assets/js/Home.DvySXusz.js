import{c as De,v as Me,g as Ve,d as Ie,h as Ue,n as $e,k as Be,l as ze,w as Re,x as Pe,b as m,f as Fe,a as de,E as Ae}from"./element-plus.BPmODNcd.js";import{c,o as r,r as d,i as Ne,X as Oe,ag as Y,a as o,aT as Le,Q as a,J as K,I as n,M as p,H as V,P as E,a6 as I,K as A,O as g,u as ue,a4 as je,R as Qe,V as We}from"./@vue.Ca5AQEsS.js";import{_ as G,h as b,C as He,A as L}from"./index.DkI5jqre.js";import{M as qe}from"./@element-plus.De7neK-R.js";import{_ as Ye}from"./favicon.CJfgpdIL.js";import{f as Ke,t as Ge}from"./flip-num.Bv2cXO95.js";import{c as Xe,l as Je,a as Ze}from"./clipboard.BNuoRXGs.js";/* empty css                                                                 */import"./lodash-es.S0Y0Up6J.js";import"./@vueuse.BFkoDYlQ.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.DcnvBwdO.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.58V2siOx.js";import"./pinia.Dz8zdBJG.js";import"./axios.xsH4HHeE.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.DhOS9MZH.js";const et={},tt={src:Ye,alt:"",style:{width:"30px"}};function ot(X,U){return r(),c("img",tt)}const lt=G(et,[["render",ot]]),at={__name:"wordCloud",setup(X,{expose:U}){const _=d(null),S=[];Ne(()=>{$()});function $(){b.get("/machine/WordCloud").then(D=>{S.value=D,x()}).catch(D=>{console.error(D)})}function x(){_.value&&echarts.init(_.value,"macarons").setOption({tooltip:{show:!0,borderColor:"#fe9a8bb3",borderWidth:1,padding:[5,5,5,5],confine:!0,backgroundColor:"rgba(255, 255, 255, .9)",textStyle:{color:"hotpink",lineHeight:16},extraCssText:"box-shadow: 0 4px 20px -4px rgba(199, 206, 215, 1);border-radius: 4px;"},series:[{type:"wordCloud",shape:"pentagon",left:"center",top:"center",width:"100%",height:"100%",right:null,bottom:null,sizeRange:[16,30],rotationRange:[-20,20],rotationStep:25,gridSize:15,drawOutOfBound:!1,layoutAnimation:!0,textStyle:{fontFamily:"PingFangSC-Semibold",fontWeight:600,color:function(B){return["#0d3555","#58D5FF","#0093c4","#0d3555","#0093c4","#0d3555","#73DDFF","#58D5FF","#ff0000","#00ff00","#ff0000","#00ff00","#1a721a","#1a721a","#1a721a"][parseInt(Math.random()*15)]}},emphasis:{focus:"none"},data:S.value}]})}return U({getData:$}),(D,B)=>(r(),c("div",{ref_key:"wordCloud",ref:_,style:{height:"270px",width:"300px"}},null,512))}},nt=G(at,[["__scopeId","data-v-d2b1d121"]]),rt={class:"home"},st={class:"card third-card"},it=["onTouchstart","onTouchend"],dt={class:"barrage-text"},ut={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},ct=["src"],pt={style:{"vertical-align":"middle"}},ft={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},mt={class:"card fourth-card"},vt={style:{display:"flex"}},gt={class:"added-tags"},_t={class:"preset-tags-container"},ht={class:"preset-tags"},yt=["src"],bt={style:{"vertical-align":"middle"}},xt={style:{cursor:"pointer"}},Ct={class:"barrage-text"},wt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},kt=["src"],Tt={style:{"vertical-align":"middle"}},Et={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},St={class:"card fifth-card"},Dt={class:"preset-tags-container"},Mt={class:"preset-tags"},Vt=["src"],It={style:{"vertical-align":"middle"}},Ut={class:"added-tags"},$t={class:"wordCloudDiv"},Bt={style:{"background-color":"white","border-radius":"25px",padding:"5px"}},zt="custom-popover",Rt={__name:"Home",setup(X){const U=d(!0),_=d(!1),S=d(!1),$=d("数据为空"),x=Oe({getRandOne:[],filteredItems:[],tableData:[],table:"",barrage:""});(()=>{sessionStorage.getItem("firstOpening")||b.get("https://api.vvhan.com/api/visitor.info").then(t=>{const e=t;localStorage.setItem("ip",t.ip),m({icon:lt,dangerouslyUseHTMLString:!0,title:"你好",message:`
            <p>
                欢迎来自<b>${e.location||"地球"}</b>的朋友<br/>  
                ${e.system||"外星操作系统"} ${e.browser||"牛逼浏览器"}<br/>
                IP: ${e.ip||"地球"}
            </p>
            `,offset:50,customClass:"myClass",duration:1e3}),sessionStorage.setItem("firstOpening",1)})})();const B=d([]),J=()=>{b.get("/machine/dictList").then(t=>{t.code===200&&(B.value=t.data,h.value=t.data.map(e=>({iconUrl:e.iconUrl,label:e.dictLabel,value:e.dictValue})))}).catch(t=>{console.error("获取字典数据失败",t)})},Z=t=>{if(!t||t.trim()==="")return[];const e=Array.from(new Set(t.split(",").map(i=>i.trim())));if(!B.value)return e.map(()=>({label:"",iconUrl:""}));const u=new Map(B.value.map(i=>[String(i.dictValue).trim(),i]));return e.map(i=>{const f=u.get(i);return f?{label:f.dictLabel,iconUrl:f.iconUrl}:{label:"",iconUrl:""}})};J();const z=d(""),j=d(!1),N=d([]),M=d(""),h=d([]),R=d([]),C=d([]),w=d([]),P=d([]),ee=t=>{R.value=R.value.filter(e=>e.value!==t.value),w.value=w.value.filter(e=>e!==t.value),h.value.push(t)},te=t=>{if(w.value.length>=5){m.info("最多5个标签");return}R.value.some(e=>e.value===t.value)||(R.value.push(t),w.value.push(t.value),h.value=h.value.filter(e=>e.value!==t.value))},ce=()=>{if(w.value.length===0||M.value===""||M.value===null)m.error("请选择标签或输入弹幕");else{if(w.value.length>5){m.error("最少一个标签，最多五个标签。");return}b.post(L.SUBMIT_MEME,{tags:w.value.join(","),barrage:M.value}).then(t=>{M.value="",t.code===200?m.success("投稿成功，待审核(一天内)"):t.code===500?m.error("烂梗已经有了，勿重复提交"):m.error("请求失败")}).catch(t=>{console.error("投稿失败",t),m.error("请求失败")})}},Q=t=>{C.value=C.value.filter(e=>e.value!==t.value),P.value=P.value.filter(e=>e!==t.value),h.value.push(t)},oe=t=>{if(P.value.length>=5){m.info("最多5个标签");return}C.value.some(e=>e.value===t.value)||(C.value.push(t),P.value.push(t.value),h.value=h.value.filter(e=>e.value!==t.value))};function pe(){for(N.value=[];C.value.length>0;)Q(C.value[0])}const fe=t=>t.getTime()<new Date("2024-09-24").getTime(),W=()=>{_.value=!0,(z==null||z.value=="")&&($.value="请输入搜索词..."),b.post(L.SEARCH_MEME,{tags:P.value.join(","),barrage:z.value,submitTime:N.value}).then(t=>{S.value=!0,_.value=!1,x.filteredItems=t.data||[]}).catch(t=>{console.error("搜索失败",t),_.value=!1})};var me=d("搜索烂梗...");const le=()=>{b.get(L.GET_RAND_ONE_MEME).then(t=>{x.tableData=[t.data],U.value=!1}).catch(t=>{console.error("随机失败")})};le();const ve=()=>{de({message:"复制成功",type:"success"})},ge=()=>{de({message:"复制失败，请检查浏览器是否禁用navigator.clipboard对象或手动复制,请勿使用夸克浏览器",type:"error"})};let H=0,F=null,O=0;const ae=t=>{const e=new Date().getTime(),u={x:event.clientX,y:event.clientY};if(F&&F.x===u.x&&F.y===u.y?(O++,console.log(O),O>4&&Ae.alert("😡😡😡你在刷次数😡😡😡","请勿使用连点器",{confirmButtonText:"好吧，我错了"})):O=0,e-H<1500){m({title:"请勿刷次数",message:"复制成功，但次数没有增加",type:"warning"});const f=t.barrage;let k=document.createElement("input");k.value=f,document.body.appendChild(k),k.select();try{document.execCommand("Copy")}catch(T){m({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",T)}document.body.removeChild(k),H=e,F=u;return}F=u,H=e;const y=t.barrage;let i=document.createElement("input");i.value=y,document.body.appendChild(i),i.select();try{document.execCommand("Copy"),ve(),console.log("内容已复制到剪贴板"),b.get(`/machine/addCnt/${t.id}`).then(()=>{})}catch(f){m({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",f),ge()}document.body.removeChild(i)},_e=()=>{x.filteredItems=[],S.value=!1},he=t=>{t.touchStartTime=Date.now()},ye=t=>{Date.now()-t.touchStartTime>100&&(t.popoverVisible=!0,setTimeout(()=>{t.popoverVisible=!1},1500))},be=Ge(Ze,Je,2e3);async function xe(t){const e=t.barrage,u=be(e);!u||u==="limitedSuccess"||(b.get(L.INCREASE_COPY_COUNT+"/"+t.id),Xe(),W())}const q=d(null);function Ce(){q.value&&q.value.getData()}const ne=t=>t?t.replace("T"," ").split(".")[0]:"";return(t,e)=>{const u=De,y=Ue,i=Ie,f=Ve,k=Fe,T=$e,re=Be,we=ze,ke=Re,se=Y("Warning"),Te=Y("QuestionFilled"),Ee=Pe,Se=Y("Refresh"),ie=Me;return r(),c(E,null,[e[23]||(e[23]=o("div",{class:"boomouder"},[o("img",{src:"https://gcore.jsdelivr.net/gh/9WiSHao/AnythingStorage/img/6657boom.webp",alt:"6657boom",class:"boom6657"})],-1)),o("div",rt,[e[21]||(e[21]=Le('<div class="card first-card" data-v-f3fef302><div data-v-f3fef302><b data-v-f3fef302><p class="announcement" data-v-f3fef302><p data-v-f3fef302>因为GreasyFork被墙，你可以<a href="https://cdn.hguofichp.cn/sb6657.cn%E6%96%97%E9%B1%BC%E7%8E%A9%E6%9C%BA%E5%99%A8%E7%83%82%E6%A2%97%E6%94%B6%E9%9B%86.user.js" target="_blank" data-v-f3fef302>点击我下载最新的油猴插件</a>，你只需要将下载的文件拖入油猴管理面板即可</p></p></b></div></div><div class="card second-card" data-v-f3fef302><p data-v-f3fef302> 这是一个收集6657烂梗的网站: <span class="dgq63136" data-v-f3fef302><a href="https://sb6657.cn" data-v-f3fef302>sb6657.cn</a></span> 尽情欣赏你们的烂梗吧。 <b data-v-f3fef302>开放注册功能，可能会出现收不到邮件的情况。</b><b data-v-f3fef302>目前已支持玩机器直播间开播提醒</b></p></div>',2)),o("div",st,[o("div",null,[a(u,{type:"primary",onClick:le},{default:n(()=>e[5]||(e[5]=[p("点我随机一条弹幕")])),_:1,__:[5]}),K((r(),V(k,{data:x.tableData,class:"barrage-table",onRowClick:ae},{default:n(()=>[a(f,{prop:"barrage"},{default:n(l=>[a(i,{placement:"top",width:"auto",trigger:"hover",visible:l.row.popoverVisible},{reference:n(()=>[o("div",{style:{cursor:"pointer"},onTouchstart:s=>he(l.row),onTouchend:s=>ye(l.row)},[o("span",dt,g(l.row.barrage),1)],40,it)]),default:n(()=>[o("div",ut,[(r(!0),c(E,null,I(Z(l.row.tags),(s,v)=>(r(),c("div",{key:v,style:{"margin-right":"8px"}},[a(y,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:n(()=>[s.iconUrl?(r(),c("img",{key:0,src:s.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,ct)):A("",!0),o("span",pt,g(s.label),1)]),_:2},1024)]))),128)),o("span",ft,"投稿时间: "+g(ne(l.row.submitTime)),1)])]),_:2},1032,["visible"])]),_:1}),a(f,{label:"",align:"center",width:"85"},{default:n(()=>[a(u,{type:"primary"},{default:n(()=>e[6]||(e[6]=[p("复制")])),_:1,__:[6]})]),_:1})]),_:1},8,["data"])),[[ie,U.value]])])]),o("div",mt,[o("div",null,[o("div",vt,[a(re,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=l=>z.value=l),placeholder:ue(me),onKeydown:je(W,["enter"]),clearable:"",class:"search-input",onInput:_e},{append:n(()=>[a(u,{loading:_.value,type:"primary",onClick:W},{default:n(()=>[a(T,null,{default:n(()=>[a(ue(qe))]),_:1})]),_:1},8,["loading"])]),_:1},8,["modelValue","placeholder"]),a(we,{modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=l=>j.value=l),label:"高级检索 >",onChange:pe,style:{"margin-left":"10px"}},null,8,["modelValue"])]),K(o("div",null,[o("div",null,[e[7]||(e[7]=o("span",{style:{display:"block",color:"var(--el-text-color-secondary)","font-size":"14px"}},"烂梗收集时间范围(可选)",-1)),a(ke,{modelValue:N.value,"onUpdate:modelValue":e[2]||(e[2]=l=>N.value=l),type:"daterange","range-separator":"到","value-format":"YYYY-MM-DD","start-placeholder":"起始","end-placeholder":"结束","disabled-date":fe},null,8,["modelValue"]),e[8]||(e[8]=o("span",{style:{display:"block",color:"var(--el-text-color-secondary)","font-size":"14px"}},"烂梗包含标签(可选)",-1)),o("div",gt,[(r(!0),c(E,null,I(C.value,(l,s)=>(r(),V(y,{round:"",key:s,closable:"",onClick:v=>Q(l),onClose:v=>Q(l),style:{padding:"15px",cursor:"pointer","font-size":"16px"},effect:"dark"},{default:n(()=>[p(g(l.label),1)]),_:2},1032,["onClick","onClose"]))),128))])]),o("div",_t,[o("div",ht,[(r(!0),c(E,null,I(h.value,(l,s)=>(r(),V(y,{round:"",key:s,closable:"",onClose:v=>oe(l),onClick:v=>oe(l),style:{padding:"15px",cursor:"pointer","font-size":"16px"},type:"primary"},{default:n(()=>[l.iconUrl?(r(),c("img",{key:0,src:l.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,yt)):A("",!0),o("span",bt,g(l.label),1)]),_:2},1032,["onClose","onClick"]))),128))])])],512),[[Qe,j.value]]),S.value?K((r(),V(k,{key:0,data:x.filteredItems,stripe:"",onRowClick:ae,"empty-text":$.value,"cell-style":{cursor:"Pointer",fontSize:"large"}},{default:n(()=>[a(f,{prop:"barrage"},{default:n(l=>[a(i,{placement:"top",width:"auto",trigger:"hover","popper-class":zt},{reference:n(()=>[o("div",xt,[o("span",Ct,g(l.row.barrage),1)])]),default:n(()=>[o("div",wt,[(r(!0),c(E,null,I(Z(l.row.tags),(s,v)=>(r(),c("div",{key:v,style:{"margin-right":"8px"}},[a(y,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:n(()=>[s.iconUrl?(r(),c("img",{key:0,src:s.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,kt)):A("",!0),o("span",Tt,g(s.label),1)]),_:2},1024)]))),128)),o("span",Et,"投稿时间: "+g(ne(l.row.submitTime)),1)])]),_:2},1024)]),_:1}),a(f,{align:"center",width:"100"},{default:n(l=>[a(u,{type:"primary",class:"copy-btn",onClick:We(s=>xe(l.row),["stop"])},{default:n(()=>[e[9]||(e[9]=p("复制 🌈")),a(Ke,{num:l.row.cnt},null,8,["num"])]),_:2,__:[9]},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"])),[[ie,_.value]]):A("",!0)])]),o("div",St,[o("div",null,[o("span",null,[e[16]||(e[16]=p("可选标签")),a(i,{width:300},{reference:n(()=>[a(T,{size:"16"},{default:n(()=>[a(se)]),_:1})]),default:n(()=>[e[10]||(e[10]=p(" 为解决烂梗分栏不足和分类不清晰问题。")),e[11]||(e[11]=o("br",null,null,-1)),e[12]||(e[12]=o("b",null,"点击标签即可添加",-1))]),_:1,__:[10,11,12]}),a(u,{link:"",type:"success",style:{"margin-left":"50%"}},{default:n(()=>[e[15]||(e[15]=p("投稿标签 ")),a(i,{width:300},{reference:n(()=>[a(T,{size:"16"},{default:n(()=>[a(Te)]),_:1})]),default:n(()=>[e[13]||(e[13]=o("b",null,"功能待完善(后续更新将添加)，请在上方(建议/提交)问卷投稿，sry。",-1)),e[14]||(e[14]=o("br",null,null,-1))]),_:1,__:[13,14]})]),_:1,__:[15]})]),o("div",Dt,[o("div",Mt,[(r(!0),c(E,null,I(h.value,(l,s)=>(r(),V(y,{round:"",key:s,closable:"",onClose:v=>te(l),onClick:v=>te(l),style:{padding:"15px",cursor:"pointer","font-size":"16px"},type:"primary"},{default:n(()=>[l.iconUrl?(r(),c("img",{key:0,src:l.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,Vt)):A("",!0),o("span",It,g(l.label),1)]),_:2},1032,["onClose","onClick"]))),128))])]),o("span",null,[e[18]||(e[18]=p("已选标签 ")),a(i,{width:250},{reference:n(()=>[a(T,{size:"16"},{default:n(()=>[a(se)]),_:1})]),default:n(()=>[e[17]||(e[17]=o("b",null,"最少一个标签，最多五个标签。",-1))]),_:1,__:[17]})]),o("div",Ut,[(r(!0),c(E,null,I(R.value,(l,s)=>(r(),V(y,{round:"",key:s,closable:"",onClick:v=>ee(l),onClose:v=>ee(l),style:{padding:"15px",cursor:"pointer","font-size":"16px"},effect:"dark"},{default:n(()=>[p(g(l.label),1)]),_:2},1032,["onClick","onClose"]))),128))]),a(re,{modelValue:M.value,"onUpdate:modelValue":e[3]||(e[3]=l=>M.value=l),maxlength:"255",autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea",placeholder:" 烂梗...."},null,8,["modelValue"]),a(u,{class:"saveBnt",type:"primary",onClick:ce},{default:n(()=>e[19]||(e[19]=[p("投稿")])),_:1,__:[19]})]),a(Ee,{right:50,bottom:50})]),a(He,{class:"ChatRoom card"}),e[22]||(e[22]=o("div",{class:"card sixth-card"},[p(" 友情链接 "),o("a",{href:"https://dgq63136.cn",target:"_blank"},"dgq63136.cn"),p("    "),o("a",{href:"https://sb6657.cn/#/Starrysky",target:"_blank"},"星空背景")],-1)),o("div",$t,[o("span",Bt,[e[20]||(e[20]=p("搜索词云")),a(T,{size:"20",style:{cursor:"pointer",animation:"rotating 4s linear infinite reverse"},onClick:e[4]||(e[4]=l=>Ce())},{default:n(()=>[a(Se)]),_:1})]),a(nt,{ref_key:"wordCloudRef",ref:q},null,512)])])],64)}}},ao=G(Rt,[["__scopeId","data-v-f3fef302"]]);export{ao as default};
