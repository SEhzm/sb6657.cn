var At=Object.defineProperty;var mt=(A,n,l)=>n in A?At(A,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):A[n]=l;var ce=(A,n,l)=>mt(A,typeof n!="symbol"?n+"":n,l);import{e as ae,f as Ke,g as Qe,h as ze,d as Ye,c as ue,v as pt,j as pe,k as gt,l as ft,m as xe,n as we,o as Ve,p as Pe,a as O,E as ie,q as vt,r as Fe,s as He,t as qe,u as ht,w as _t,b as wt,x as Et,y as bt}from"./element-plus.BExUxls1.js";import{d as ge,bk as ke,bK as Le,r,c as C,o as m,R as e,J as t,K as le,I as q,O as R,P,a as o,Q as $,a6 as re,L,W as Ee,C as yt,j as Z,w as Ae,M as Ct,T as Oe,u as _,S as ne,bW as ye,a4 as ee,l as kt,k as De,al as me,i as Ne,aU as xt,E as Vt}from"./@vue.kiFpFjC4.js";import{g as Mt,s as Dt,a as Bt,b as Tt}from"./getMeme.DVaQlISb.js";import{b as St,B as Ut,l as It,R as Je,j as We,M as Be}from"./@element-plus.CD6l22se.js";import{f as Ge,t as je,d as Te,u as Me}from"./flip-num.DI6lltvT.js";import{c as Xe,a as Ze,p as $e,l as et,b as tt}from"./setMeme.B11OXT_J.js";import{h as N,_ as X,s as Rt,u as Kt,r as Qt,M as Se,a as zt}from"./index.BxrifLt0.js";import{d as ot,s as Yt}from"./pinia.C1jrEj6N.js";import{a as j}from"./js-cookie.Cz0CWeBA.js";import{J as lt}from"./jsencrypt.BceYZi2u.js";import{C as Pt}from"./CommunityNorms.CUOXHbp7.js";import{u as at,b as Ft}from"./vue-router.DfLJYrxF.js";import"./lodash-es.S0Y0Up6J.js";import"./@vueuse.DR1wJ5Y1.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";import"./axios.NIGUFBhG.js";const Ht="/favicon.ico",qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA1xJREFUWEfFl0uMDFEUhv9zp+eWR8LCQiKqeojWVSQSkQhigYVHwkZibCSIMAssiYUEsfBYSohMhAmxQMTCI0YiZkMsSJDQ1Qymq82IRyzGI/qWqUNNjHT31DtE77ruf87/3XPvOdVN+M8fyuJfzmurPPZ0y3E7s8TXx2QCKBmtxwi0E8BDAEdMR13KCpIJwDbkAwDz6kzbs0JkBfgOQKvfNTOtsKq1W2krkRqglM8tIhZ3RxkRnkihlk9/jXdpIFID2Lo8CMLeIBNmPm5V3R3/FiAvH4MxJ8SkH2OVZZbxOSlEqgqUdG05EXdHJidsMCvq/D8BsHXtFIi3xCQ/bzpqw18HKOnaCiK+mSDxJ9NRk3zdC0POKjjqWVRMoiPwEw0B1wG0JQAAe97SnBDvPeAiiHYXK7UbYXGxAKWpuSUkxJ0kxiMaH4CE8E3HgvkDt7TMt/q+9wXliATIYh7cnrhiVdXaVAC+OYS4TsC4NLuP0K43HXWxeT2wAqW2MW3EXjcYM/+SOQC6azq1xYkAyoY8w8CmWHPmHhAtidX9FhB4Y9Fxz9brR1WgpLduIqIzMUk/C0aHB96WCoBxpdh0F0YBlHV5mQmBF2YYirmHPdFh9dee23rrnTQAfrjpqAbPhi8DUzBuMCe/Ruy+TD/U4uIAPvqaLF3CQkyrb8kGgFI+t5BY3AsFIN5iVtzT9euxFWtK5s8I682PnpHHDQB2fsw0sPcqBKDbdNTKoDXbkP64tZJcxkiAx5MxXtPkl5CBsb/oqANhJrYhOQnAkOC5s/vcR4EV8B+WDdnFwMbmZAK0ZqZTuxZlYhvSHzTrwjQM9FqOKkS2oZ3PLQOL281JmksXZPLc0FZ74KthAES8tVhxT0UC+Iu2IS8AaK8XJgF4Oguy5YushRxhV9FRm5vXQl9GtqGdBLjjz1kxby9W3RNRRzA8wj3vdYBm0HTUxBCw8JTPDHlUALuGFcw9ZtVdGgXwIp9bODS6jUO7x88V/3sg37qDmHYD0Jl5s1V1u8IgyoY8xMCe3+sDBHRGdU4igBGzsiH3/arDPsFUKFRrL0Pmgf9XbSIB5zTKdbZVvr2Na83YCjQn8EGEVIcLvWi4bP5zZjx6UlXX2oGhOOPQOZA0sF53fwYmLOjFYJbYn3WiRDAd4qVAAAAAAElFTkSuQmCC",Lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAcpJREFUWEftlk1uwkAMhe3CJSoFCZbAIQq75BQNJyk9CXCKsCscgmbZSETqJUpdOcykMyaTECX8LMiKiMT+7HnPDsKNL7xxfngA3EcH0t16AQjhFfWQENGq+wRLTD/XHwAwuWLyPBURvTMAGcmTDtL0eRgklwD6jqP+gXBhFJxIAM57EQiV/EsWlgN0kAYHQj6OPkMQ0qw3DDZtdGIfRxM8xs4K5Nj6PgfwRj4qyn8IolVvHMybQBQl58L00VsAnKhNiDSOQjieOV8bb+RPdTFOAA3x8wshIr7xPau1bif2u2iu35fJOWYpQFMIa64QLL2xP5PHWAmgX7AqcQQzg5tzpaxzZwNwcNHOxBv5A1nRiceRZt4wWLoEXA/AttHJrCgaMFU2PhtA2kjNiaOfiVb8wxBbpnY16bL/XeI9C0Akz2zkmmh6wHQBEsNBTohKAMvDQnwMoZK8KJtuZaWmborEWApgia5CTGVTsgzCCWB6mJCmTfeB2UmzE4UAlodbSK67Y+lGHecJgKXeFjehgMgXnXYTLyPe0byC81XZtO0uXYhFlz2GYso12by1380+yQxLvRqdqB2s5gv5fLiPz/Ka9K0+/ujAzTvwBwY/rnW+YWzQAAAAAElFTkSuQmCC",Ot="data:image/png;base64,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",Nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB/lBMVEUAAAACAAAEAAAGAAADAAAFAAAKAAAHAAAQAAABAAACAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAAAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAABAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAADAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAD///+W3QZCAAAAqHRSTlMAAAAAAAAAAAAAAQoWHBsBEjt6vtTd1bx8QBUPWMTy9MhcAS6w+Pm1MwJI2d5RAknk5wEy2+jO6f7r0OU1ELP8cJnh0crL0+PmnWsRVfc8BigiFCMqB2LC9kVKEj77aFJGzx6/lwG7eVvtMS/sIRvcJtJEEwu5BAOLCnaW8wXaw6DH/Yg0OZBee7fwHvH6c2XJkjbGFhlPUzjgOp8tK+rWuDUOxR0pzW3NoAbKAAAAAWJLR0SpJw8GBAAAAAd0SU1FB+gCEwk0EkntIW4AAAIlSURBVDjLY2AgATBycfPw8vFw8zNhk2XiFxAUEhYRFRUTl5CUwlDDxCQtIyu3AgrkFRQFmFlQ5JWUVVRXIAE1dQ0uJBVMmlraK9CAjq4e3BomVn2DFRjAUNcIagYLk7HJihWmZuYWMDkLSyvrFStEbZgYIQbY2q1YYe8greFo7eTs4urm7uFpY+sFVC3uzQIxwMcX6HA/Jhb/gMAgW1up4JBQJiYtoJt9w1hBKpgEwoGmRkSi+JwpSg0oqBANVhAD8n9sHKqCeJACuQSgIAuzEMhdiUmoCqSSQaIpqSwMTNxpIHens6KEHAtTRixQOJmbCajWDcjKzEILfKbsHKCwiBRQAa8OkGUQjK4g1x0oLMrHxMCSlw9keRSgKwgwBArn84GsKATFXwK6gqIIoLBVMVBBSSnIvZ5lqI4srwCJJleyMLCwVoGYHjHI3mBhS7AEiVYrAQ1mkqwBsZ0lyxDRW6tfB044+kzgoK5fkdPQ2GTe3CJVzgIynae1LRMcq67FTOAwaVeT7yjoXGHRJQ4KTpbu0h5IxPf2sYOtZRLoXOHbHzJBzX5iOchKTQlowhAWYIIG6yTRFZOnTJ02fQpEw4wesPzMWdAEw8DCMc3QfvacYmlNiIK55iD5eTIMcH8x6U0TtZg3f8FUJoQCJx89pLBjZFjYqbrCKQmuQE18lhJq/LMs6l/svASiYGn+suW2LOh5i4XTdm4oWJClsiWIi4WBagAAZejSV585JrMAAAAASUVORK5CYII=",Jt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1745163196952'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='2577'%20data-spm-anchor-id='a313x.search_index.0.i2.58913a81ag2QCw'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M898.96%20765.38h-77.17V418.11c0-154.94-114.87-283.22-263.85-305.05%200.11-1.26%200.73-2.35%200.73-3.63%200-25.16-20.4-45.56-45.56-45.56-25.16%200-45.56%2020.4-45.56%2045.56%200%201.29%200.63%202.37%200.73%203.63-148.98%2021.83-263.85%20150.11-263.85%20305.05v347.26h-77.17c-21.31%200-38.58%2017.28-38.58%2038.59s17.28%2038.59%2038.58%2038.59h252.75c9.46%2065.27%2065.25%20115.75%20133.1%20115.75s123.64-50.48%20133.1-115.75h252.75c21.31%200%2038.58-17.28%2038.58-38.59s-17.27-38.58-38.58-38.58zM513.11%20881.13c-25.15%200-46.61-16.13-54.58-38.58h109.16c-7.97%2022.45-29.43%2038.58-54.58%2038.58z%20m231.51-115.75H281.6V418.11c0-127.66%20103.85-231.51%20231.51-231.51s231.51%20103.85%20231.51%20231.51v347.27z'%20fill='%23e3d5b8'%20p-id='2578'%3e%3c/path%3e%3c/svg%3e",Wt=["onTouchstart","onTouchend"],Gt={class:"barrage-text"},jt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Xt=["src"],Zt={style:{"vertical-align":"middle"}},$t=ge({__name:"meme-dialog",props:ke({memeArr:{},loading:{type:Boolean},emptyText:{}},{modelValue:{},modelModifiers:{}}),emits:ke(["refresh"],["update:modelValue"]),setup(A,{emit:n}){const l=Le(A,"modelValue"),u=n,s=je(tt,et,2e3);async function h(v){const y=v.content,p=s(y);if(!(!p||p==="limitedSuccess")){if(Xe(),await Ze(v.category,v.id)){u("refresh");return}$e()}}const x=r([]),f=()=>{N.get("/machine/dictList").then(v=>{v.code===200&&(x.value=v.data)}).catch(v=>{console.error("获取字典数据失败",v)})},w=v=>{if(!v||v.trim()==="")return[];const y=Array.from(new Set(v.split(",").map(K=>K.trim())));if(!x.value)return y.map(()=>({label:"",iconUrl:""}));const p=new Map(x.value.map(K=>[String(K.dictValue).trim(),K]));return y.map(K=>{const U=p.get(K);return U?{label:U.dictLabel,iconUrl:U.iconUrl}:{label:"",iconUrl:""}})};f();const D=v=>{v.touchStartTime=Date.now()},I=v=>{Date.now()-v.touchStartTime>100&&(v.popoverVisible=!0,setTimeout(()=>{v.popoverVisible=!1},1500))};return(v,y)=>{const p=ze,z=Qe,K=Ye,U=ue,T=Ke,V=ae,d=pt;return m(),C("div",null,[e(V,{draggable:"",modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=a=>l.value=a),class:"dialog-main"},{header:t(()=>[yt(v.$slots,"default",{},void 0,!0)]),default:t(()=>[le((m(),q(T,{data:v.memeArr,stripe:"","empty-text":v.emptyText,"cell-class-name":"hover-pointer",onRowClick:h},{default:t(()=>[e(z,{align:"center",width:"60"},{default:t(a=>[e(p,{round:"",effect:"plain"},{default:t(()=>[R(P(a.$index+1),1)]),_:2},1024)]),_:1}),e(z,{prop:"content"},{default:t(a=>[e(K,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:t(()=>[o("div",{style:{cursor:"pointer"},onTouchstart:i=>D(a.row),onTouchend:i=>I(a.row)},[o("span",Gt,P(a.row.content),1)],40,Wt)]),default:t(()=>[o("div",jt,[(m(!0),C($,null,re(w(a.row.tags),(i,E)=>(m(),C("div",{key:E,style:{"margin-right":"8px"}},[e(p,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:t(()=>[i.iconUrl?(m(),C("img",{key:0,src:i.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,Xt)):L("",!0),o("span",Zt,P(i.label),1)]),_:2},1024)]))),128))])]),_:2},1032,["visible"])]),_:1}),e(z,{align:"center",width:"100"},{default:t(a=>[e(U,{type:"primary",class:"copy-btn",onClick:Ee(i=>h(a.row),["stop"])},{default:t(()=>[y[1]||(y[1]=R("复制 (",-1)),e(Ge,{num:a.row.copyCount},null,8,["num"]),y[2]||(y[2]=R(")",-1))]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"])),[[d,v.loading]])]),_:3},8,["modelValue"])])}}}),Ue=X($t,[["__scopeId","data-v-4da6efc1"]]),st=ot("memeTags",()=>{const A=r([]);async function n(){const l=await Mt();A.value=l}return{memeTags:A,setMemeTags:n}}),eo={class:"advanced-search"},to={class:"title"},oo={class:"title-left"},lo={class:"collapse-text"},ao={class:"collapsible-content"},so={class:"time-container"},no={class:"tags-container"},io={class:"selected-tags"},ro={key:0,class:"tags"},uo={class:"tag-icon-wrapper"},co=["src"],Ao={class:"tag-label"},mo={key:1,class:"empty-tips"},po={class:"all-tags"},go={class:"tags"},fo={class:"tag-icon-wrapper"},vo=["src"],ho={class:"tag-label"},_o={class:"empty-state"},wo=["innerHTML"],Eo={class:"popover-details"},bo={class:"tag-list"},yo={class:"tag-icon-wrapper"},Co=["src"],ko={class:"tag-label"},xo={class:"submit-time"},Vo={key:0,class:"pagination-container"},Mo=ge({__name:"search-dialog",props:ke({searchKey:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(A){const n=Le(A,"modelValue"),l=A,u=st(),{memeTags:s}=Yt(u),h=r([]),x=r(!1),f=r("正在搜索中...坐和放宽..."),w=r("id");function D(){h.value=[],U.value=1,V.value=0,f.value="正在搜索中...坐和放宽..."}function I(g){return g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}async function v(g,c,H){const S=await Dt(g,c,H);!S||S==="notfound"?(h.value=[],V.value=0,U.value=1,f.value="没有找到搜索结果。想要补充更多烂梗？请去首页投稿！"):(h.value=S,V.value=S.length,U.value=1)}function y(){h.value.sort((g,c)=>c.copyCount-g.copyCount),w.value="copy"}function p(){h.value.sort((g,c)=>Number(c.id)-Number(g.id)),w.value="id"}const z=Te(async g=>{g&&(x.value=!0,D(),await v(g),x.value=!1)},300),K=Te(async(g,c,H)=>{h.value=[],await v(g,c,H)},300),U=r(1),T=r(20),V=r(0),d=Z(()=>{const g=(U.value-1)*T.value,c=g+T.value;return h.value.slice(g,c)}),a=r(!0),i=r([]),E=r([]),Y=r([]);let F=!1;function J(){E.value=[],i.value=[...s.value],Y.value=[]}function W(){a.value=!a.value}function B(){E.value.length===0&&Y.value.length===0||(J(),D())}const de=g=>g.getTime()<new Date("2024-09-24").getTime();function k(g){E.value.push(g),i.value=i.value.filter(c=>c.dictValue!==g.dictValue)}function b(g){i.value.push(g),E.value=E.value.filter(c=>c.dictValue!==g.dictValue)}function fe(g){if(!g||g.trim()==="")return[];const c=[...new Set(g.split(",").map(S=>S.trim()))];if(!s.value)return c.map(S=>({label:S,iconUrl:""}));const H=new Map(s.value.map(S=>[String(S.dictValue).trim(),S]));return c.map(S=>{const G=H.get(S);return G?{label:G.dictLabel,iconUrl:G.iconUrl}:{label:"未知标签",iconUrl:""}})}const te=je(tt,et,2e3);async function ve(g){const c=te(g.content);if(!c||c==="limitedSuccess")return;if(Xe(),await Ze("",g.id)){const S=h.value.findIndex(G=>G.id===g.id);S!==-1&&(h.value[S].copyCount+=1)}else $e()}function he(g){return g?g.replace("T"," ").split(".")[0]:""}const be=Z(()=>{if(!l.searchKey||!d.value.length)return d.value;const g=new RegExp(I(l.searchKey),"gi");return d.value.map(c=>({...c,highlightedContent:c.content.replace(g,H=>`<span style="background-color: yellow">${H}</span>`)}))});return Ae(n,g=>{g||(D(),J())}),Ae(()=>l.searchKey,g=>z(g),{immediate:!0}),Ae(s,g=>{F||g.length===0||(F=!0,i.value=[...g])}),Ae([E,Y],([g,c])=>{const H=g.map(S=>S.dictValue);K(l.searchKey,H,c)},{deep:!0}),(g,c)=>{const H=pe,S=ue,G=gt,Q=ze,se=Qe,rt=Ye,ut=Ke,dt=ft,ct=ae;return m(),C("div",null,[e(ct,{draggable:"",modelValue:n.value,"onUpdate:modelValue":c[5]||(c[5]=M=>n.value=M),class:"dialog-main"},{header:t(()=>[...c[6]||(c[6]=[o("span",{class:"search-tips"},"烂梗搜索结果:",-1)])]),default:t(()=>[o("div",eo,[o("div",to,[o("div",oo,[c[9]||(c[9]=o("span",{class:"title-text"},"高级筛选",-1)),e(S,{text:"",onClick:W,class:"collapse-btn"},{default:t(()=>[o("span",lo,P(a.value?"展开":"收起"),1),e(H,null,{default:t(()=>[(m(),q(Ct(a.value?"ArrowDown":"ArrowUp")))]),_:1})]),_:1}),w.value==="id"?(m(),q(S,{key:0,text:"",type:"info",onClick:y},{default:t(()=>[...c[7]||(c[7]=[R("点击按复制次数排序",-1)])]),_:1})):w.value==="copy"?(m(),q(S,{key:1,text:"",type:"info",onClick:p},{default:t(()=>[...c[8]||(c[8]=[R("点击按id(时间)排序",-1)])]),_:1})):L("",!0)]),e(S,{text:"",type:"danger",onClick:B},{default:t(()=>[...c[10]||(c[10]=[R("清空已选高级搜索",-1)])]),_:1})]),e(Oe,{name:"collapse"},{default:t(()=>[le(o("div",ao,[o("div",so,[e(G,{class:"time-picker",modelValue:Y.value,"onUpdate:modelValue":c[0]||(c[0]=M=>Y.value=M),type:"daterange","range-separator":"到","value-format":"YYYY-MM-DD","start-placeholder":"起始","end-placeholder":"结束","disabled-date":de},null,8,["modelValue"])]),o("div",no,[o("div",io,[c[11]||(c[11]=o("div",{class:"tags-title"},"已选标签:",-1)),E.value.length>0?(m(),C("div",ro,[(m(!0),C($,null,re(E.value,M=>(m(),q(Q,{class:"tag1",key:M.dictValue,round:"",onClick:oe=>b(M)},{default:t(()=>[o("div",uo,[M.iconUrl?(m(),C("img",{key:0,src:M.iconUrl,class:"tag-icon"},null,8,co)):L("",!0),o("span",Ao,P(M.dictLabel),1),e(H,null,{default:t(()=>[e(_(St))]),_:1})])]),_:2},1032,["onClick"]))),128))])):L("",!0),E.value.length===0?(m(),C("div",mo," 暂无已选标签(点击下面标签进行筛选) ")):L("",!0)]),o("div",po,[c[12]||(c[12]=o("div",{class:"tags-title"},"所有标签:",-1)),o("div",go,[(m(!0),C($,null,re(i.value,M=>(m(),q(Q,{class:"tag1",key:M.dictValue,round:"",onClick:oe=>k(M)},{default:t(()=>[o("div",fo,[M.iconUrl?(m(),C("img",{key:0,src:M.iconUrl,class:"tag-icon"},null,8,vo)):L("",!0),o("span",ho,P(M.dictLabel),1),e(H,null,{default:t(()=>[e(_(Ut))]),_:1})])]),_:2},1032,["onClick"]))),128))])])])],512),[[ne,!a.value]])]),_:1})]),e(ut,{data:be.value,stripe:"","cell-class-name":"hover-pointer","row-key":"id",lazy:!0},{empty:t(()=>[o("div",_o,[f.value!=="没有找到搜索结果。想要补充更多烂梗？请去首页投稿！"?(m(),q(H,{key:0,class:"loading-icon"},{default:t(()=>[e(_(It))]),_:1})):L("",!0),o("span",null,P(f.value),1)])]),default:t(()=>[e(se,{align:"center",width:"70"},{default:t(M=>[ye([M.$index],()=>(m(),C("div",{class:"row-number"},[R(P(M.row.id),1)])),c,1)]),_:1}),e(se,{prop:"content"},{default:t(M=>[ye([M.row.id,M.row.highlightedContent,l.searchKey],()=>(m(),C("div",null,[e(rt,{placement:"top",width:"auto",trigger:"hover"},{reference:t(()=>[o("div",{class:"barrage-text",innerHTML:M.row.highlightedContent||M.row.content},null,8,wo)]),default:t(()=>[o("div",Eo,[o("div",bo,[(m(!0),C($,null,re(fe(M.row.tags),oe=>(m(),C("div",{key:oe.label},[e(Q,{round:"",effect:"dark",class:"tag-item"},{default:t(()=>[o("div",yo,[oe.iconUrl?(m(),C("img",{key:0,src:oe.iconUrl,class:"tag-icon"},null,8,Co)):L("",!0),o("span",ko,P(oe.label),1)])]),_:2},1024)]))),128))]),o("div",xo,"投稿时间: "+P(he(M.row.submitTime)),1)])]),_:2},1024)])),c,2)]),_:1}),e(se,{align:"center",width:"100"},{default:t(M=>[ye([M.row.id,M.row.copyCount],()=>(m(),C("div",null,[e(S,{type:"primary",class:"copy-btn",onClick:Ee(oe=>ve(M.row),["stop"])},{default:t(()=>[c[13]||(c[13]=R(" 复制 (",-1)),e(Ge,{num:M.row.copyCount},null,8,["num"]),c[14]||(c[14]=R(") ",-1))]),_:2},1032,["onClick"])])),c,3)]),_:1})]),_:1},8,["data"]),V.value>0?(m(),C("div",Vo,[e(dt,{"current-page":U.value,"onUpdate:currentPage":c[4]||(c[4]=M=>U.value=M),"page-size":T.value,total:V.value,layout:"total, prev, pager, next, jumper",small:!0,background:""},null,8,["current-page","page-size","total"])])):L("",!0)]),_:1},8,["modelValue"])])}}}),Do=X(Mo,[["__scopeId","data-v-12215bc2"]]),nt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1569580729849'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1939'%20width='200'%20height='200'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c/style%3e%3c/defs%3e%3cpath%20d='M513.3%20958.5c-142.2%200-397.9-222.1-401.6-440.5V268c1.7-39.6%2031.7-72.3%2071.1-77.3%2049-4.6%2097.1-16.5%20142.7-35.3%2047.8-14%2091.9-38.3%20129.4-71.1%2030.3-24.4%2072.9-26.3%20105.3-4.6%2039.9%2030.7%2083.8%2055.9%20130.5%2074.6%2048.6%2014.7%2098.2%2025.9%20148.4%2033.7%2038.5%207.6%2067.1%2040.3%2069.5%2079.5%203.3%2084.9%202.5%20169.9-2.6%20254.7-33.7%20281.6-253.7%20436.4-392.7%20436.3z%20m-0.1-813.7c-7.2-0.2-14.3%202-20%206.4-39.7%2035.2-86.8%2061.1-137.7%2075.7-46.8%2019.2-96.2%2031-146.6%2035.2-11%203.2-18.8%2013-19.5%2024.4v230.1c3.5%20180.3%20223.3%20361%20323.9%20361s287.3-120.2%20317.6-360.5c7.3-142.7%200-228.6%200-229.6-1.3-13.3-11-24.3-24-27.3-49.6-7.7-98.6-19-146.5-33.7-46.3-19.5-89.7-45.3-129-76.7-5.8-3.8-12.7-5.5-19.5-4.9l1.3-0.1z'%20fill='%23C6CCDA'%20p-id='1940'%3e%3c/path%3e%3cpath%20d='M750.1%20428L490.7%20673.2c-11.7%2011.1-29.5%2012.9-43.1%204.2l-6.8-5.8-141.2-149.4c-9.3-9.3-12.7-22.9-9-35.5%203.8-12.6%2014.1-22.1%2027-24.8%2012.9-2.7%2026.1%201.9%2034.6%2011.9L469%20597.5l233.7-221c14.6-12.8%2036.8-11.6%2049.9%202.7%2013.2%2014.2%2011.5%2035.3-2.5%2048.8'%20fill='%23C6CCDA'%20p-id='1941'%3e%3c/path%3e%3c/svg%3e",Bo=`MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKoR8mX0rGKLqzcWmOzbfj64K8ZIgOdH
nzkXSOVOZbFu/TJhZ7rFAN+eaGkl3C4buccQd/EjEsj9ir7ijT7h96MCAwEAAQ==`,To=`MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAqhHyZfSsYourNxaY
7Nt+PrgrxkiA50efORdI5U5lsW79MmFnusUA355oaSXcLhu5xxB38SMSyP2KvuKN
PuH3owIDAQABAkAfoiLyL+Z4lf4Myxk6xUDgLaWGximj20CUf+5BKKnlrK+Ed8gA
kM0HqoTt2UZwA5E2MzS4EI2gjfQhz5X28uqxAiEA3wNFxfrCZlSZHb0gn2zDpWow
cSxQAgiCstxGUoOqlW8CIQDDOerGKH5OmCJ4Z21v+F25WaHYPxCFMvwxpcw99Ecv
DQIgIdhDTIqD2jfYjPTY8Jj3EDGPbH2HHuffvflECt3Ek60CIQCFRlCkHpi7hthh
YhovyloRYsM+IS9h/0BzlEAuO0ktMQIgSPT3aFAgJYwKpqRYKlLDVcflZFCKY7u3
UP8iWi1Qw0Y=`;function So(A){const n=new lt;return n.setPublicKey(Bo),n.encrypt(A)}function Uo(A){const n=new lt;return n.setPrivateKey(To),n.decrypt(A)}const Io={key:0},Ro={key:1},Ko={class:"slider-container"},Qo={class:"slider-button"},zo={__name:"resetPassword",props:{closeDialog:{type:Function,required:!0}},setup(A){const n=A,l=r(),u=r({username:"",password:"",confirmPassword:"",emailCode:""}),h={username:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:20,message:"密码长度必须介于 6 和 20 之间，且数字和英文混合",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/,message:"密码必须是数字和英文混合",trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"请再次输入新密码"},{required:!0,validator:(V,d,a)=>{u.value.password!==d?a(new Error("两次输入的密码不一致")):a()},trigger:"blur"}],emailCode:[{required:!0,trigger:"change",message:"请输入邮箱验证码"}]},x=r(!1),f=r("发送邮箱验证码"),w=r(!1);let D=null;const I=r(!1),v=r(0),y=r(!1),p=r(!1);function z(){if(!u.value.username){O.info("请先输入邮箱");return}I.value=!0,v.value=0,y.value=!1,p.value=!1}function K(V){V===100&&(y.value=!0,p.value=!0,setTimeout(()=>{I.value=!1,U()},500))}function U(){if(!u.value.username){O.info("请先输入邮箱");return}w.value=!0;let V=10;f.value=`${V}分钟 后重试`,D=setInterval(()=>{V--,V<=0?(clearInterval(D),w.value=!1,f.value="发送邮箱验证码"):f.value=`邮箱中已有验证码，或请 ${V}分钟 后重试`},1e3*60*10),N.get("/login/getMailCode",{params:{toEMail:u.value.username}}).then(d=>{d.code===200?O.success("验证码已发送，请查收邮箱"):(ie.alert(d.msg||"邮箱不存在！或其他错误，请联系开发者","系统提示",{confirmButtonText:"OK"}),clearInterval(D),w.value=!1,f.value="发送邮箱验证码")}).catch(()=>{clearInterval(D),w.value=!1,f.value="发送邮箱验证码"})}function T(){l.value.validate(V=>{V&&(x.value=!0,N.post("/resetPassword",u.value).then(d=>{d.code===200?ie.alert("密码重置成功！请使用新密码登录","系统提示",{type:"success"}).then(()=>{n.closeDialog()}).catch(()=>{}):(O.error(d.msg),x.value=!1)}).catch(d=>{ie.alert(d.message,"系统提示",{type:"success"}),x.value=!1}))})}return(V,d)=>{const a=ue,i=we,E=xe,Y=Ve,F=pe,J=Pe,W=ae;return m(),C("div",null,[e(Y,{ref_key:"resetPasswordRef",ref:l,model:u.value,rules:h,class:"reset-form"},{default:t(()=>[d[7]||(d[7]=o("h3",{class:"title"},"重置密码",-1)),e(E,{prop:"username"},{default:t(()=>[e(i,{modelValue:u.value.username,"onUpdate:modelValue":d[0]||(d[0]=B=>u.value.username=B),type:"text",size:"large",clearable:"","prefix-icon":"Avatar","auto-complete":"off",placeholder:"请输入注册邮箱"},{append:t(()=>[e(a,{type:"primary",disabled:w.value,size:"small",style:{padding:"0","font-weight":"500"},onClick:z},{default:t(()=>[...d[6]||(d[6]=[R("发送邮箱验证码",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(E,{prop:"emailCode"},{default:t(()=>[e(i,{modelValue:u.value.emailCode,"onUpdate:modelValue":d[1]||(d[1]=B=>u.value.emailCode=B),type:"text",maxlength:"4",size:"large",clearable:"",placeholder:"请输入邮箱验证码"},null,8,["modelValue"])]),_:1}),e(E,{prop:"password"},{default:t(()=>[e(i,{modelValue:u.value.password,"onUpdate:modelValue":d[2]||(d[2]=B=>u.value.password=B),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"新密码",onKeyup:ee(T,["enter"])},null,8,["modelValue"])]),_:1}),e(E,{prop:"confirmPassword"},{default:t(()=>[e(i,{modelValue:u.value.confirmPassword,"onUpdate:modelValue":d[3]||(d[3]=B=>u.value.confirmPassword=B),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"确认新密码",onKeyup:ee(T,["enter"])},null,8,["modelValue"])]),_:1}),e(E,{style:{width:"100%"}},{default:t(()=>[e(a,{loading:x.value,size:"large",type:"primary",style:{width:"100%"},onClick:Ee(T,["prevent"])},{default:t(()=>[x.value?(m(),C("span",Ro,"重置中...")):(m(),C("span",Io,"重置密码"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),e(W,{modelValue:I.value,"onUpdate:modelValue":d[5]||(d[5]=B=>I.value=B),title:"安全验证",width:"300px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},{default:t(()=>[o("div",Ko,[d[8]||(d[8]=o("div",{class:"slider-text"},"请滑动至最右侧完成验证",-1)),e(J,{modelValue:v.value,"onUpdate:modelValue":d[4]||(d[4]=B=>v.value=B),min:0,max:100,step:1,"show-tooltip":!1,disabled:y.value,onChange:K},{button:t(()=>[o("div",Qo,[p.value?(m(),q(F,{key:1},{default:t(()=>[e(_(We))]),_:1})):(m(),q(F,{key:0},{default:t(()=>[e(_(Je))]),_:1}))])]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue"])])}}},Yo=X(zo,[["__scopeId","data-v-36784b01"]]),Po={class:"login-box"},Fo={class:"login-code"},Ho=["src"],qo={key:0},Lo={key:1},Oo={__name:"login",props:{onRegister:{type:Function,required:!0},closeDialog:{type:Function,required:!0}},setup(A){const n=A,l=r(""),u=r(!1),s=r({username:"",password:"",rememberMe:!1,code:"",uuid:""}),h=kt({username:[{required:!0,message:"请输入邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"change"}]}),x=r(),f=r(!1),w=Me(),D=r("400px");function I(){w.value&&(D.value="95%")}I();function v(){x.value.validate(d=>{d&&(u.value=!0,s.value.rememberMe?(j.set("username",s.value.username,{expires:525600}),j.set("password",So(s.value.password),{expires:525600}),j.set("rememberMe",s.value.rememberMe,{expires:525600})):(j.remove("username"),j.remove("password"),j.remove("rememberMe")),N.post("/login",s.value).then(a=>{a.code===200?(O.success("登录成功"),Rt(a.token,a.refreshToken,15*24*60*60),U()):(u.value=!1,O.error(a.msg))}).catch(()=>{u.value=!1,y.value&&p()}))})}const y=r(!0);function p(){N.get("/captchaImage").then(d=>{y.value=d.captchaEnabled===void 0?!0:d.captchaEnabled,y.value&&(l.value="data:image/gif;base64,"+d.img,s.value.uuid=d.uuid)})}function z(){const d=j.get("username"),a=j.get("password"),i=j.get("rememberMe");s.value={username:d===void 0?s.value.username:d,password:a===void 0?s.value.password:Uo(a),rememberMe:i===void 0?!1:!!i}}z(),p();function K(){typeof n.onRegister=="function"?n.onRegister():console.error("onRegister is not a function")}function U(){n.closeDialog()}function T(){f.value=!0}function V(){f.value=!1}return(d,a)=>{const i=we,E=xe,Y=vt,F=ue,J=Ve,W=ae;return m(),C("div",null,[o("div",Po,[a[7]||(a[7]=o("div",{class:"title"},"登 录",-1)),e(J,{model:s.value,ref_key:"formRef",ref:x,rules:h},{default:t(()=>[e(E,{prop:"username"},{default:t(()=>[e(i,{"prefix-icon":"Avatar",size:"large",clearable:"",modelValue:s.value.username,"onUpdate:modelValue":a[0]||(a[0]=B=>s.value.username=B),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),e(E,{prop:"password"},{default:t(()=>[e(i,{"show-password":"",size:"large","prefix-icon":"Lock",modelValue:s.value.password,"onUpdate:modelValue":a[1]||(a[1]=B=>s.value.password=B),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(E,{prop:"code"},{default:t(()=>[e(i,{modelValue:s.value.code,"onUpdate:modelValue":a[2]||(a[2]=B=>s.value.code=B),size:"large",clearable:"","auto-complete":"off",placeholder:"请输入验证码",style:{width:"63%"}},{prefix:t(()=>[...a[5]||(a[5]=[o("img",{src:nt,style:{width:"16px"}},null,-1)])]),_:1},8,["modelValue"]),o("div",Fo,[o("img",{src:l.value,onClick:p,class:"login-code-img",onKeyup:ee(v,["enter"])},null,40,Ho)])]),_:1}),e(Y,{modelValue:s.value.rememberMe,"onUpdate:modelValue":a[3]||(a[3]=B=>s.value.rememberMe=B),style:{margin:"0px 0px 5px 0px"}},{default:t(()=>[...a[6]||(a[6]=[R("记住密码",-1)])]),_:1},8,["modelValue"]),o("span",{style:{"margin-left":"35%",cursor:"pointer",color:"blue"},onClick:K},"还没有账号？去注册 >"),o("span",{style:{"margin-left":"75%",cursor:"pointer",color:"blue"},onClick:T},"重置密码 >"),e(E,null,{default:t(()=>[e(F,{loading:u.value,type:"primary",style:{width:"100%"},onClick:v},{default:t(()=>[u.value?(m(),C("span",Lo,"登 录 中...")):(m(),C("span",qo,"登 录"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),e(W,{"align-center":!0,modelValue:f.value,"onUpdate:modelValue":a[4]||(a[4]=B=>f.value=B),draggable:!0,width:D.value,modal:!1,"append-to-body":!0},{default:t(()=>[le(e(Yo,{closeDialog:V},null,512),[[ne,f.value]])]),_:1},8,["modelValue","width"])])}}},No=X(Oo,[["__scopeId","data-v-099e7136"]]),Jo={class:"register-code"},Wo=["src"],Go={key:0},jo={key:1},Xo={class:"slider-container"},Zo={class:"slider-button"},$o={__name:"register",setup(A){const n=r(),l=r({username:"",nickName:"",password:"",confirmPassword:"",code:"",uuid:"",emailCode:""}),s={username:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"},{min:6,max:20,message:"用户密码长度必须介于 6 和 20 之间，且数字和英文混合",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/,message:"密码必须是数字和英文混合",trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"请再次输入您的密码"},{required:!0,validator:(a,i,E)=>{l.value.password!==i?E(new Error("两次输入的密码不一致")):E()},trigger:"blur"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}],emailCode:[{required:!0,trigger:"change",message:"请输入邮箱验证码"}]},h=r(""),x=r(!1),f=r(!0),w=r("发送邮箱验证码"),D=r(!1);let I=null;const v=r(!1),y=r(0),p=r(!1),z=r(!1);function K(){if(!l.value.username){O.info("请先输入邮箱");return}v.value=!0,y.value=0,p.value=!1,z.value=!1}function U(a){a===100&&(p.value=!0,z.value=!0,setTimeout(()=>{v.value=!1,T()},500))}function T(){if(!l.value.username){O.info("请先输入邮箱");return}D.value=!0;let a=10;w.value=`${a}分钟 后重试`,I=setInterval(()=>{a--,a<=0?(clearInterval(I),D.value=!1,w.value="发送邮箱验证码"):w.value=`邮箱中已有验证码，或请 ${a}分钟 后重试`},1e3*60*10),N.get("/login/getMailCode",{params:{toEMail:l.value.username}}).then(i=>{i.code===200?O.success("验证码已发送，请查收邮箱"):(ie.alert(i.msg||"邮箱不存在！ 或其他错误，请联系开发者","系统提示",{confirmButtonText:"OK"}),clearInterval(I),D.value=!1,w.value="发送邮箱验证码")}).catch(()=>{clearInterval(I),D.value=!1,w.value="发送邮箱验证码"})}function V(){n.value.validate(a=>{a&&(x.value=!0,N.post("/register",l.value).then(i=>{const E=l.value.username;i.code===200?ie.alert("<font color='red'>恭喜你，您的账号 "+E+" 注册成功！</font>","系统提示",{dangerouslyUseHTMLString:!0,type:"success"}).then(()=>{}).catch(()=>{}):(O.error(i.msg),x.value=!1,f&&d())}).catch(()=>{x.value=!1,f&&d()}))})}function d(){N.get("/captchaImage").then(a=>{f.value=a.captchaEnabled===void 0?!0:a.captchaEnabled,f.value&&(h.value="data:image/gif;base64,"+a.img,l.value.uuid=a.uuid)})}return d(),(a,i)=>{const E=ue,Y=we,F=xe,J=Ve,W=pe,B=Pe,de=ae;return m(),C("div",null,[e(J,{ref_key:"registerRef",ref:n,model:_(l),rules:s,class:"register-form"},{default:t(()=>[i[10]||(i[10]=o("h3",{class:"title"},"注册",-1)),e(F,{prop:"username"},{default:t(()=>[e(Y,{modelValue:_(l).username,"onUpdate:modelValue":i[0]||(i[0]=k=>_(l).username=k),type:"text",size:"large",clearable:"","prefix-icon":"Avatar","auto-complete":"off",placeholder:"邮箱-用于登录"},{append:t(()=>[e(E,{type:"primary",disabled:_(D),size:"small",style:{padding:"0","font-weight":"500"},onClick:K},{default:t(()=>[...i[8]||(i[8]=[R("发送邮箱验证码",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(F,null,{default:t(()=>[e(Y,{modelValue:_(l).nickName,"onUpdate:modelValue":i[1]||(i[1]=k=>_(l).nickName=k),type:"text",maxlength:"10",size:"large",clearable:"",placeholder:"昵称--平台昵称--后续不可更改"},null,8,["modelValue"])]),_:1}),e(F,{prop:"emailCode"},{default:t(()=>[e(Y,{modelValue:_(l).emailCode,"onUpdate:modelValue":i[2]||(i[2]=k=>_(l).emailCode=k),type:"text",maxlength:"4",size:"large",clearable:"",placeholder:"请输入邮箱验证码"},null,8,["modelValue"])]),_:1}),e(F,{prop:"password"},{default:t(()=>[e(Y,{modelValue:_(l).password,"onUpdate:modelValue":i[3]||(i[3]=k=>_(l).password=k),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"密码",onKeyup:ee(V,["enter"])},null,8,["modelValue"])]),_:1}),e(F,{prop:"confirmPassword"},{default:t(()=>[e(Y,{modelValue:_(l).confirmPassword,"onUpdate:modelValue":i[4]||(i[4]=k=>_(l).confirmPassword=k),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"确认密码",onKeyup:ee(V,["enter"])},null,8,["modelValue"])]),_:1}),_(f)?(m(),q(F,{key:0,prop:"code"},{default:t(()=>[e(Y,{size:"large",modelValue:_(l).code,"onUpdate:modelValue":i[5]||(i[5]=k=>_(l).code=k),"auto-complete":"off",clearable:"",placeholder:"请输入右侧验证码",style:{width:"63%"},onKeyup:ee(V,["enter"])},{prefix:t(()=>[...i[9]||(i[9]=[o("img",{src:nt,style:{width:"16px"}},null,-1)])]),_:1},8,["modelValue"]),o("div",Jo,[o("img",{src:_(h),onClick:d,class:"register-code-img"},null,8,Wo)])]),_:1})):L("",!0),e(F,{style:{width:"100%"}},{default:t(()=>[e(E,{loading:_(x),size:"large",type:"primary",style:{width:"100%"},onClick:Ee(V,["prevent"])},{default:t(()=>[_(x)?(m(),C("span",jo,"注 册 中...")):(m(),C("span",Go,"注 册"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),e(de,{modelValue:_(v),"onUpdate:modelValue":i[7]||(i[7]=k=>De(v)?v.value=k:null),title:"安全验证",width:"300px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},{default:t(()=>[o("div",Xo,[i[11]||(i[11]=o("div",{class:"slider-text"},"请滑动至最右侧完成验证",-1)),e(B,{modelValue:_(y),"onUpdate:modelValue":i[6]||(i[6]=k=>De(y)?y.value=k:null),min:0,max:100,step:1,"show-tooltip":!1,disabled:_(p),onChange:U},{button:t(()=>[o("div",Zo,[_(z)?(m(),q(W,{key:1},{default:t(()=>[e(_(We))]),_:1})):(m(),q(W,{key:0},{default:t(()=>[e(_(Je))]),_:1}))])]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue"])])}}},el=X($o,[["__scopeId","data-v-a2f56577"]]),tl={class:"avatar-wrapper"},ol=["innerHTML"],ll={__name:"userHome",setup(A){const n=Kt(),l=r(!1),u=r(!1),s=Me(),h=r(!1);function x(){l.value=!0,u.value=!1}let f="400px";function w(){s.value&&(f="95%")}w();function D(){ie.confirm("确定退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Qt()}).catch(()=>{})}function I(){l.value=!1,u.value=!0}function v(){l.value=!1}return Ae(()=>n.loginVisible,y=>{l.value=y}),(y,p)=>{const z=me("User"),K=pe,U=me("caret-bottom"),T=He,V=me("router-link"),d=Fe,a=qe,i=ae;return m(),C($,null,[e(a,{onCommand:y.handleCommand,class:"right-menu-item hover-effect",trigger:"hover"},{dropdown:t(()=>[e(d,null,{default:t(()=>[e(V,{to:"/me-post"},{default:t(()=>[e(T,null,{default:t(()=>[...p[4]||(p[4]=[R("我的帖子",-1)])]),_:1})]),_:1}),e(V,{to:"/me-memes"},{default:t(()=>[e(T,null,{default:t(()=>[...p[5]||(p[5]=[R("我的投稿",-1)])]),_:1})]),_:1}),le(e(T,{command:"login",divided:""},{default:t(()=>[o("span",{onClick:x},"登录/注册")]),_:1},512),[[ne,!_(N)]]),e(V,{to:"/userInfo"},{default:t(()=>[e(T,null,{default:t(()=>[...p[6]||(p[6]=[R("个人中心",-1)])]),_:1})]),_:1}),e(T,{command:"login"},{default:t(()=>[o("span",{onClick:p[0]||(p[0]=E=>h.value=!0)},"隐私政策")]),_:1}),le(e(T,{divided:"",command:"logout"},{default:t(()=>[o("span",{onClick:D},"退出登录")]),_:1},512),[[ne,_(N)]])]),_:1})]),default:t(()=>[o("div",tl,[e(K,{size:"32"},{default:t(()=>[e(z)]),_:1}),e(K,null,{default:t(()=>[e(U)]),_:1})])]),_:1},8,["onCommand"]),e(i,{"align-center":!0,modelValue:l.value,"onUpdate:modelValue":p[1]||(p[1]=E=>l.value=E),draggable:!0,width:_(f),modal:!1,"append-to-body":!0},{default:t(()=>[le(e(No,{onRegister:I,closeDialog:v},null,512),[[ne,l.value]])]),_:1},8,["modelValue","width"]),e(i,{"align-center":!0,modelValue:u.value,"onUpdate:modelValue":p[2]||(p[2]=E=>u.value=E),draggable:!0,width:_(f),modal:!1,"append-to-body":!0},{default:t(()=>[le(e(el,null,null,512),[[ne,u.value]])]),_:1},8,["modelValue","width"]),e(i,{modelValue:h.value,"onUpdate:modelValue":p[3]||(p[3]=E=>h.value=E),title:"社区规范与隐私政策",style:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",margin:"auto"},width:_(f),modal:!1,"append-to-body":!0},{default:t(()=>[o("div",{innerHTML:_(Pt)},null,8,ol)]),_:1},8,["modelValue","width"])],64)}}},al=X(ll,[["__scopeId","data-v-4dbc1f65"]]),sl={class:"header"},nl={class:"header-content"},il={class:"logo-link"},rl={class:"elinput-mobile"},ul={class:"header-actions"},dl={class:"elinput"},cl={class:"user-message"},Al={class:"unread-badge"},ml={class:"icon-img"},pl={class:"dialog-header"},gl={class:"dialog-header"},Ie="我还没有加载完喔~~",fl="https://cdn.hguofichp.cn/power.png",vl=ge({__name:"header-bar",setup(A){const n=Me(),l=at(),u=r(!1),s=r(!1),h=r([]),x=r(!0),f=r(!0);async function w(){const k=await Bt();k&&(h.value=k,x.value=!1)}function D(){s.value=!0,I.value=!1,x.value=!0,w()}const I=r(!1),v=r([]),y=r(!0);async function p(){const k=await Tt();k&&(v.value=k,y.value=!1)}function z(){s.value=!1,I.value=!0,y.value=!0,p()}const K=Z(()=>!(n.value&&l.path!=="/home"));w();const U=r(0);setInterval(()=>{const k=h.value.length;U.value=(U.value+1)%k},5e3);const T=r(""),V=r(""),d=r(!1);function a(){if(T.value.trim()===""){O.warning("请输入搜索内容");return}d.value=!0,V.value=T.value}function i(k){k.preventDefault(),k.stopPropagation(),a()}const E=Z(()=>n.value?"100%":"35%");Z(()=>n.value?"90%":"35%");const Y=r(0),F=r(0),J=Z(()=>Y.value+F.value),W=r(!1);async function B(){try{const k=await N.get("/machine/SysMessage/getMsgNum");k.code===200&&(Y.value=k.data.likeAndStatementNum,F.value=k.data.commentNum,W.value=k.data.readFlag)}catch(k){console.error("获取消息数量失败:",k)}}Ne(()=>{B(),setInterval(()=>{B()},10*60*1e3),setTimeout(()=>{u.value=!0,setInterval(()=>{u.value=!0},2*60*60*1e3)},60*60*1e3),setTimeout(()=>{f.value=!1},5e3)});const de=()=>{window.open("https://www.wjx.cn/vm/rQUgnS0.aspx#")};return r(!1),(k,b)=>{const fe=pe,te=ue,ve=we,he=ht,be=_t,g=He,c=me("router-link"),H=Fe,S=qe,G=ae;return m(),C("div",sl,[o("div",nl,[o("div",il,[b[8]||(b[8]=o("a",{href:"https://www.douyu.com/6657",target:"_blank"},[o("img",{src:Ht,alt:"大🐖头",class:"logo-img"}),o("p",{class:"header-title"},"斗鱼玩机器烂梗库")],-1)),o("div",rl,[e(ve,{modelValue:T.value,"onUpdate:modelValue":b[0]||(b[0]=Q=>T.value=Q),placeholder:"输入以搜索烂梗...",clearable:"",onKeyup:ee(i,["enter"])},{append:t(()=>[e(te,{type:"primary",onClick:a},{default:t(()=>[e(fe,null,{default:t(()=>[e(_(Be))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),o("div",ul,[K.value?(m(),C("img",{key:0,src:qt,alt:"热门",class:"hot-barrage-img",onClick:D})):L("",!0),K.value?(m(),C("div",{key:1,onClick:D,class:"hot-barrage"},[e(Oe,{name:"fade"},{default:t(()=>{var Q,se;return[(m(),C("span",{key:U.value,class:"hot-barrage-span"},"热门："+P(((se=(Q=h.value)==null?void 0:Q[U.value])==null?void 0:se.content)||""),1))]}),_:1})])):L("",!0),o("div",dl,[e(ve,{modelValue:T.value,"onUpdate:modelValue":b[1]||(b[1]=Q=>T.value=Q),placeholder:"输入以搜索烂梗...",clearable:"",onKeyup:ee(i,["enter"])},{append:t(()=>[e(te,{type:"primary",onClick:a},{default:t(()=>[e(fe,null,{default:t(()=>[e(_(Be))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(te,{type:"primary",onClick:de,class:"complaint-button"},{default:t(()=>[...b[9]||(b[9]=[R(" 上传照片",-1),o("br",null,null,-1),R(" 建议/提交BUG ",-1)])]),_:1}),e(he,{effect:"light",content:"接程序设计，广告，商务，详情联系邮箱 he20020928@foxmail.com",placement:"bottom"},{default:t(()=>[...b[10]||(b[10]=[o("img",{src:Lt,alt:"heihei",class:"icon-container icon-img"},null,-1)])]),_:1}),b[12]||(b[12]=xt('<a class="icon-container" href="https://sb6657.cn/#/Tampermonkey" data-v-091b2355><img src="https://pic.imgdb.cn/item/6704f830d29ded1a8c738f70.png" alt="油猴" class="icon-img" data-v-091b2355></a><a class="icon-container" href="https://yuba.douyu.com/feed/2639094748291342931" target="_blank" data-v-091b2355><img src="'+Ot+'" alt="douyu" class="icon-img" data-v-091b2355></a><a class="icon-container" href="https://github.com/SEhzm/sb6657/" target="_blank" data-v-091b2355><img src="'+Nt+'" alt="github" class="icon-img" data-v-091b2355></a>',3)),e(he,{visible:f.value,"onUpdate:visible":b[3]||(b[3]=Q=>f.value=Q),content:"如果你喜欢这个网站，可以点我进行赞赏或GitHub点个star~",placement:"bottom",effect:"light"},{default:t(()=>[e(be,{class:"icon-container icon-img",src:fl,fit:"cover",onClick:b[2]||(b[2]=Q=>u.value=!0)})]),_:1},8,["visible"]),e(S,{trigger:"hover"},{dropdown:t(()=>[e(H,null,{default:t(()=>[e(c,{to:"/me-msg"},{default:t(()=>[e(g,null,{default:t(()=>[R(" 评论 ("+P(F.value)+") ",1)]),_:1}),e(g,null,{default:t(()=>[R(" 赞和表态 ("+P(Y.value)+") ",1)]),_:1})]),_:1})]),_:1})]),default:t(()=>[o("div",cl,[b[11]||(b[11]=o("div",{class:"message-icon"},[o("img",{src:Jt,alt:"msg"}),o("div",null,"消息")],-1)),o("span",Al,P(J.value||"0"),1)])]),_:1}),o("div",ml,[e(al)])])]),e(Ue,{modelValue:s.value,"onUpdate:modelValue":b[4]||(b[4]=Q=>s.value=Q),memeArr:h.value,loading:x.value,emptyText:Ie,onRefresh:w},{default:t(()=>[o("div",pl,[b[14]||(b[14]=o("div",null,"24h热门烂梗",-1)),o("div",null,[e(te,{onClick:z},{default:t(()=>[...b[13]||(b[13]=[R("查看近七天热门",-1)])]),_:1})])])]),_:1},8,["modelValue","memeArr","loading"]),e(Ue,{modelValue:I.value,"onUpdate:modelValue":b[5]||(b[5]=Q=>I.value=Q),memeArr:v.value,loading:y.value,emptyText:Ie,onRefresh:p},{default:t(()=>[o("div",gl,[b[16]||(b[16]=o("div",null,"七天热门烂梗",-1)),o("div",null,[e(te,{onClick:D},{default:t(()=>[...b[15]||(b[15]=[R("查看近24h热门",-1)])]),_:1})])])]),_:1},8,["modelValue","memeArr","loading"]),e(Do,{modelValue:d.value,"onUpdate:modelValue":b[6]||(b[6]=Q=>d.value=Q),searchKey:V.value},null,8,["modelValue","searchKey"]),e(G,{modelValue:u.value,"onUpdate:modelValue":b[7]||(b[7]=Q=>u.value=Q),title:"谢谢你",width:E.value},{default:t(()=>[...b[17]||(b[17]=[o("img",{src:"http://cdn.hguofichp.cn/zfb.jpg",alt:"",width:"100%"},null,-1)])]),_:1},8,["modelValue","width"])])}}}),hl=X(vl,[["__scopeId","data-v-091b2355"]]),_l={class:"footer"},wl={class:"content"},El={class:"date-font"},bl=ge({__name:"footer-bar",setup(A){const n=r(0),l=new Date("2026-02-16"),u=new Date;n.value=Math.ceil((l.getTime()-u.getTime())/(1e3*3600*24));const s=new Date("2024-02-07"),h=Z(()=>{const f=new Date().getTime()-s.getTime();return Math.floor(f/(1e3*60*60*24))});return(x,f)=>(m(),C("div",_l,[o("div",wl,[o("div",El,[f[0]||(f[0]=R("距服务器到期还有",-1)),o("span",null,P(n.value),1),f[1]||(f[1]=R("天",-1))]),o("div",null,[f[2]||(f[2]=o("a",{href:"https://ipw.cn/ipv6webcheck/?site=sb6657.cn",title:"",target:"_blank",style:{color:"black"}},[o("img",{style:{display:"inline-block","vertical-align":"middle",width:"150px"},alt:"",src:"https://static.ipw.cn/icon/ipv6-s5.svg"})],-1)),R(" 本站已运行"+P(h.value)+"天 ",1)])])]))}}),yl=X(bl,[["__scopeId","data-v-c95cf16c"]]),it=ot("guibin",{state:()=>({Oni:""}),actions:{updateOni(A){this.Oni=A}}}),Cl=it();class kl{constructor(n,l){ce(this,"timer",null);ce(this,"ws",null);ce(this,"rid");ce(this,"msgHandler");this.rid=n,this.msgHandler=l,"WebSocket"in window&&this.connect()}connect(){const n=Vl(2,5);this.ws=new WebSocket(`wss://danmuproxy.douyu.com:850${n}`),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{this.ws.send(Ce(`type@=loginreq/roomid@=${this.rid}`)),this.ws.send(Ce(`type@=joingroup/rid@=${this.rid}/gid@=-9999/`)),this.timer=window.setInterval(()=>{this.ws.send(Ce("type@=mrkl/"))},4e4)},this.ws.onerror=()=>{this.close()},this.ws.onmessage=l=>{const u=new FileReader;u.onload=()=>{const s=String(u.result).split("\0");for(let h=0;h<s.length;h++)s[h].length>12&&this.msgHandler(s[h])},u.readAsText(new Blob([l.data]))},this.ws.onclose=()=>{this.close(),this.reconnect()}}reconnect(){setTimeout(()=>{this.connect()},3e3)}close(){this.timer!==null&&(clearInterval(this.timer),this.timer=null),this.ws&&(this.ws.close(),this.ws=null)}}function Ce(A){let l=xl(A);const u=l.length+4+4+2+1+1+1,s=new Uint8Array(u),h=new Uint8Array(l.length);for(let w=0;w<h.length;w++)h[w]=l[w];const x=new Uint32Array([l.length+4+2+1+1+1]),f=new Uint32Array([689]);return s.set(new Uint8Array(x.buffer),0),s.set(new Uint8Array(x.buffer),4),s.set(new Uint8Array(f.buffer),8),s.set(h,12),s}function xl(A){const n=[],l=A.length;for(let u=0;u<l;u++){const s=A.charCodeAt(u);s>=65536&&s<=1114111?(n.push(s>>18&7|240),n.push(s>>12&63|128),n.push(s>>6&63|128),n.push(s&63|128)):s>=2048&&s<=65535?(n.push(s>>12&15|224),n.push(s>>6&63|128),n.push(s&63|128)):s>=128&&s<=2047?(n.push(s>>6&31|192),n.push(s&63|128)):n.push(s&255)}return n}function Vl(A,n){return Math.floor(Math.random()*(n-A+1))+A}function _e(A,n,l){const u=A.indexOf(n);if(u===-1)return"";const s=A.indexOf(l,u+n.length);return s===-1?"":A.substring(u+n.length,s)}function Ml(A){const n=A.match(/type@=(.*?)(\/|@)/),l=_e(A,"oni/vn@=","/");if(l&&Cl.updateOni(l),n&&n[1]==="rss"){_e(A,"rid@=","/");const u=_e(A,"ss@=","/"),s=_e(A,"ivl@=","/");console.log(u),u==="1"&&s==="0"&&Dl()}}function Dl(){if(!("Notification"in window)){alert("当前浏览器不支持开播通知");return}Notification.permission!=="granted"?Notification.requestPermission().then(A=>{A==="granted"?Re():alert("你拒绝了通知权限，无法收到开播通知，请在网址左侧打开权限")}):Re()}function Re(){const A=new Notification("来自sb6657.cn开播提醒",{body:"6657直播间已开播，快去观看吧！"});A.onclick=()=>{window.focus(),window.open("https://www.douyu.com/6657","_blank")}}const Bl={class:"tab"},Tl={class:"tab-container"},Sl=["onClick"],Ul={class:"main-content"},Il={class:"sidebar"},Rl={class:"sidebar-icon"},Kl=["src"],Ql={class:"content"},zl={href:"https://github.com/SEhzm/sb6657/blob/master/%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97.md",target:"_blank"},Yl={class:"version"},Pl={class:"GuiBin"},Fl=ge({__name:"MainLayout",setup(A){const n=at(),l=Ft(),u=it();st().setMemeTags();const h=Z(()=>u.Oni),x=r();Ne(()=>{const w=document.querySelector("#global-loading");w&&(w.classList.add("fade-out"),setTimeout(()=>w.remove(),500)),x.value=new kl(6979222,Ml),wt({title:"来自sb6657.cn",dangerouslyUseHTMLString:!0,message:"现已推出造梗Ai（Demo），欢迎使用<br><b>Ai费用不低，请酌情使用~</b>",position:"bottom-left",type:"success",duration:1e4})});function f(w){l.push(w)}return(w,D)=>{const I=Et,v=bt,y=me("router-view");return m(),C($,null,[o("div",null,[e(hl),o("div",Bl,[o("div",Tl,[(m(!0),C($,null,re(_(Se),(p,z)=>(m(),C("div",{class:Vt(`tab1 ${p.path===_(n).path?"selected":"none"}`),key:p.path,onClick:K=>f(p.path)},P(p.text),11,Sl))),128))])]),o("div",Ul,[o("div",Il,[e(v,{router:"",class:"sidebar-el-menu","default-active":w.$route.path},{default:t(()=>[(m(!0),C($,null,re(_(Se),(p,z)=>(m(),q(I,{key:p.path,index:p.path},{default:t(()=>[o("div",Rl,[o("img",{src:p.icon,alt:""},null,8,Kl)]),o("span",null,P(p.text),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),o("div",Ql,[e(y)])]),e(yl)]),o("a",zl,[o("span",Yl,"版本: "+P(_(zt)),1)]),D[0]||(D[0]=o("div",{class:"GuangGaoWei"},[o("span",{style:{display:"flex","font-size":"large",color:"white"}},"广告位招租")],-1)),o("div",Pl,"当前直播间贵宾数:"+P(h.value),1)],64)}}}),ca=X(Fl,[["__scopeId","data-v-a1945dd1"]]);export{ca as default};
