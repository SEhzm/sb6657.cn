import{c as Ie,v as Ue,g as ze,d as Be,h as Re,n as Pe,k as Fe,o as $e,x as Ne,y as Ae,f as Le,b as _,a as ue,E as Oe}from"./element-plus.pEMcb2g5.js";import{r,i as Z,c as u,o as n,X as je,ag as X,aT as Qe,a as o,Q as l,J,I as s,M as p,H as M,P as I,a6 as U,K as $,O as v,u as pe,a4 as We,R as qe,V as He}from"./@vue.Ca5AQEsS.js";import{_ as me,h as w,C as Ye,A as j}from"./index.B-OWe_n7.js";import{M as Ke}from"./@element-plus.w7YOadmw.js";import{f as Ge,t as Xe}from"./flip-num.D8-MtnZ-.js";import{c as Je,l as Ze,a as et}from"./clipboard.uVAJysvJ.js";/* empty css                                                                 */import"./lodash-es.S0Y0Up6J.js";import"./@vueuse.BFkoDYlQ.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.DcnvBwdO.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.58V2siOx.js";import"./pinia.Dz8zdBJG.js";import"./axios.xsH4HHeE.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.DhOS9MZH.js";const tt={__name:"wordCloud",setup(ve,{expose:N}){const g=r(null),D=[];Z(()=>{z()});function z(){w.get("/machine/WordCloud").then(b=>{D.value=b,k()}).catch(b=>{console.error(b)})}function k(){g.value&&echarts.init(g.value,"macarons").setOption({tooltip:{show:!0,borderColor:"#fe9a8bb3",borderWidth:1,padding:[5,5,5,5],confine:!0,backgroundColor:"rgba(255, 255, 255, .9)",textStyle:{color:"hotpink",lineHeight:16},extraCssText:"box-shadow: 0 4px 20px -4px rgba(199, 206, 215, 1);border-radius: 4px;"},series:[{type:"wordCloud",shape:"pentagon",left:"center",top:"center",width:"100%",height:"100%",right:null,bottom:null,sizeRange:[16,30],rotationRange:[-20,20],rotationStep:25,gridSize:15,drawOutOfBound:!1,layoutAnimation:!0,textStyle:{fontFamily:"PingFangSC-Semibold",fontWeight:600,color:function(Q){return["#0d3555","#58D5FF","#0093c4","#0d3555","#0093c4","#0d3555","#73DDFF","#58D5FF","#ff0000","#00ff00","#ff0000","#00ff00","#1a721a","#1a721a","#1a721a"][parseInt(Math.random()*15)]}},emphasis:{focus:"none"},data:D.value}]})}return N({getData:z}),(b,Q)=>(n(),u("div",{ref_key:"wordCloud",ref:g,style:{height:"270px",width:"300px"}},null,512))}},ot=me(tt,[["__scopeId","data-v-d2b1d121"]]),at={class:"home"},lt={class:"card third-card"},st=["onTouchstart","onTouchend"],nt={class:"barrage-text"},rt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},it=["src"],dt={style:{"vertical-align":"middle"}},ct={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},ut={class:"card fourth-card"},pt={style:{display:"flex"}},mt={class:"added-tags"},vt={class:"preset-tags-container"},ft={class:"preset-tags"},ht=["src"],_t={style:{"vertical-align":"middle"}},gt={style:{cursor:"pointer"}},bt={class:"barrage-text"},yt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},xt=["src"],Ct={style:{"vertical-align":"middle"}},wt={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},kt={class:"card fifth-card"},Tt={class:"preset-tags-container"},Et={class:"preset-tags"},St=["src"],Dt={style:{"vertical-align":"middle"}},Vt={class:"added-tags"},Mt={class:"match-association-container"},It={class:"match-section-home"},Ut={key:0,class:"match-details-box-home"},zt={class:"match-info-row-home"},Bt=["src","alt"],Rt={class:"match-name-home"},Pt={class:"match-time-home"},Ft={key:1,class:"no-match-info-home"},$t={class:"wordCloudDiv"},Nt={style:{"background-color":"white","border-radius":"25px",padding:"5px"}},At="custom-popover",Lt={__name:"Home",setup(ve){const N=r(!0),g=r(!1),D=r(!1),z=r("数据为空"),k=je({getRandOne:[],filteredItems:[],tableData:[],table:"",barrage:""}),b=r([]),Q=()=>{w.get("/machine/dictList").then(t=>{t.code===200&&(b.value=t.data,y.value=t.data.map(e=>({iconUrl:e.iconUrl,label:e.dictLabel,value:e.dictValue})))}).catch(t=>{console.error("获取字典数据失败",t)})},W=t=>{if(!t||t.trim()==="")return[];const e=Array.from(new Set(t.split(",").map(d=>d.trim())));if(!b.value)return e.map(()=>({label:"",iconUrl:""}));const c=new Map(b.value.map(d=>[String(d.dictValue).trim(),d]));return e.map(d=>{const f=c.get(d);return f?{label:f.dictLabel,iconUrl:f.iconUrl}:{label:"",iconUrl:""}})};Q();const B=r(""),q=r(!1),A=r([]),V=r(""),y=r([]),R=r([]),T=r([]),E=r([]),P=r([]),m=r(null),L=r(!1);function fe(){w.get("/machine/InProgressMatch").then(t=>{t.code===200&&t.data?m.value=t.data:m.value=null,console.log("Fetched match data:",m.value)}).catch(t=>{console.error("Failed to fetch in progress match:",t),m.value=null})}Z(()=>{fe()});const ee=t=>{R.value=R.value.filter(e=>e.value!==t.value),E.value=E.value.filter(e=>e!==t.value),y.value.push(t)},te=t=>{if(E.value.length>=5){_.info("最多5个标签");return}R.value.some(e=>e.value===t.value)||(R.value.push(t),E.value.push(t.value),y.value=y.value.filter(e=>e.value!==t.value))},he=()=>{if(E.value.length===0||V.value===""||V.value===null)_.error("请选择标签或输入弹幕");else{if(E.value.length>5){_.error("最少一个标签，最多五个标签。");return}const t={tags:E.value.join(","),barrage:V.value};L.value&&m.value&&(t.matchId=m.value.id),w.post(j.SUBMIT_MEME,t).then(e=>{V.value="",L.value=!1,e.code===200?_.success("投稿成功，待审核(一天内)"):e.code===500?_.error("烂梗已经有了，勿重复提交"):_.error("请求失败")}).catch(e=>{console.error("投稿失败",e),_.error("请求失败")})}},H=t=>{T.value=T.value.filter(e=>e.value!==t.value),P.value=P.value.filter(e=>e!==t.value),y.value.push(t)},oe=t=>{if(P.value.length>=5){_.info("最多5个标签");return}T.value.some(e=>e.value===t.value)||(T.value.push(t),P.value.push(t.value),y.value=y.value.filter(e=>e.value!==t.value))};function _e(){for(A.value=[];T.value.length>0;)H(T.value[0])}const ge=t=>t.getTime()<new Date("2024-09-24").getTime(),Y=()=>{g.value=!0,(B==null||B.value=="")&&(z.value="请输入搜索词..."),w.post(j.SEARCH_MEME,{tags:P.value.join(","),barrage:B.value,submitTime:A.value}).then(t=>{D.value=!0,g.value=!1,k.filteredItems=t.data||[]}).catch(t=>{console.error("搜索失败",t),g.value=!1})};var be=r("搜索烂梗...");const ae=()=>{w.get(j.GET_RAND_ONE_MEME).then(t=>{k.tableData=[t.data],N.value=!1}).catch(t=>{console.error("随机失败")})};ae();const ye=()=>{ue({message:"复制成功",type:"success"})},xe=()=>{ue({message:"复制失败，请检查浏览器是否禁用navigator.clipboard对象或手动复制,请勿使用夸克浏览器",type:"error"})};let K=0,F=null,O=0;const le=t=>{const e=new Date().getTime(),c={x:event.clientX,y:event.clientY};if(F&&F.x===c.x&&F.y===c.y?(O++,console.log(O),O>4&&Oe.alert("😡😡😡你在刷次数😡😡😡","请勿使用连点器",{confirmButtonText:"好吧，我错了"})):O=0,e-K<1500){_({title:"请勿刷次数",message:"复制成功，但次数没有增加",type:"warning"});const f=t.barrage;let S=document.createElement("input");S.value=f,document.body.appendChild(S),S.select();try{document.execCommand("Copy")}catch(C){_({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",C)}document.body.removeChild(S),K=e,F=c;return}F=c,K=e;const x=t.barrage;let d=document.createElement("input");d.value=x,document.body.appendChild(d),d.select();try{document.execCommand("Copy"),ye(),console.log("内容已复制到剪贴板"),w.get(`/machine/addCnt/${t.id}`).then(()=>{})}catch(f){_({title:"复制失败",message:"复制操作失败，请稍后重试",type:"error"}),console.error("复制失败:",f),xe()}document.body.removeChild(d)},Ce=()=>{k.filteredItems=[],D.value=!1},we=t=>{t.touchStartTime=Date.now()},ke=t=>{Date.now()-t.touchStartTime>100&&(t.popoverVisible=!0,setTimeout(()=>{t.popoverVisible=!1},1500))},Te=Xe(et,Ze,2e3);async function Ee(t){const e=t.barrage,c=Te(e);!c||c==="limitedSuccess"||(w.get(j.INCREASE_COPY_COUNT+"/"+t.id),Je(),Y())}const G=r(null);function Se(){G.value&&G.value.getData()}const se=t=>t?t.replace("T"," ").split(".")[0]:"";return Z(()=>{}),(t,e)=>{const c=Ie,x=Re,d=Be,f=ze,S=Le,C=Pe,ne=Fe,re=$e,De=Ne,ie=X("Warning"),de=X("QuestionFilled"),Ve=Ae,Me=X("Refresh"),ce=Ue;return n(),u("div",at,[e[23]||(e[23]=Qe('<div class="boomouder" data-v-46e59764><img src="https://gcore.jsdelivr.net/gh/9WiSHao/AnythingStorage/img/6657boom.webp" alt="6657boom" class="boom6657" data-v-46e59764></div><div class="card first-card" data-v-46e59764><div data-v-46e59764><b data-v-46e59764><p class="announcement" data-v-46e59764> 因为GreasyFork被墙，你可以<a href="https://cdn.hguofichp.cn/sb6657.cn%E6%96%97%E9%B1%BC%E7%8E%A9%E6%9C%BA%E5%99%A8%E7%83%82%E6%A2%97%E6%94%B6%E9%9B%86.user.js" target="_blank" data-v-46e59764>点击我下载最新的油猴插件</a>，你只需要将下载的文件拖入油猴管理面板即可 </p></b></div></div><div class="card second-card" data-v-46e59764><p data-v-46e59764> 这是一个收集6657烂梗的网站: <span class="dgq63136" data-v-46e59764><a href="https://sb6657.cn" data-v-46e59764>sb6657.cn</a></span> 尽情欣赏你们的烂梗吧。 <b data-v-46e59764>开放注册功能，可能会出现收不到邮件的情况。</b><b data-v-46e59764>目前已支持玩机器直播间开播提醒</b></p></div>',3)),o("div",lt,[o("div",null,[l(c,{type:"primary",onClick:ae},{default:s(()=>e[6]||(e[6]=[p("点我随机一条弹幕")])),_:1,__:[6]}),J((n(),M(S,{data:k.tableData,class:"barrage-table",onRowClick:le},{default:s(()=>[l(f,{prop:"barrage"},{default:s(a=>[l(d,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:s(()=>[o("div",{style:{cursor:"pointer"},onTouchstart:i=>we(a.row),onTouchend:i=>ke(a.row)},[o("span",nt,v(a.row.barrage),1)],40,st)]),default:s(()=>[o("div",rt,[(n(!0),u(I,null,U(W(a.row.tags),(i,h)=>(n(),u("div",{key:h,style:{"margin-right":"8px"}},[l(x,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:s(()=>[i.iconUrl?(n(),u("img",{key:0,src:i.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,it)):$("",!0),o("span",dt,v(i.label),1)]),_:2},1024)]))),128)),o("span",ct,"投稿时间: "+v(se(a.row.submitTime)),1)])]),_:2},1032,["visible"])]),_:1}),l(f,{label:"",align:"center",width:"85"},{default:s(()=>[l(c,{type:"primary"},{default:s(()=>e[7]||(e[7]=[p("复制")])),_:1,__:[7]})]),_:1})]),_:1},8,["data"])),[[ce,N.value]])])]),o("div",ut,[o("div",null,[o("div",pt,[l(ne,{modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=a=>B.value=a),placeholder:pe(be),onKeydown:We(Y,["enter"]),clearable:"",class:"search-input",onInput:Ce},{append:s(()=>[l(c,{loading:g.value,type:"primary",onClick:Y},{default:s(()=>[l(C,null,{default:s(()=>[l(pe(Ke))]),_:1})]),_:1},8,["loading"])]),_:1},8,["modelValue","placeholder"]),l(re,{modelValue:q.value,"onUpdate:modelValue":e[1]||(e[1]=a=>q.value=a),label:"高级检索 >",onChange:_e,style:{"margin-left":"10px"}},null,8,["modelValue"])]),J(o("div",null,[o("div",null,[e[8]||(e[8]=o("span",{style:{display:"block",color:"var(--el-text-color-secondary)","font-size":"14px"}},"烂梗收集时间范围(可选)",-1)),l(De,{modelValue:A.value,"onUpdate:modelValue":e[2]||(e[2]=a=>A.value=a),type:"daterange","range-separator":"到","value-format":"YYYY-MM-DD","start-placeholder":"起始","end-placeholder":"结束","disabled-date":ge},null,8,["modelValue"]),e[9]||(e[9]=o("span",{style:{display:"block",color:"var(--el-text-color-secondary)","font-size":"14px"}},"烂梗包含标签(可选)",-1)),o("div",mt,[(n(!0),u(I,null,U(T.value,(a,i)=>(n(),M(x,{round:"",key:i,closable:"",onClick:h=>H(a),onClose:h=>H(a),style:{padding:"15px",cursor:"pointer","font-size":"16px"},effect:"dark"},{default:s(()=>[p(v(a.label),1)]),_:2},1032,["onClick","onClose"]))),128))])]),o("div",vt,[o("div",ft,[(n(!0),u(I,null,U(y.value,(a,i)=>(n(),M(x,{round:"",key:i,closable:"",onClose:h=>oe(a),onClick:h=>oe(a),style:{padding:"15px",cursor:"pointer","font-size":"16px"},type:"primary"},{default:s(()=>[a.iconUrl?(n(),u("img",{key:0,src:a.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,ht)):$("",!0),o("span",_t,v(a.label),1)]),_:2},1032,["onClose","onClick"]))),128))])])],512),[[qe,q.value]]),D.value?J((n(),M(S,{key:0,data:k.filteredItems,stripe:"",onRowClick:le,"empty-text":z.value,"cell-style":{cursor:"Pointer",fontSize:"large"}},{default:s(()=>[l(f,{prop:"barrage"},{default:s(a=>[l(d,{placement:"top",width:"auto",trigger:"hover","popper-class":At},{reference:s(()=>[o("div",gt,[o("span",bt,v(a.row.barrage),1)])]),default:s(()=>[o("div",yt,[(n(!0),u(I,null,U(W(a.row.tags),(i,h)=>(n(),u("div",{key:h,style:{"margin-right":"8px"}},[l(x,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:s(()=>[i.iconUrl?(n(),u("img",{key:0,src:i.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,xt)):$("",!0),o("span",Ct,v(i.label),1)]),_:2},1024)]))),128)),o("span",wt,"投稿时间: "+v(se(a.row.submitTime)),1)])]),_:2},1024)]),_:1}),l(f,{align:"center",width:"100"},{default:s(a=>[l(c,{type:"primary",class:"copy-btn",onClick:He(i=>Ee(a.row),["stop"])},{default:s(()=>[e[10]||(e[10]=p("复制 🌈")),l(Ge,{num:a.row.cnt},null,8,["num"])]),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"])),[[ce,g.value]]):$("",!0)])]),o("div",kt,[o("div",null,[o("span",null,[e[17]||(e[17]=p("可选标签")),l(d,{width:300},{reference:s(()=>[l(C,{size:"16"},{default:s(()=>[l(ie)]),_:1})]),default:s(()=>[e[11]||(e[11]=p(" 为解决烂梗分栏不足和分类不清晰问题。")),e[12]||(e[12]=o("br",null,null,-1)),e[13]||(e[13]=o("b",null,"点击标签即可添加",-1))]),_:1,__:[11,12,13]}),l(c,{link:"",type:"success",style:{"margin-left":"50%"}},{default:s(()=>[e[16]||(e[16]=p("投稿标签 ")),l(d,{width:300},{reference:s(()=>[l(C,{size:"16"},{default:s(()=>[l(de)]),_:1})]),default:s(()=>[e[14]||(e[14]=o("b",null,"请在上方(建议/提交)问卷投稿。",-1)),e[15]||(e[15]=o("br",null,null,-1))]),_:1,__:[14,15]})]),_:1,__:[16]})]),o("div",Tt,[o("div",Et,[(n(!0),u(I,null,U(y.value,(a,i)=>(n(),M(x,{round:"",key:i,closable:"",onClose:h=>te(a),onClick:h=>te(a),style:{padding:"15px",cursor:"pointer","font-size":"16px"},type:"primary"},{default:s(()=>[a.iconUrl?(n(),u("img",{key:0,src:a.iconUrl,style:{width:"22px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,St)):$("",!0),o("span",Dt,v(a.label),1)]),_:2},1032,["onClose","onClick"]))),128))])]),o("span",null,[e[19]||(e[19]=p("已选标签 ")),l(d,{width:250},{reference:s(()=>[l(C,{size:"16"},{default:s(()=>[l(ie)]),_:1})]),default:s(()=>[e[18]||(e[18]=o("b",null,"最少一个标签，最多五个标签。",-1))]),_:1,__:[18]})]),o("div",Vt,[(n(!0),u(I,null,U(R.value,(a,i)=>(n(),M(x,{round:"",key:i,closable:"",onClick:h=>ee(a),onClose:h=>ee(a),style:{padding:"15px",cursor:"pointer","font-size":"16px"},effect:"dark"},{default:s(()=>[p(v(a.label),1)]),_:2},1032,["onClick","onClose"]))),128))]),l(ne,{modelValue:V.value,"onUpdate:modelValue":e[3]||(e[3]=a=>V.value=a),maxlength:"255",autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea",placeholder:" 烂梗...."},null,8,["modelValue"]),o("div",Mt,[o("div",It,[l(re,{modelValue:L.value,"onUpdate:modelValue":e[4]||(e[4]=a=>L.value=a),disabled:!m.value,class:"match-checkbox-home"},{default:s(()=>[e[20]||(e[20]=p(" 关联赛事库 ")),l(C,{color:"#3db302ff",size:"16"},{default:s(()=>[l(de)]),_:1})]),_:1,__:[20]},8,["modelValue","disabled"]),m.value?(n(),u("div",Ut,[o("div",zt,[o("img",{src:m.value.matchesImg,class:"match-image-home",alt:m.value.matchesName},null,8,Bt),o("span",Rt,v(m.value.matchesName),1)]),o("div",Pt,v(m.value.startTime)+" 至 "+v(m.value.endTime),1)])):(n(),u("div",Ft," 当前无正在进行的大型赛事 ")),l(c,{class:"saveBnt",type:"primary",onClick:he},{default:s(()=>e[21]||(e[21]=[p("投稿")])),_:1,__:[21]})])])]),l(Ve,{right:50,bottom:50})]),l(Ye,{class:"ChatRoom card"}),e[24]||(e[24]=o("div",{class:"card sixth-card"},[p(" 友情链接 "),o("a",{href:"https://dgq63136.cn",target:"_blank"},"dgq63136.cn"),p("    "),o("a",{href:"https://sb6657.cn/#/Starrysky",target:"_blank"},"星空背景")],-1)),o("div",$t,[o("span",Nt,[e[22]||(e[22]=p("搜索词云")),l(C,{size:"20",style:{cursor:"pointer",animation:"rotating 4s linear infinite reverse"},onClick:e[5]||(e[5]=a=>Se())},{default:s(()=>[l(Me)]),_:1})]),l(ot,{ref_key:"wordCloudRef",ref:G},null,512)])])}}},io=me(Lt,[["__scopeId","data-v-46e59764"]]);export{io as default};
