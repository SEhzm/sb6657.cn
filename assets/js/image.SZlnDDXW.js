import{t as B,c as N,l as $,j as L,k as S,e as U,y as A,b as u}from"./element-plus.pEMcb2g5.js";import{_ as M,h as f}from"./index.CvZEztfR.js";import{X as T,c as a,o as r,a as l,Q as n,P as _,a6 as x,K as j,I as m,M as c,O as p}from"./@vue.Ca5AQEsS.js";import"./lodash-es.S0Y0Up6J.js";import"./@vueuse.BFkoDYlQ.js";import"./@element-plus.w7YOadmw.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.DcnvBwdO.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.58V2siOx.js";import"./pinia.Dz8zdBJG.js";import"./axios.xsH4HHeE.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.DhOS9MZH.js";const q={class:"image-list"},H={style:{"text-align":"center",padding:"0 0 5px 0"}},K={key:0,class:"comment-list"},P={class:"comment-content"},Q={class:"comment-content"},X={class:"comment-date"},G={class:"dialog-footer"},J={__name:"image",setup(R){(()=>{u({type:"success",dangerouslyUseHTMLString:!0,title:"照片可以评论喔",offset:100,duration:1500})})();const o=T({outerImg:[],id:"",imageId:"",Commentname:"",douyuId:"",dialogFormVisible:!1}),g=()=>{f.get("/machine/showImage",{}).then(t=>{o.outerImg=t.data||[]}).catch(t=>{console.error("加载数据失败:",t)})};g();const y=t=>{t.showComments=!t.showComments},C=t=>new Date(t).toLocaleString(),b={Commentname:[{required:!0,message:"请输入评论",trigger:"blur"}]},I=t=>{console.log(t),o.imageId=t.id,u({title:"温馨提醒",message:"请注意你的行为，不要上传违反法律的内容，后台能监控到你",type:"warning"}),o.douyuID="",o.Commentname="",o.dialogFormVisible=!0},k=t=>{t.Commentname===""?u.error("请输入评论"):f.post("/machine/addCommentname",{id:"",imageId:o.imageId,douyuID:t.douyuID,createdAt:"",commentname:t.Commentname}).then(e=>{g(),u.success("评论成功"),o.dialogFormVisible=!1}).catch(e=>{console.error("加载数据失败:",e)})};return(t,e)=>{const v=B,i=N,h=S,w=L,V=$,z=U,E=A;return r(),a(_,null,[e[7]||(e[7]=l("div",{class:"outer"},[l("span",null,"主播相册"),l("span",{style:{"font-size":"16px"}},"(点击放大图片)"),l("em",{style:{"font-size":"14px"}},"如侵权，请右上角联系删除")],-1)),l("div",q,[(r(!0),a(_,null,x(o.outerImg,(s,F)=>(r(),a("div",{key:F,class:"image-block"},[n(v,{"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"hide-on-click-modal":!0,src:s.url,"preview-src-list":[s.url],fit:"cover",lazy:"",style:{width:"250px",height:"300px"}},null,8,["src","preview-src-list"]),l("div",H,[n(i,{style:{width:"230px","font-size":"16px","white-space":"normal","word-break":"break-word"}},{default:m(()=>[c(p(s.date),1)]),_:2},1024)]),n(i,{onClick:d=>y(s),style:{"font-size":"18px","margin-left":"15px","box-sizing":"border-box"}},{default:m(()=>[c(p(s.showComments?"隐藏评论":"显示评论("+s.comments.length+")"),1)]),_:2},1032,["onClick"]),s.showComments?(r(),a("div",K,[(r(!0),a(_,null,x(s.comments,(d,D)=>(r(),a("div",{key:D,class:"comment-item"},[l("span",P,p(d.douyuID)+" :",1),l("span",Q,p(d.commentname),1),l("span",X,p(C(d.createdAt)),1)]))),128))])):j("",!0),n(i,{type:"success",plain:"",onClick:d=>I(s),style:{"font-size":"18px","box-sizing":"border-box"}},{default:m(()=>e[4]||(e[4]=[c(" 我要评论 ")])),_:2,__:[4]},1032,["onClick"])]))),128))]),n(z,{modelValue:o.dialogFormVisible,"onUpdate:modelValue":e[3]||(e[3]=s=>o.dialogFormVisible=s),draggable:"",title:"评论"},{footer:m(()=>[l("div",G,[n(i,{onClick:e[1]||(e[1]=s=>o.dialogFormVisible=!1)},{default:m(()=>e[5]||(e[5]=[c("关闭")])),_:1,__:[5]}),n(i,{type:"primary",onClick:e[2]||(e[2]=s=>k(o))},{default:m(()=>e[6]||(e[6]=[c(" 评论并关闭 ")])),_:1,__:[6]})])]),default:m(()=>[n(V,{model:o,"label-width":"100px",rules:b,"label-position":"right"},{default:m(()=>[n(w,{label:"评论内容",prop:"Commentname"},{default:m(()=>[n(h,{modelValue:o.Commentname,"onUpdate:modelValue":e[0]||(e[0]=s=>o.Commentname=s),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),n(E,{right:20,bottom:50})],64)}}},_e=M(J,[["__scopeId","data-v-9024b04a"]]);export{_e as default};
