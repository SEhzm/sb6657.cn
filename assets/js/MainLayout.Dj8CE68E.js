var We=Object.defineProperty;var Ge=(m,r,l)=>r in m?We(m,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[r]=l;var ne=(m,r,l)=>Ge(m,typeof r!="symbol"?r+"":r,l);import{d as ue,bk as _e,bK as Se,h as d,al as A,ar as Xe,c as D,o as f,R as e,J as t,K as ie,I as H,O as U,P as Y,a as o,Q as ae,a6 as me,u as V,L as G,W as ge,C as Ze,i as le,j as re,M as je,T as Ue,S as pe,bW as Ce,a4 as ee,l as $e,f as Ie,aU as et,E as tt}from"./@vue.BltuATdo.js";import{u as be,g as Re,e as ot,s as lt,a as at,b as st}from"./time.D382-uGH.js";import{l as nt,R as Ke,j as Qe,M as xe}from"./@element-plus.D0bpsst8.js";import{f as Ye,t as ze,u as fe,d as rt}from"./flip-num.0k1bvIOX.js";import{c as Pe,a as Oe,p as Ee,l as Fe,b as He}from"./setMeme.ClZY40tE.js";import{_ as j,h as te,i as Ae,s as it,u as ut,r as dt,M as ke,a as ct}from"./index.B7rbyhYE.js";import{s as At,d as mt}from"./pinia.DfSVr1RC.js";import{t as pt}from"./tag-selector.DHWfuI1f.js";import{a as Z}from"./js-cookie.Cz0CWeBA.js";import{J as qe}from"./jsencrypt.BceYZi2u.js";import{a as J,E as se}from"./element-plus.BELI2msV.js";import{C as gt}from"./CommunityNorms.CUOXHbp7.js";import{u as Le,b as ft,R as vt}from"./vue-router.BFvkXMb7.js";import"./axios.ngrFHoWO.js";import"./lodash-es.CDeyng3v.js";import"./@vueuse.BO4JNAXw.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";const ht="/favicon.ico",wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA1xJREFUWEfFl0uMDFEUhv9zp+eWR8LCQiKqeojWVSQSkQhigYVHwkZibCSIMAssiYUEsfBYSohMhAmxQMTCI0YiZkMsSJDQ1Qymq82IRyzGI/qWqUNNjHT31DtE77ruf87/3XPvOdVN+M8fyuJfzmurPPZ0y3E7s8TXx2QCKBmtxwi0E8BDAEdMR13KCpIJwDbkAwDz6kzbs0JkBfgOQKvfNTOtsKq1W2krkRqglM8tIhZ3RxkRnkihlk9/jXdpIFID2Lo8CMLeIBNmPm5V3R3/FiAvH4MxJ8SkH2OVZZbxOSlEqgqUdG05EXdHJidsMCvq/D8BsHXtFIi3xCQ/bzpqw18HKOnaCiK+mSDxJ9NRk3zdC0POKjjqWVRMoiPwEw0B1wG0JQAAe97SnBDvPeAiiHYXK7UbYXGxAKWpuSUkxJ0kxiMaH4CE8E3HgvkDt7TMt/q+9wXliATIYh7cnrhiVdXaVAC+OYS4TsC4NLuP0K43HXWxeT2wAqW2MW3EXjcYM/+SOQC6azq1xYkAyoY8w8CmWHPmHhAtidX9FhB4Y9Fxz9brR1WgpLduIqIzMUk/C0aHB96WCoBxpdh0F0YBlHV5mQmBF2YYirmHPdFh9dee23rrnTQAfrjpqAbPhi8DUzBuMCe/Ruy+TD/U4uIAPvqaLF3CQkyrb8kGgFI+t5BY3AsFIN5iVtzT9euxFWtK5s8I682PnpHHDQB2fsw0sPcqBKDbdNTKoDXbkP64tZJcxkiAx5MxXtPkl5CBsb/oqANhJrYhOQnAkOC5s/vcR4EV8B+WDdnFwMbmZAK0ZqZTuxZlYhvSHzTrwjQM9FqOKkS2oZ3PLQOL281JmksXZPLc0FZ74KthAES8tVhxT0UC+Iu2IS8AaK8XJgF4Oguy5YushRxhV9FRm5vXQl9GtqGdBLjjz1kxby9W3RNRRzA8wj3vdYBm0HTUxBCw8JTPDHlUALuGFcw9ZtVdGgXwIp9bODS6jUO7x88V/3sg37qDmHYD0Jl5s1V1u8IgyoY8xMCe3+sDBHRGdU4igBGzsiH3/arDPsFUKFRrL0Pmgf9XbSIB5zTKdbZVvr2Na83YCjQn8EGEVIcLvWi4bP5zZjx6UlXX2oGhOOPQOZA0sF53fwYmLOjFYJbYn3WiRDAd4qVAAAAAAElFTkSuQmCC",_t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAcpJREFUWEftlk1uwkAMhe3CJSoFCZbAIQq75BQNJyk9CXCKsCscgmbZSETqJUpdOcykMyaTECX8LMiKiMT+7HnPDsKNL7xxfngA3EcH0t16AQjhFfWQENGq+wRLTD/XHwAwuWLyPBURvTMAGcmTDtL0eRgklwD6jqP+gXBhFJxIAM57EQiV/EsWlgN0kAYHQj6OPkMQ0qw3DDZtdGIfRxM8xs4K5Nj6PgfwRj4qyn8IolVvHMybQBQl58L00VsAnKhNiDSOQjieOV8bb+RPdTFOAA3x8wshIr7xPau1bif2u2iu35fJOWYpQFMIa64QLL2xP5PHWAmgX7AqcQQzg5tzpaxzZwNwcNHOxBv5A1nRiceRZt4wWLoEXA/AttHJrCgaMFU2PhtA2kjNiaOfiVb8wxBbpnY16bL/XeI9C0Akz2zkmmh6wHQBEsNBTohKAMvDQnwMoZK8KJtuZaWmborEWApgia5CTGVTsgzCCWB6mJCmTfeB2UmzE4UAlodbSK67Y+lGHecJgKXeFjehgMgXnXYTLyPe0byC81XZtO0uXYhFlz2GYso12by1380+yQxLvRqdqB2s5gv5fLiPz/Ka9K0+/ujAzTvwBwY/rnW+YWzQAAAAAElFTkSuQmCC",Et="data:image/png;base64,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",bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB/lBMVEUAAAACAAAEAAAGAAADAAAFAAAKAAAHAAAQAAABAAACAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAAAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAABAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAADAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAD///+W3QZCAAAAqHRSTlMAAAAAAAAAAAAAAQoWHBsBEjt6vtTd1bx8QBUPWMTy9MhcAS6w+Pm1MwJI2d5RAknk5wEy2+jO6f7r0OU1ELP8cJnh0crL0+PmnWsRVfc8BigiFCMqB2LC9kVKEj77aFJGzx6/lwG7eVvtMS/sIRvcJtJEEwu5BAOLCnaW8wXaw6DH/Yg0OZBee7fwHvH6c2XJkjbGFhlPUzjgOp8tK+rWuDUOxR0pzW3NoAbKAAAAAWJLR0SpJw8GBAAAAAd0SU1FB+gCEwk0EkntIW4AAAIlSURBVDjLY2AgATBycfPw8vFw8zNhk2XiFxAUEhYRFRUTl5CUwlDDxCQtIyu3AgrkFRQFmFlQ5JWUVVRXIAE1dQ0uJBVMmlraK9CAjq4e3BomVn2DFRjAUNcIagYLk7HJihWmZuYWMDkLSyvrFStEbZgYIQbY2q1YYe8greFo7eTs4urm7uFpY+sFVC3uzQIxwMcX6HA/Jhb/gMAgW1up4JBQJiYtoJt9w1hBKpgEwoGmRkSi+JwpSg0oqBANVhAD8n9sHKqCeJACuQSgIAuzEMhdiUmoCqSSQaIpqSwMTNxpIHens6KEHAtTRixQOJmbCajWDcjKzEILfKbsHKCwiBRQAa8OkGUQjK4g1x0oLMrHxMCSlw9keRSgKwgwBArn84GsKATFXwK6gqIIoLBVMVBBSSnIvZ5lqI4srwCJJleyMLCwVoGYHjHI3mBhS7AEiVYrAQ1mkqwBsZ0lyxDRW6tfB044+kzgoK5fkdPQ2GTe3CJVzgIynae1LRMcq67FTOAwaVeT7yjoXGHRJQ4KTpbu0h5IxPf2sYOtZRLoXOHbHzJBzX5iOchKTQlowhAWYIIG6yTRFZOnTJ02fQpEw4wesPzMWdAEw8DCMc3QfvacYmlNiIK55iD5eTIMcH8x6U0TtZg3f8FUJoQCJx89pLBjZFjYqbrCKQmuQE18lhJq/LMs6l/svASiYGn+suW2LOh5i4XTdm4oWJClsiWIi4WBagAAZejSV585JrMAAAAASUVORK5CYII=",yt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1745163196952'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='2577'%20data-spm-anchor-id='a313x.search_index.0.i2.58913a81ag2QCw'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M898.96%20765.38h-77.17V418.11c0-154.94-114.87-283.22-263.85-305.05%200.11-1.26%200.73-2.35%200.73-3.63%200-25.16-20.4-45.56-45.56-45.56-25.16%200-45.56%2020.4-45.56%2045.56%200%201.29%200.63%202.37%200.73%203.63-148.98%2021.83-263.85%20150.11-263.85%20305.05v347.26h-77.17c-21.31%200-38.58%2017.28-38.58%2038.59s17.28%2038.59%2038.58%2038.59h252.75c9.46%2065.27%2065.25%20115.75%20133.1%20115.75s123.64-50.48%20133.1-115.75h252.75c21.31%200%2038.58-17.28%2038.58-38.59s-17.27-38.58-38.58-38.58zM513.11%20881.13c-25.15%200-46.61-16.13-54.58-38.58h109.16c-7.97%2022.45-29.43%2038.58-54.58%2038.58z%20m231.51-115.75H281.6V418.11c0-127.66%20103.85-231.51%20231.51-231.51s231.51%20103.85%20231.51%20231.51v347.27z'%20fill='%23e3d5b8'%20p-id='2578'%3e%3c/path%3e%3c/svg%3e",Ct=["onTouchstart","onTouchend"],xt={class:"barrage-text"},kt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Vt=["src"],Dt={style:{"vertical-align":"middle"}},Mt=ue({__name:"meme-dialog",props:_e({memeArr:{},loading:{type:Boolean},emptyText:{}},{modelValue:{},modelModifiers:{}}),emits:_e(["refresh"],["update:modelValue"]),setup(m,{emit:r}){const l=be(),i=Se(m,"modelValue"),n=r,y=ze(He,Fe,2e3);async function w(v){const b=v.content,M=y(b);if(!(!M||M==="limitedSuccess")){if(Pe(),await Oe(v.category,v.id)){n("refresh");return}Ee()}}const g=d([]);l.tagsLoaded.then(()=>{g.value=l.memeTags});const h=v=>{v.touchStartTime=Date.now()},k=v=>{Date.now()-v.touchStartTime>100&&(v.popoverVisible=!0,setTimeout(()=>{v.popoverVisible=!1},1500))};return(v,b)=>{const M=A("el-tag"),C=A("el-table-column"),x=A("el-popover"),O=A("el-button"),K=A("el-table"),I=A("el-dialog"),_=Xe("loading");return f(),D("div",null,[e(I,{draggable:"",modelValue:i.value,"onUpdate:modelValue":b[0]||(b[0]=a=>i.value=a),class:"dialog-main"},{header:t(()=>[Ze(v.$slots,"default",{},void 0,!0)]),default:t(()=>[ie((f(),H(K,{data:v.memeArr,stripe:"","empty-text":v.emptyText,"cell-class-name":"hover-pointer",onRowClick:w},{default:t(()=>[e(C,{align:"center",width:"60"},{default:t(a=>[e(M,{round:"",effect:"plain"},{default:t(()=>[U(Y(a.$index+1),1)]),_:2},1024)]),_:1}),e(C,{prop:"content"},{default:t(a=>[e(x,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:t(()=>[o("div",{style:{cursor:"pointer"},onTouchstart:u=>h(a.row),onTouchend:u=>k(a.row)},[o("span",xt,Y(a.row.content),1)],40,Ct)]),default:t(()=>[o("div",kt,[(f(!0),D(ae,null,me(V(Re)(a.row.tags,g.value),(u,p)=>(f(),D("div",{key:p,style:{"margin-right":"8px"}},[e(M,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:t(()=>[u.iconUrl?(f(),D("img",{key:0,src:u.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,Vt)):G("",!0),o("span",Dt,Y(u.label),1)]),_:2},1024)]))),128))])]),_:2},1032,["visible"])]),_:1}),e(C,{align:"center",width:"100"},{default:t(a=>[e(O,{type:"primary",class:"copy-btn",onClick:ge(u=>w(a.row),["stop"])},{default:t(()=>[b[1]||(b[1]=U(" 复制 ( ",-1)),e(Ye,{num:a.row.copyCount},null,8,["num"]),b[2]||(b[2]=U(" ) ",-1))]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"])),[[_,v.loading]])]),_:3},8,["modelValue"])])}}}),Ve=j(Mt,[["__scopeId","data-v-7e763dd3"]]);var $=(m=>(m[m.ID=0]="ID",m[m.COPY=1]="COPY",m))($||{});const Tt={class:"advanced-search"},Bt={class:"title"},St={class:"title-left"},Ut={class:"collapse-text"},It={class:"collapsible-content"},Rt={class:"time-container"},Kt={class:"empty-state"},Qt=["innerHTML"],Yt={class:"popover-details"},zt={class:"tag-list"},Pt={class:"tag-icon-wrapper"},Ot=["src"],Ft={class:"tag-label"},Ht={class:"submit-time"},qt={key:0,class:"pagination-container"},De="正在搜索中...坐和放宽...",Me=20,Lt=ue({__name:"search-dialog",props:_e({searchKey:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(m){const r=Se(m,"modelValue"),l=m,i=fe(),n=be(),{memeTags:y}=At(n),w=d([]),g=d(!1),h=d(De),k=d($.ID),v=d(1),b=d(0);function M(){w.value=[],v.value=1,b.value=0,h.value=De}async function C(E,s=$.ID,c=1,Q,F){if(!E.trim())return;const{_failure:W,flatData:q}=await lt({barrage:E,sort:s,pageNum:c,tags:Q==null?void 0:Q.join(","),submitTime:F,pageSize:Me});if(W||!q||q.list.length<=0){w.value=[],b.value=0,v.value=1,h.value="没有找到搜索结果。想要补充更多烂梗？请去首页投稿！";return}b.value=q.total,v.value=c,w.value=q.list.map(L=>({id:L.id.toString(),content:L.barrage,tags:L.tags,submitTime:L.submitTime,copyCount:+L.cnt}))}const x=rt(async(E,s=$.ID,c=1,Q,F)=>{if(E.trim()){g.value=!0;try{await C(E,s,c,Q,F)}finally{g.value=!1}}},300);function O(E){k.value=E}const K=d(!0),I=d([]);n.tagsLoaded.then(E=>{I.value=y.value});const _=d([]),a=d();function u(){K.value=!K.value}function p(){_.value=[],I.value=[...y.value],a.value=void 0}function B(){if(_.value.length===0&&!a.value)return;p();const E=[];x(l.searchKey,k.value,1,E,void 0)}function R(E){return E.getTime()<new Date("2024-09-24").getTime()}const z=ze(He,Fe,2e3);async function X(E){const s=z(E.content);if(!(!s||s==="limitedSuccess")){Pe();try{if(await Oe("",E.id)){const Q=w.value.findIndex(F=>F.id===E.id);Q!==-1&&(w.value[Q].copyCount+=1)}else Ee()}catch(c){console.error("更新复制计数失败:",c),Ee()}}}function N(E){return E.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const T=le(()=>{if(!l.searchKey||!w.value.length)return w.value;const E=new RegExp(N(l.searchKey),"gi");return w.value.map(s=>({...s,highlightedContent:s.content.replace(E,c=>`<span style="background-color: yellow">${c}</span>`)}))});return re(r,E=>{E||(M(),p())}),re(()=>l.searchKey,E=>{E.trim()&&(M(),x(E))},{immediate:!0}),re(v,(E,s)=>{if(E!==s&&l.searchKey.trim()){const c=_.value.map(Q=>Q.dictValue);x(l.searchKey,k.value,E,c,a.value)}}),re([_,a,k],([E,s,c],[Q,F,W])=>{if(Q===void 0&&F===void 0&&W===void 0)return;M();const q=E.map(L=>L.dictValue);x(l.searchKey,c,1,q,s)},{deep:!0}),(E,s)=>{const c=A("el-icon"),Q=A("el-button"),F=A("el-date-picker"),W=A("el-table-column"),q=A("el-tag"),L=A("el-popover"),de=A("el-table"),ve=A("el-pagination"),he=A("el-dialog");return f(),D("div",null,[e(he,{draggable:"",modelValue:r.value,"onUpdate:modelValue":s[7]||(s[7]=S=>r.value=S),class:"dialog-main"},{header:t(()=>[...s[8]||(s[8]=[o("span",{class:"search-tips"},"烂梗搜索结果:",-1)])]),default:t(()=>[o("div",Tt,[o("div",Bt,[o("div",St,[s[9]||(s[9]=o("span",{class:"title-text"},"高级筛选",-1)),e(Q,{text:"",onClick:u,class:"collapse-btn"},{default:t(()=>[o("span",Ut,Y(K.value?"展开":"收起"),1),e(c,null,{default:t(()=>[(f(),H(je(K.value?"ArrowDown":"ArrowUp")))]),_:1})]),_:1}),k.value===V($).ID?(f(),H(Q,{key:0,text:"",type:"info",onClick:s[0]||(s[0]=S=>O(V($).COPY)),size:V(i)?"small":"default"},{default:t(()=>[U(Y(V(i)?"复制数排序":"点击按复制次数排序"),1)]),_:1},8,["size"])):k.value===V($).COPY?(f(),H(Q,{key:1,text:"",type:"info",onClick:s[1]||(s[1]=S=>O(V($).ID)),size:V(i)?"small":"default"},{default:t(()=>[U(Y(V(i)?"时间排序":"点击按id(时间)排序"),1)]),_:1},8,["size"])):G("",!0)]),e(Q,{text:"",type:"danger",onClick:B},{default:t(()=>[U(Y(V(i)?"清空筛选":"清空已选高级搜索"),1)]),_:1})]),e(Ue,{name:"collapse"},{default:t(()=>[ie(o("div",It,[o("div",Rt,[e(F,{class:"time-picker",modelValue:a.value,"onUpdate:modelValue":s[2]||(s[2]=S=>a.value=S),type:"daterange","range-separator":"到","value-format":"YYYY-MM-DD","start-placeholder":"起始","end-placeholder":"结束","disabled-date":R},null,8,["modelValue"])]),e(pt,{selectedTags:_.value,"onUpdate:selectedTags":s[3]||(s[3]=S=>_.value=S),tags:I.value},null,8,["selectedTags","tags"])],512),[[pe,!K.value]])]),_:1})]),e(de,{data:T.value,stripe:"","cell-class-name":"hover-pointer","row-key":"id",lazy:!0},{empty:t(()=>[o("div",Kt,[h.value!=="没有找到搜索结果。想要补充更多烂梗？请去首页投稿！"?(f(),H(c,{key:0,class:"loading-icon"},{default:t(()=>[e(V(nt))]),_:1})):G("",!0),o("span",null,Y(h.value),1)])]),default:t(()=>[e(W,{align:"center",width:"70"},{default:t(S=>[Ce([S.$index],()=>(f(),D("div",{class:"row-number"},[U(Y(S.row.id),1)])),s,4)]),_:1}),e(W,{prop:"content"},{default:t(S=>[e(L,{placement:"top",width:"auto",trigger:"hover"},{reference:t(()=>[o("div",{class:"barrage-text",innerHTML:S.row.highlightedContent||S.row.content},null,8,Qt)]),default:t(()=>[o("div",Yt,[o("div",zt,[(f(!0),D(ae,null,me(V(Re)(S.row.tags,I.value),oe=>(f(),D("div",{key:oe.label},[e(q,{round:"",effect:"dark",class:"tag-item"},{default:t(()=>[o("div",Pt,[oe.iconUrl?(f(),D("img",{key:0,src:oe.iconUrl,class:"tag-icon"},null,8,Ot)):G("",!0),o("span",Ft,Y(oe.label),1)])]),_:2},1024)]))),128))]),o("div",Ht,"投稿时间: "+Y(V(ot)(S.row.submitTime)),1)])]),_:2},1024)]),_:1}),e(W,{align:"center",width:"100"},{default:t(S=>[Ce([S.row.id,S.row.copyCount],()=>(f(),D("div",null,[e(Q,{type:"primary",class:"copy-btn",onClick:ge(oe=>X(S.row),["stop"])},{default:t(()=>[s[10]||(s[10]=U(" 复制 ( ",-1)),e(Ye,{num:S.row.copyCount},null,8,["num"]),s[11]||(s[11]=U(" ) ",-1))]),_:2},1032,["onClick"])])),s,5)]),_:1})]),_:1},8,["data"]),b.value>0?(f(),D("div",qt,[e(ve,{"current-page":v.value,"onUpdate:currentPage":s[6]||(s[6]=S=>v.value=S),"page-size":Me,total:b.value,layout:V(i)?"prev, pager, next":"total, prev, pager, next, jumper",size:"small",background:""},null,8,["current-page","total","layout"])])):G("",!0)]),_:1},8,["modelValue"])])}}}),Jt=j(Lt,[["__scopeId","data-v-9cfc7481"]]),Je="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1569580729849'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1939'%20width='200'%20height='200'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c/style%3e%3c/defs%3e%3cpath%20d='M513.3%20958.5c-142.2%200-397.9-222.1-401.6-440.5V268c1.7-39.6%2031.7-72.3%2071.1-77.3%2049-4.6%2097.1-16.5%20142.7-35.3%2047.8-14%2091.9-38.3%20129.4-71.1%2030.3-24.4%2072.9-26.3%20105.3-4.6%2039.9%2030.7%2083.8%2055.9%20130.5%2074.6%2048.6%2014.7%2098.2%2025.9%20148.4%2033.7%2038.5%207.6%2067.1%2040.3%2069.5%2079.5%203.3%2084.9%202.5%20169.9-2.6%20254.7-33.7%20281.6-253.7%20436.4-392.7%20436.3z%20m-0.1-813.7c-7.2-0.2-14.3%202-20%206.4-39.7%2035.2-86.8%2061.1-137.7%2075.7-46.8%2019.2-96.2%2031-146.6%2035.2-11%203.2-18.8%2013-19.5%2024.4v230.1c3.5%20180.3%20223.3%20361%20323.9%20361s287.3-120.2%20317.6-360.5c7.3-142.7%200-228.6%200-229.6-1.3-13.3-11-24.3-24-27.3-49.6-7.7-98.6-19-146.5-33.7-46.3-19.5-89.7-45.3-129-76.7-5.8-3.8-12.7-5.5-19.5-4.9l1.3-0.1z'%20fill='%23C6CCDA'%20p-id='1940'%3e%3c/path%3e%3cpath%20d='M750.1%20428L490.7%20673.2c-11.7%2011.1-29.5%2012.9-43.1%204.2l-6.8-5.8-141.2-149.4c-9.3-9.3-12.7-22.9-9-35.5%203.8-12.6%2014.1-22.1%2027-24.8%2012.9-2.7%2026.1%201.9%2034.6%2011.9L469%20597.5l233.7-221c14.6-12.8%2036.8-11.6%2049.9%202.7%2013.2%2014.2%2011.5%2035.3-2.5%2048.8'%20fill='%23C6CCDA'%20p-id='1941'%3e%3c/path%3e%3c/svg%3e",Nt=`MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKoR8mX0rGKLqzcWmOzbfj64K8ZIgOdH
nzkXSOVOZbFu/TJhZ7rFAN+eaGkl3C4buccQd/EjEsj9ir7ijT7h96MCAwEAAQ==`,Wt=`MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAqhHyZfSsYourNxaY
7Nt+PrgrxkiA50efORdI5U5lsW79MmFnusUA355oaSXcLhu5xxB38SMSyP2KvuKN
PuH3owIDAQABAkAfoiLyL+Z4lf4Myxk6xUDgLaWGximj20CUf+5BKKnlrK+Ed8gA
kM0HqoTt2UZwA5E2MzS4EI2gjfQhz5X28uqxAiEA3wNFxfrCZlSZHb0gn2zDpWow
cSxQAgiCstxGUoOqlW8CIQDDOerGKH5OmCJ4Z21v+F25WaHYPxCFMvwxpcw99Ecv
DQIgIdhDTIqD2jfYjPTY8Jj3EDGPbH2HHuffvflECt3Ek60CIQCFRlCkHpi7hthh
YhovyloRYsM+IS9h/0BzlEAuO0ktMQIgSPT3aFAgJYwKpqRYKlLDVcflZFCKY7u3
UP8iWi1Qw0Y=`;function Gt(m){const r=new qe;return r.setPublicKey(Nt),r.encrypt(m)}function Xt(m){const r=new qe;return r.setPrivateKey(Wt),r.decrypt(m)}const Zt={key:0},jt={key:1},$t={class:"slider-container"},eo={class:"slider-button"},to={__name:"resetPassword",props:{closeDialog:{type:Function,required:!0}},setup(m){const r=m,l=d(),i=d({username:"",password:"",confirmPassword:"",emailCode:""}),y={username:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:20,message:"密码长度必须介于 6 和 20 之间，且数字和英文混合",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/,message:"密码必须是数字和英文混合",trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"请再次输入新密码"},{required:!0,validator:(_,a,u)=>{i.value.password!==a?u(new Error("两次输入的密码不一致")):u()},trigger:"blur"}],emailCode:[{required:!0,trigger:"change",message:"请输入邮箱验证码"}]},w=d(!1),g=d("发送邮箱验证码"),h=d(!1);let k=null;const v=d(!1),b=d(0),M=d(!1),C=d(!1);function x(){if(!i.value.username){J.info("请先输入邮箱");return}v.value=!0,b.value=0,M.value=!1,C.value=!1}function O(_){_===100&&(M.value=!0,C.value=!0,setTimeout(()=>{v.value=!1,K()},500))}function K(){if(!i.value.username){J.info("请先输入邮箱");return}h.value=!0;let _=10;g.value=`${_}分钟 后重试`,k=setInterval(()=>{_--,_<=0?(clearInterval(k),h.value=!1,g.value="发送邮箱验证码"):g.value=`邮箱中已有验证码，或请 ${_}分钟 后重试`},1e3*60*10),te.get("/login/getMailCode",{params:{toEMail:i.value.username}}).then(a=>{a.code===200?J.success("验证码已发送，请查收邮箱"):(se.alert(a.msg||"邮箱不存在！或其他错误，请联系开发者","系统提示",{confirmButtonText:"OK"}),clearInterval(k),h.value=!1,g.value="发送邮箱验证码")}).catch(()=>{clearInterval(k),h.value=!1,g.value="发送邮箱验证码"})}function I(){l.value.validate(_=>{_&&(w.value=!0,te.post("/resetPassword",i.value).then(a=>{a.code===200?se.alert("密码重置成功！请使用新密码登录","系统提示",{type:"success"}).then(()=>{r.closeDialog()}).catch(()=>{}):(J.error(a.msg),w.value=!1)}).catch(a=>{se.alert(a.message,"系统提示",{type:"success"}),w.value=!1}))})}return(_,a)=>{const u=A("el-button"),p=A("el-input"),B=A("el-form-item"),R=A("el-form"),z=A("el-icon"),X=A("el-slider"),N=A("el-dialog");return f(),D("div",null,[e(R,{ref_key:"resetPasswordRef",ref:l,model:i.value,rules:y,class:"reset-form"},{default:t(()=>[a[7]||(a[7]=o("h3",{class:"title"},"重置密码",-1)),e(B,{prop:"username"},{default:t(()=>[e(p,{modelValue:i.value.username,"onUpdate:modelValue":a[0]||(a[0]=T=>i.value.username=T),type:"text",size:"large",clearable:"","prefix-icon":"Avatar","auto-complete":"off",placeholder:"请输入注册邮箱"},{append:t(()=>[e(u,{type:"primary",disabled:h.value,size:"small",style:{padding:"0","font-weight":"500"},onClick:x},{default:t(()=>[...a[6]||(a[6]=[U("发送邮箱验证码",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(B,{prop:"emailCode"},{default:t(()=>[e(p,{modelValue:i.value.emailCode,"onUpdate:modelValue":a[1]||(a[1]=T=>i.value.emailCode=T),type:"text",maxlength:"4",size:"large",clearable:"",placeholder:"请输入邮箱验证码"},null,8,["modelValue"])]),_:1}),e(B,{prop:"password"},{default:t(()=>[e(p,{modelValue:i.value.password,"onUpdate:modelValue":a[2]||(a[2]=T=>i.value.password=T),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"新密码",onKeyup:ee(I,["enter"])},null,8,["modelValue"])]),_:1}),e(B,{prop:"confirmPassword"},{default:t(()=>[e(p,{modelValue:i.value.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=T=>i.value.confirmPassword=T),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"确认新密码",onKeyup:ee(I,["enter"])},null,8,["modelValue"])]),_:1}),e(B,{style:{width:"100%"}},{default:t(()=>[e(u,{loading:w.value,size:"large",type:"primary",style:{width:"100%"},onClick:ge(I,["prevent"])},{default:t(()=>[w.value?(f(),D("span",jt,"重置中...")):(f(),D("span",Zt,"重置密码"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),e(N,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=T=>v.value=T),title:"安全验证",width:"300px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},{default:t(()=>[o("div",$t,[a[8]||(a[8]=o("div",{class:"slider-text"},"请滑动至最右侧完成验证",-1)),e(X,{modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=T=>b.value=T),min:0,max:100,step:1,"show-tooltip":!1,disabled:M.value,onChange:O},{button:t(()=>[o("div",eo,[C.value?(f(),H(z,{key:1},{default:t(()=>[e(V(Qe))]),_:1})):(f(),H(z,{key:0},{default:t(()=>[e(V(Ke))]),_:1}))])]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue"])])}}},oo=j(to,[["__scopeId","data-v-36784b01"]]),lo={class:"login-box"},ao={class:"login-code"},so=["src"],no={key:0},ro={key:1},io={__name:"login",props:{onRegister:{type:Function,required:!0},closeDialog:{type:Function,required:!0}},setup(m){const r=m,l=d(""),i=d(!1),n=d({username:"",password:"",rememberMe:!1,code:"",uuid:""}),y=$e({username:[{required:!0,message:"请输入邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"change"}]}),w=d(),g=d(!1),h=fe(),k=d("400px");function v(){h.value&&(k.value="95%")}v();function b(){w.value.validate(a=>{a&&(i.value=!0,n.value.rememberMe?(Z.set("username",n.value.username,{expires:525600}),Z.set("password",Gt(n.value.password),{expires:525600}),Z.set("rememberMe",n.value.rememberMe,{expires:525600})):(Z.remove("username"),Z.remove("password"),Z.remove("rememberMe")),te.post("/login",n.value).then(u=>{u.code===200?(J.success("登录成功"),Ae.value.show=!0,it(u.token,u.refreshToken,15*24*60*60),K()):(i.value=!1,J.error(u.msg))}).catch(()=>{i.value=!1,M.value&&C()}))})}const M=d(!0);function C(){te.get("/captchaImage").then(a=>{M.value=a.captchaEnabled===void 0?!0:a.captchaEnabled,M.value&&(l.value="data:image/gif;base64,"+a.img,n.value.uuid=a.uuid)})}function x(){const a=Z.get("username"),u=Z.get("password"),p=Z.get("rememberMe");n.value={username:a===void 0?n.value.username:a,password:u===void 0?n.value.password:Xt(u),rememberMe:p===void 0?!1:!!p}}x(),C();function O(){typeof r.onRegister=="function"?r.onRegister():console.error("onRegister is not a function")}function K(){r.closeDialog()}function I(){g.value=!0}function _(){g.value=!1}return(a,u)=>{const p=A("el-input"),B=A("el-form-item"),R=A("el-checkbox"),z=A("el-button"),X=A("el-form"),N=A("el-dialog");return f(),D("div",null,[o("div",lo,[u[7]||(u[7]=o("div",{class:"title"},"登 录",-1)),e(X,{model:n.value,ref_key:"formRef",ref:w,rules:y},{default:t(()=>[e(B,{prop:"username"},{default:t(()=>[e(p,{"prefix-icon":"Avatar",size:"large",clearable:"",modelValue:n.value.username,"onUpdate:modelValue":u[0]||(u[0]=T=>n.value.username=T),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),e(B,{prop:"password"},{default:t(()=>[e(p,{"show-password":"",size:"large","prefix-icon":"Lock",modelValue:n.value.password,"onUpdate:modelValue":u[1]||(u[1]=T=>n.value.password=T),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(B,{prop:"code"},{default:t(()=>[e(p,{modelValue:n.value.code,"onUpdate:modelValue":u[2]||(u[2]=T=>n.value.code=T),size:"large",clearable:"","auto-complete":"off",placeholder:"请输入验证码",style:{width:"63%"}},{prefix:t(()=>[...u[5]||(u[5]=[o("img",{src:Je,style:{width:"16px"}},null,-1)])]),_:1},8,["modelValue"]),o("div",ao,[o("img",{src:l.value,onClick:C,class:"login-code-img",onKeyup:ee(b,["enter"])},null,40,so)])]),_:1}),e(R,{modelValue:n.value.rememberMe,"onUpdate:modelValue":u[3]||(u[3]=T=>n.value.rememberMe=T),style:{margin:"0px 0px 5px 0px"}},{default:t(()=>[...u[6]||(u[6]=[U("记住密码",-1)])]),_:1},8,["modelValue"]),o("span",{style:{"margin-left":"35%",cursor:"pointer",color:"blue"},onClick:O},"还没有账号？去注册 >"),o("span",{style:{"margin-left":"75%",cursor:"pointer",color:"blue"},onClick:I},"重置密码 >"),e(B,null,{default:t(()=>[e(z,{loading:i.value,type:"primary",style:{width:"100%"},onClick:b},{default:t(()=>[i.value?(f(),D("span",ro,"登 录 中...")):(f(),D("span",no,"登 录"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),e(N,{"align-center":!0,modelValue:g.value,"onUpdate:modelValue":u[4]||(u[4]=T=>g.value=T),draggable:!0,width:k.value,modal:!1,"append-to-body":!0},{default:t(()=>[ie(e(oo,{closeDialog:_},null,512),[[pe,g.value]])]),_:1},8,["modelValue","width"])])}}},uo=j(io,[["__scopeId","data-v-69a7757c"]]),co={class:"register-code"},Ao=["src"],mo={key:0},po={key:1},go={class:"slider-container"},fo={class:"slider-button"},vo={__name:"register",setup(m){const r=d(),l=d({username:"",nickName:"",password:"",confirmPassword:"",code:"",uuid:"",emailCode:""}),n={username:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"},{min:6,max:20,message:"用户密码长度必须介于 6 和 20 之间，且数字和英文混合",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/,message:"密码必须是数字和英文混合",trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"请再次输入您的密码"},{required:!0,validator:(u,p,B)=>{l.value.password!==p?B(new Error("两次输入的密码不一致")):B()},trigger:"blur"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}],emailCode:[{required:!0,trigger:"change",message:"请输入邮箱验证码"}]},y=d(""),w=d(!1),g=d(!0),h=d("发送邮箱验证码"),k=d(!1);let v=null;const b=d(!1),M=d(0),C=d(!1),x=d(!1);function O(){if(!l.value.username){J.info("请先输入邮箱");return}b.value=!0,M.value=0,C.value=!1,x.value=!1}function K(u){u===100&&(C.value=!0,x.value=!0,setTimeout(()=>{b.value=!1,I()},500))}function I(){if(!l.value.username){J.info("请先输入邮箱");return}k.value=!0;let u=10;h.value=`${u}分钟 后重试`,v=setInterval(()=>{u--,u<=0?(clearInterval(v),k.value=!1,h.value="发送邮箱验证码"):h.value=`邮箱中已有验证码，或请 ${u}分钟 后重试`},1e3*60*10),te.get("/login/getMailCode",{params:{toEMail:l.value.username}}).then(p=>{p.code===200?J.success("验证码已发送，请查收邮箱"):(se.alert(p.msg||"邮箱不存在！ 或其他错误，请联系开发者","系统提示",{confirmButtonText:"OK"}),clearInterval(v),k.value=!1,h.value="发送邮箱验证码")}).catch(()=>{clearInterval(v),k.value=!1,h.value="发送邮箱验证码"})}function _(){r.value.validate(u=>{u&&(w.value=!0,te.post("/register",l.value).then(p=>{const B=l.value.username;p.code===200?se.alert("<font color='red'>恭喜你，您的账号 "+B+" 注册成功！</font>","系统提示",{dangerouslyUseHTMLString:!0,type:"success"}).then(()=>{}).catch(()=>{}):(J.error(p.msg),w.value=!1,g&&a())}).catch(()=>{w.value=!1,g&&a()}))})}function a(){te.get("/captchaImage").then(u=>{g.value=u.captchaEnabled===void 0?!0:u.captchaEnabled,g.value&&(y.value="data:image/gif;base64,"+u.img,l.value.uuid=u.uuid)})}return a(),(u,p)=>{const B=A("el-button"),R=A("el-input"),z=A("el-form-item"),X=A("el-form"),N=A("el-icon"),T=A("el-slider"),E=A("el-dialog");return f(),D("div",null,[e(X,{ref_key:"registerRef",ref:r,model:l.value,rules:n,class:"register-form"},{default:t(()=>[p[10]||(p[10]=o("h3",{class:"title"},"注册",-1)),e(z,{prop:"username"},{default:t(()=>[e(R,{modelValue:l.value.username,"onUpdate:modelValue":p[0]||(p[0]=s=>l.value.username=s),type:"text",size:"large",clearable:"","prefix-icon":"Avatar","auto-complete":"off",placeholder:"邮箱-用于登录"},{append:t(()=>[e(B,{type:"primary",disabled:k.value,size:"small",style:{padding:"0","font-weight":"500"},onClick:O},{default:t(()=>[...p[8]||(p[8]=[U("发送邮箱验证码",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(z,null,{default:t(()=>[e(R,{modelValue:l.value.nickName,"onUpdate:modelValue":p[1]||(p[1]=s=>l.value.nickName=s),type:"text",maxlength:"10",size:"large",clearable:"",placeholder:"昵称--平台昵称--后续不可更改"},null,8,["modelValue"])]),_:1}),e(z,{prop:"emailCode"},{default:t(()=>[e(R,{modelValue:l.value.emailCode,"onUpdate:modelValue":p[2]||(p[2]=s=>l.value.emailCode=s),type:"text",maxlength:"4",size:"large",clearable:"",placeholder:"请输入邮箱验证码"},null,8,["modelValue"])]),_:1}),e(z,{prop:"password"},{default:t(()=>[e(R,{modelValue:l.value.password,"onUpdate:modelValue":p[3]||(p[3]=s=>l.value.password=s),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"密码",onKeyup:ee(_,["enter"])},null,8,["modelValue"])]),_:1}),e(z,{prop:"confirmPassword"},{default:t(()=>[e(R,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":p[4]||(p[4]=s=>l.value.confirmPassword=s),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"确认密码",onKeyup:ee(_,["enter"])},null,8,["modelValue"])]),_:1}),g.value?(f(),H(z,{key:0,prop:"code"},{default:t(()=>[e(R,{size:"large",modelValue:l.value.code,"onUpdate:modelValue":p[5]||(p[5]=s=>l.value.code=s),"auto-complete":"off",clearable:"",placeholder:"请输入右侧验证码",style:{width:"63%"},onKeyup:ee(_,["enter"])},{prefix:t(()=>[...p[9]||(p[9]=[o("img",{src:Je,style:{width:"16px"}},null,-1)])]),_:1},8,["modelValue"]),o("div",co,[o("img",{src:y.value,onClick:a,class:"register-code-img"},null,8,Ao)])]),_:1})):G("",!0),e(z,{style:{width:"100%"}},{default:t(()=>[e(B,{loading:w.value,size:"large",type:"primary",style:{width:"100%"},onClick:ge(_,["prevent"])},{default:t(()=>[w.value?(f(),D("span",po,"注 册 中...")):(f(),D("span",mo,"注 册"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),e(E,{modelValue:b.value,"onUpdate:modelValue":p[7]||(p[7]=s=>b.value=s),title:"安全验证",width:"300px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},{default:t(()=>[o("div",go,[p[11]||(p[11]=o("div",{class:"slider-text"},"请滑动至最右侧完成验证",-1)),e(T,{modelValue:M.value,"onUpdate:modelValue":p[6]||(p[6]=s=>M.value=s),min:0,max:100,step:1,"show-tooltip":!1,disabled:C.value,onChange:K},{button:t(()=>[o("div",fo,[x.value?(f(),H(N,{key:1},{default:t(()=>[e(V(Qe))]),_:1})):(f(),H(N,{key:0},{default:t(()=>[e(V(Ke))]),_:1}))])]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue"])])}}},ho=j(vo,[["__scopeId","data-v-7a08e4c9"]]),wo={class:"avatar-wrapper"},_o=["innerHTML"],Eo={__name:"userHome",setup(m){const r=ut(),l=d(!1),i=d(!1),n=fe(),y=d(!1);function w(){l.value=!0,i.value=!1}let g="400px";function h(){n.value&&(g="95%")}h();function k(){se.confirm("确定退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{dt(),Ae.show=!1}).catch(()=>{})}function v(){l.value=!1,i.value=!0}function b(){l.value=!1}function M(){}return re(()=>r.loginVisible,C=>{l.value=C}),(C,x)=>{const O=A("User"),K=A("el-icon"),I=A("caret-bottom"),_=A("el-dropdown-item"),a=A("router-link"),u=A("el-dropdown-menu"),p=A("el-dropdown"),B=A("el-dialog");return f(),D(ae,null,[e(p,{onCommand:M,class:"right-menu-item hover-effect",trigger:"hover"},{dropdown:t(()=>[e(u,null,{default:t(()=>[e(a,{to:"/me-post"},{default:t(()=>[e(_,null,{default:t(()=>[...x[4]||(x[4]=[U("我的帖子",-1)])]),_:1})]),_:1}),e(a,{to:"/me-memes"},{default:t(()=>[e(_,null,{default:t(()=>[...x[5]||(x[5]=[U("我的投稿",-1)])]),_:1})]),_:1}),V(Ae).show?G("",!0):(f(),H(_,{key:0,command:"login",divided:""},{default:t(()=>[o("span",{onClick:w},"登录/注册")]),_:1})),e(a,{to:"/userInfo"},{default:t(()=>[e(_,null,{default:t(()=>[...x[6]||(x[6]=[U("个人中心",-1)])]),_:1})]),_:1}),e(_,{command:"login"},{default:t(()=>[o("span",{onClick:x[0]||(x[0]=R=>y.value=!0)},"隐私政策")]),_:1}),V(Ae).show?(f(),H(_,{key:1,divided:"",command:"logout"},{default:t(()=>[o("span",{onClick:k},"退出登录")]),_:1})):G("",!0)]),_:1})]),default:t(()=>[o("div",wo,[e(K,{size:"32"},{default:t(()=>[e(O)]),_:1}),e(K,null,{default:t(()=>[e(I)]),_:1})])]),_:1}),e(B,{"align-center":!0,modelValue:l.value,"onUpdate:modelValue":x[1]||(x[1]=R=>l.value=R),draggable:!0,width:V(g),modal:!1,"append-to-body":!0},{default:t(()=>[ie(e(uo,{onRegister:v,closeDialog:b},null,512),[[pe,l.value]])]),_:1},8,["modelValue","width"]),e(B,{"align-center":!0,modelValue:i.value,"onUpdate:modelValue":x[2]||(x[2]=R=>i.value=R),draggable:!0,width:V(g),modal:!1,"append-to-body":!0},{default:t(()=>[ie(e(ho,null,null,512),[[pe,i.value]])]),_:1},8,["modelValue","width"]),e(B,{modelValue:y.value,"onUpdate:modelValue":x[3]||(x[3]=R=>y.value=R),title:"社区规范与隐私政策",style:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",margin:"auto"},width:V(g),modal:!1,"append-to-body":!0},{default:t(()=>[o("div",{innerHTML:V(gt)},null,8,_o)]),_:1},8,["modelValue","width"])],64)}}},bo=j(Eo,[["__scopeId","data-v-2e331c24"]]),yo={class:"header"},Co={class:"header-content"},xo={class:"logo-link"},ko={class:"elinput-mobile"},Vo={class:"header-actions"},Do={class:"elinput"},Mo={class:"user-message"},To={class:"unread-badge"},Bo={class:"icon-img"},So={class:"dialog-header"},Uo={class:"dialog-header"},Te="我还没有加载完喔~~",Io="https://cdn.hguofichp.cn/power.png",Ro=ue({__name:"header-bar",setup(m){const r=fe(),l=Le(),i=d(!1),n=d(!1),y=d([]),w=d(!0),g=d(!0);async function h(){const s=await at();s&&(y.value=s,w.value=!1)}function k(){n.value=!0,v.value=!1,w.value=!0,h()}const v=d(!1),b=d([]),M=d(!0);async function C(){const s=await st();s&&(b.value=s,M.value=!1)}function x(){n.value=!1,v.value=!0,M.value=!0,C()}const O=le(()=>!(r.value&&l.path!=="/home"));h();const K=d(0);setInterval(()=>{const s=y.value.length;K.value=(K.value+1)%s},5e3);const I=d(""),_=d(""),a=d(!1);function u(){if(I.value.trim()===""){J.warning("请输入搜索内容");return}a.value=!0,_.value=I.value}function p(s){var c;s.preventDefault(),s.stopPropagation(),u(),(c=s.target)==null||c.blur()}const B=le(()=>r.value?"100%":"35%");le(()=>r.value?"90%":"35%");const R=d(0),z=d(0),X=le(()=>R.value+z.value),N=d(!1);async function T(){try{const s=await te.get("/machine/SysMessage/getMsgNum");s.code===200&&(R.value=s.data.likeAndStatementNum,z.value=s.data.commentNum,N.value=s.data.readFlag)}catch(s){console.error("获取消息数量失败:",s)}}Ie(()=>{T(),setInterval(()=>{T()},10*60*1e3),setTimeout(()=>{i.value=!0,setInterval(()=>{i.value=!0},2*60*60*1e3)},60*60*1e3),setTimeout(()=>{g.value=!1},5e3)});const E=()=>{window.open("https://www.wjx.cn/vm/rQUgnS0.aspx#")};return d(!1),(s,c)=>{const Q=A("el-icon"),F=A("el-button"),W=A("el-input"),q=A("el-tooltip"),L=A("el-image"),de=A("el-dropdown-item"),ve=A("router-link"),he=A("el-dropdown-menu"),S=A("el-dropdown"),oe=A("el-dialog");return f(),D("div",yo,[o("div",Co,[o("div",xo,[c[8]||(c[8]=o("a",{href:"https://www.douyu.com/6657",target:"_blank"},[o("img",{src:ht,alt:"大🐖头",class:"logo-img"}),o("p",{class:"header-title"},"斗鱼玩机器烂梗库")],-1)),o("div",ko,[e(W,{modelValue:I.value,"onUpdate:modelValue":c[0]||(c[0]=P=>I.value=P),type:"search",placeholder:"输入以搜索烂梗...",clearable:"",onKeyup:ee(p,["enter","native"])},{append:t(()=>[e(F,{type:"primary",onClick:u},{default:t(()=>[e(Q,null,{default:t(()=>[e(V(xe))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),o("div",Vo,[O.value?(f(),D("img",{key:0,src:wt,alt:"热门",class:"hot-barrage-img",onClick:k})):G("",!0),O.value?(f(),D("div",{key:1,onClick:k,class:"hot-barrage"},[e(Ue,{name:"fade"},{default:t(()=>{var P,ye;return[(f(),D("span",{key:K.value,class:"hot-barrage-span"},"热门："+Y(((ye=(P=y.value)==null?void 0:P[K.value])==null?void 0:ye.content)||""),1))]}),_:1})])):G("",!0),o("div",Do,[e(W,{modelValue:I.value,"onUpdate:modelValue":c[1]||(c[1]=P=>I.value=P),type:"search",placeholder:"输入以搜索烂梗...",clearable:"",onKeyup:ee(p,["enter","native"])},{append:t(()=>[e(F,{type:"primary",onClick:u},{default:t(()=>[e(Q,null,{default:t(()=>[e(V(xe))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(F,{type:"primary",onClick:E,class:"complaint-button"},{default:t(()=>[...c[9]||(c[9]=[U(" 上传照片 ",-1),o("br",null,null,-1),U(" 建议/提交BUG ",-1)])]),_:1}),e(q,{effect:"light",content:"接程序设计，广告，商务，详情联系邮箱 he20020928@foxmail.com",placement:"bottom"},{default:t(()=>[...c[10]||(c[10]=[o("img",{src:_t,alt:"heihei",class:"icon-container icon-img"},null,-1)])]),_:1}),c[12]||(c[12]=et('<a class="icon-container" href="https://sb6657.cn/#/Tampermonkey" data-v-55f7bc17><img src="https://pic.imgdb.cn/item/6704f830d29ded1a8c738f70.png" alt="油猴" class="icon-img" data-v-55f7bc17></a><a class="icon-container" href="https://yuba.douyu.com/feed/2639094748291342931" target="_blank" data-v-55f7bc17><img src="'+Et+'" alt="douyu" class="icon-img" data-v-55f7bc17></a><a class="icon-container" href="https://github.com/SEhzm/sb6657/" target="_blank" data-v-55f7bc17><img src="'+bt+'" alt="github" class="icon-img" data-v-55f7bc17></a>',3)),e(q,{visible:g.value,"onUpdate:visible":c[3]||(c[3]=P=>g.value=P),content:"如果你喜欢这个网站，可以点我进行赞赏或GitHub点个star~",placement:"bottom",effect:"light"},{default:t(()=>[e(L,{class:"icon-container icon-img",src:Io,fit:"cover",onClick:c[2]||(c[2]=P=>i.value=!0)})]),_:1},8,["visible"]),e(S,{trigger:"hover"},{dropdown:t(()=>[e(he,null,{default:t(()=>[e(ve,{to:"/me-msg"},{default:t(()=>[e(de,null,{default:t(()=>[U("评论 ("+Y(z.value)+")",1)]),_:1}),e(de,null,{default:t(()=>[U("赞和表态 ("+Y(R.value)+")",1)]),_:1})]),_:1})]),_:1})]),default:t(()=>[o("div",Mo,[c[11]||(c[11]=o("div",{class:"message-icon"},[o("img",{src:yt,alt:"msg"}),o("div",null,"消息")],-1)),o("span",To,Y(X.value||"0"),1)])]),_:1}),o("div",Bo,[e(bo)])])]),e(Ve,{modelValue:n.value,"onUpdate:modelValue":c[4]||(c[4]=P=>n.value=P),memeArr:y.value,loading:w.value,emptyText:Te,onRefresh:h},{default:t(()=>[o("div",So,[c[14]||(c[14]=o("div",null,"24h热门烂梗",-1)),o("div",null,[e(F,{onClick:x},{default:t(()=>[...c[13]||(c[13]=[U("查看近七天热门",-1)])]),_:1})])])]),_:1},8,["modelValue","memeArr","loading"]),e(Ve,{modelValue:v.value,"onUpdate:modelValue":c[5]||(c[5]=P=>v.value=P),memeArr:b.value,loading:M.value,emptyText:Te,onRefresh:C},{default:t(()=>[o("div",Uo,[c[16]||(c[16]=o("div",null,"七天热门烂梗",-1)),o("div",null,[e(F,{onClick:k},{default:t(()=>[...c[15]||(c[15]=[U("查看近24h热门",-1)])]),_:1})])])]),_:1},8,["modelValue","memeArr","loading"]),e(Jt,{modelValue:a.value,"onUpdate:modelValue":c[6]||(c[6]=P=>a.value=P),searchKey:_.value},null,8,["modelValue","searchKey"]),e(oe,{modelValue:i.value,"onUpdate:modelValue":c[7]||(c[7]=P=>i.value=P),title:"谢谢你",width:B.value},{default:t(()=>[...c[17]||(c[17]=[o("img",{src:"http://cdn.hguofichp.cn/zfb.jpg",alt:"",width:"100%"},null,-1)])]),_:1},8,["modelValue","width"])])}}}),Ko=j(Ro,[["__scopeId","data-v-55f7bc17"]]),Qo={class:"footer"},Yo={class:"content"},zo={class:"date-font"},Po=ue({__name:"footer-bar",setup(m){const r=d(0),l=new Date("2026-02-16"),i=new Date;r.value=Math.ceil((l.getTime()-i.getTime())/(1e3*3600*24));const n=new Date("2024-02-07"),y=le(()=>{const g=new Date().getTime()-n.getTime();return Math.floor(g/(1e3*60*60*24))});return(w,g)=>(f(),D("div",Qo,[o("div",Yo,[o("div",zo,[g[0]||(g[0]=U("距服务器到期还有",-1)),o("span",null,Y(r.value),1),g[1]||(g[1]=U("天",-1))]),o("div",null,[g[2]||(g[2]=o("a",{href:"https://ipw.cn/ipv6webcheck/?site=sb6657.cn",title:"",target:"_blank",style:{color:"black"}},[o("img",{style:{display:"inline-block","vertical-align":"middle",width:"150px"},alt:"",src:"https://static.ipw.cn/icon/ipv6-s5.svg"})],-1)),U(" 本站已运行"+Y(y.value)+"天 ",1)])])]))}}),Oo=j(Po,[["__scopeId","data-v-c95cf16c"]]),Ne=mt("guibin",{state:()=>({Oni:""}),actions:{updateOni(m){this.Oni=m}}}),Fo=Ne();class Ho{constructor(r,l){ne(this,"timer",null);ne(this,"ws",null);ne(this,"rid");ne(this,"msgHandler");this.rid=r,this.msgHandler=l,"WebSocket"in window&&this.connect()}connect(){const r=Lo(2,5);this.ws=new WebSocket(`wss://danmuproxy.douyu.com:850${r}`),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{this.ws.send(we(`type@=loginreq/roomid@=${this.rid}`)),this.ws.send(we(`type@=joingroup/rid@=${this.rid}/gid@=-9999/`)),this.timer=window.setInterval(()=>{this.ws.send(we("type@=mrkl/"))},4e4)},this.ws.onerror=()=>{this.close()},this.ws.onmessage=l=>{const i=new FileReader;i.onload=()=>{const n=String(i.result).split("\0");for(let y=0;y<n.length;y++)n[y].length>12&&this.msgHandler(n[y])},i.readAsText(new Blob([l.data]))},this.ws.onclose=()=>{this.close(),this.reconnect()}}reconnect(){setTimeout(()=>{this.connect()},3e3)}close(){this.timer!==null&&(clearInterval(this.timer),this.timer=null),this.ws&&(this.ws.close(),this.ws=null)}}function we(m){let l=qo(m);const i=l.length+4+4+2+1+1+1,n=new Uint8Array(i),y=new Uint8Array(l.length);for(let h=0;h<y.length;h++)y[h]=l[h];const w=new Uint32Array([l.length+4+2+1+1+1]),g=new Uint32Array([689]);return n.set(new Uint8Array(w.buffer),0),n.set(new Uint8Array(w.buffer),4),n.set(new Uint8Array(g.buffer),8),n.set(y,12),n}function qo(m){const r=[],l=m.length;for(let i=0;i<l;i++){const n=m.charCodeAt(i);n>=65536&&n<=1114111?(r.push(n>>18&7|240),r.push(n>>12&63|128),r.push(n>>6&63|128),r.push(n&63|128)):n>=2048&&n<=65535?(r.push(n>>12&15|224),r.push(n>>6&63|128),r.push(n&63|128)):n>=128&&n<=2047?(r.push(n>>6&31|192),r.push(n&63|128)):r.push(n&255)}return r}function Lo(m,r){return Math.floor(Math.random()*(r-m+1))+m}function ce(m,r,l){const i=m.indexOf(r);if(i===-1)return"";const n=m.indexOf(l,i+r.length);return n===-1?"":m.substring(i+r.length,n)}function Jo(m){const r=m.match(/type@=(.*?)(\/|@)/),l=ce(m,"oni/vn@=","/");if(l&&Fo.updateOni(l),r&&r[1]==="rss"){ce(m,"rid@=","/");const i=ce(m,"ss@=","/"),n=ce(m,"ivl@=","/");console.log(i),i==="1"&&n==="0"&&No()}}function No(){if(!("Notification"in window)){alert("当前浏览器不支持开播通知");return}Notification.permission!=="granted"?Notification.requestPermission().then(m=>{m==="granted"?Be():alert("你拒绝了通知权限，无法收到开播通知，请在网址左侧打开权限")}):Be()}function Be(){const m=new Notification("来自sb6657.cn开播提醒",{body:"6657直播间已开播，快去观看吧！"});m.onclick=()=>{window.focus(),window.open("https://www.douyu.com/6657","_blank")}}const Wo={class:"tab"},Go={class:"tab-container"},Xo=["onClick"],Zo={class:"main-content"},jo={class:"sidebar"},$o={class:"sidebar-icon"},el=["src"],tl={class:"content"},ol={class:"version"},ll={class:"GuiBin"},al=ue({__name:"MainLayout",setup(m){const r=Le(),l=ft(),i=Ne();be().setMemeTags();const y=le(()=>i.Oni),w=d();Ie(()=>{const h=document.querySelector("#global-loading");h&&(h.classList.add("fade-out"),setTimeout(()=>h.remove(),500)),w.value=new Ho(6979222,Jo)});function g(h){l.push(h)}return(h,k)=>{const v=A("el-menu-item"),b=A("el-menu"),M=A("router-view");return f(),D(ae,null,[o("div",null,[e(Ko),o("div",Wo,[o("div",Go,[(f(!0),D(ae,null,me(V(ke),(C,x)=>(f(),D("div",{class:tt(`tab1 ${C.path===V(r).path?"selected":"none"}`),key:C.path,onClick:O=>g(C.path)},Y(C.text),11,Xo))),128))])]),o("div",Zo,[o("div",jo,[e(b,{router:"",class:"sidebar-el-menu","default-active":h.$route.path},{default:t(()=>[(f(!0),D(ae,null,me(V(ke),(C,x)=>(f(),H(v,{key:C.path,index:C.path},{default:t(()=>[o("div",$o,[o("img",{src:C.icon,alt:""},null,8,el)]),o("span",null,Y(C.text),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),o("div",tl,[e(M)])]),e(Oo)]),e(V(vt),{to:"/update"},{default:t(()=>[o("span",ol,"版本: "+Y(V(ct)),1)]),_:1}),k[0]||(k[0]=o("div",{class:"GuangGaoWei"},[o("span",{style:{display:"flex","font-size":"large",color:"white"}},"广告位招租")],-1)),o("div",ll,"当前直播间贵宾数:"+Y(y.value),1)],64)}}}),Ml=j(al,[["__scopeId","data-v-edbc3a29"]]);export{Ml as default};
