var Ge=Object.defineProperty;var Xe=(c,n,l)=>n in c?Ge(c,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[n]=l;var ce=(c,n,l)=>Xe(c,typeof n!="symbol"?n+"":n,l);import{d as me,bk as be,bK as Ue,h as u,al as d,ar as Ze,c as E,o as p,R as e,J as t,K as Ae,I as q,O as R,P as Q,a as o,Q as oe,a6 as re,u as V,L,W as ve,C as je,i as ne,j as ie,M as $e,T as Ie,S as fe,bW as ke,a4 as le,l as et,f as Re,aU as tt,E as ot}from"./@vue.BltuATdo.js";import{u as Ce,g as Ke,e as lt,s as at,a as st,b as nt}from"./time.Bm-xCisx.js";import{d as it,B as rt,l as ut,R as Qe,j as Ye,M as xe}from"./@element-plus.D0bpsst8.js";import{f as ze,t as Pe,u as he,d as dt}from"./flip-num.BkpjeUo1.js";import{c as Oe,a as Fe,p as Ee,l as He,b as qe}from"./setMeme.C4UhU9RD.js";import{_ as ee,h as ae,i as ge,s as ct,u as At,r as mt,M as Ve,a as pt}from"./index.B4Mr7ZV4.js";import{s as gt,d as ft}from"./pinia.DfSVr1RC.js";import{a as $}from"./js-cookie.Cz0CWeBA.js";import{J as Le}from"./jsencrypt.BceYZi2u.js";import{a as G,E as ue}from"./element-plus.BELI2msV.js";import{C as vt}from"./CommunityNorms.CUOXHbp7.js";import{u as Je,b as ht,R as _t}from"./vue-router.BFvkXMb7.js";import"./axios.ngrFHoWO.js";import"./lodash-es.CDeyng3v.js";import"./@vueuse.BO4JNAXw.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";const wt="/favicon.ico",yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA1xJREFUWEfFl0uMDFEUhv9zp+eWR8LCQiKqeojWVSQSkQhigYVHwkZibCSIMAssiYUEsfBYSohMhAmxQMTCI0YiZkMsSJDQ1Qymq82IRyzGI/qWqUNNjHT31DtE77ruf87/3XPvOdVN+M8fyuJfzmurPPZ0y3E7s8TXx2QCKBmtxwi0E8BDAEdMR13KCpIJwDbkAwDz6kzbs0JkBfgOQKvfNTOtsKq1W2krkRqglM8tIhZ3RxkRnkihlk9/jXdpIFID2Lo8CMLeIBNmPm5V3R3/FiAvH4MxJ8SkH2OVZZbxOSlEqgqUdG05EXdHJidsMCvq/D8BsHXtFIi3xCQ/bzpqw18HKOnaCiK+mSDxJ9NRk3zdC0POKjjqWVRMoiPwEw0B1wG0JQAAe97SnBDvPeAiiHYXK7UbYXGxAKWpuSUkxJ0kxiMaH4CE8E3HgvkDt7TMt/q+9wXliATIYh7cnrhiVdXaVAC+OYS4TsC4NLuP0K43HXWxeT2wAqW2MW3EXjcYM/+SOQC6azq1xYkAyoY8w8CmWHPmHhAtidX9FhB4Y9Fxz9brR1WgpLduIqIzMUk/C0aHB96WCoBxpdh0F0YBlHV5mQmBF2YYirmHPdFh9dee23rrnTQAfrjpqAbPhi8DUzBuMCe/Ruy+TD/U4uIAPvqaLF3CQkyrb8kGgFI+t5BY3AsFIN5iVtzT9euxFWtK5s8I682PnpHHDQB2fsw0sPcqBKDbdNTKoDXbkP64tZJcxkiAx5MxXtPkl5CBsb/oqANhJrYhOQnAkOC5s/vcR4EV8B+WDdnFwMbmZAK0ZqZTuxZlYhvSHzTrwjQM9FqOKkS2oZ3PLQOL281JmksXZPLc0FZ74KthAES8tVhxT0UC+Iu2IS8AaK8XJgF4Oguy5YushRxhV9FRm5vXQl9GtqGdBLjjz1kxby9W3RNRRzA8wj3vdYBm0HTUxBCw8JTPDHlUALuGFcw9ZtVdGgXwIp9bODS6jUO7x88V/3sg37qDmHYD0Jl5s1V1u8IgyoY8xMCe3+sDBHRGdU4igBGzsiH3/arDPsFUKFRrL0Pmgf9XbSIB5zTKdbZVvr2Na83YCjQn8EGEVIcLvWi4bP5zZjx6UlXX2oGhOOPQOZA0sF53fwYmLOjFYJbYn3WiRDAd4qVAAAAAAElFTkSuQmCC",bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAcpJREFUWEftlk1uwkAMhe3CJSoFCZbAIQq75BQNJyk9CXCKsCscgmbZSETqJUpdOcykMyaTECX8LMiKiMT+7HnPDsKNL7xxfngA3EcH0t16AQjhFfWQENGq+wRLTD/XHwAwuWLyPBURvTMAGcmTDtL0eRgklwD6jqP+gXBhFJxIAM57EQiV/EsWlgN0kAYHQj6OPkMQ0qw3DDZtdGIfRxM8xs4K5Nj6PgfwRj4qyn8IolVvHMybQBQl58L00VsAnKhNiDSOQjieOV8bb+RPdTFOAA3x8wshIr7xPau1bif2u2iu35fJOWYpQFMIa64QLL2xP5PHWAmgX7AqcQQzg5tzpaxzZwNwcNHOxBv5A1nRiceRZt4wWLoEXA/AttHJrCgaMFU2PhtA2kjNiaOfiVb8wxBbpnY16bL/XeI9C0Akz2zkmmh6wHQBEsNBTohKAMvDQnwMoZK8KJtuZaWmborEWApgia5CTGVTsgzCCWB6mJCmTfeB2UmzE4UAlodbSK67Y+lGHecJgKXeFjehgMgXnXYTLyPe0byC81XZtO0uXYhFlz2GYso12by1380+yQxLvRqdqB2s5gv5fLiPz/Ka9K0+/ujAzTvwBwY/rnW+YWzQAAAAAElFTkSuQmCC",Et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABpBJREFUWEfFVntM01cUPi0FHIUibVE6YEFAHrNDuoJUaVgJG6AVVByPoQkrSJSNmbmREHAoYSlBNwUT4yYBSUgMhOfEF60BXOVhKBKUoICAlIrUpRZaHl1XS7f7Y2UgbUH+cCe5f93H953Hd+7Bwf9suHXiOwGAGwBIAGBinW9g196GwPYtW7bwZTJZmFqt3mAAdXBwUFOp1BdUKrXT0dHxRENDw8u3IbQmAgEBAb8+ffo0JSYmhrBjxw7YunUrUCgUDEehUGCrt7cXOjo6dAqF4t6DBw9CGQzGJbVafdjZ2dl2eHgYp9frZ4lE4gSJRLp3//79ZAPJVQn4+/sLkpOTw7lcLoyMjAAej4f29naIjY016mh9fT1cvHgRcnJygMPhgFAoBA8PD2w9evQIRCIRNDQ0jI+NjYUDwGOzBGg02hMul+tz9OhRCAwMBL1ej4EWFRVhEUDRMGYoGuPj4+Dl5QXu7u4rjjQ2NkJeXp5KoVBsNknAxcXlSUZGhs/U1BRYW1tDQUEBpKSkgLe3N+zduxeamppMEjBXA52dnXDjxg3o6+sDR0fH3UYJbNu2rTU1NTU4MjISzp07B+np6TA6Ogr79u2D06dPA41GAwaDAfb29hgWetRUNFB9kMlk7BxKjVAolNFotOLExMQKAoEwvoIAi8UqY7FYXx47dgy7pFQqQSKRgI+PD7i6ukJbWxtWdAbA2dlZSEtLg/LycqOOo5zjcDjo7u7Wi8XiC11dXSeWHlxGICwsLNLKyupWYWHhCmKoAJE5OztjKTHYqVOnoKqqCiorK8Hf398oiYiICFSE15ubm6PfPLAMKCAgYOjkyZMevr6+a5IyCunk5CRcvXoVzpw5g6XImHV3d0NmZqZKKpUu5GyJLRLgcDg/7Ny588ekpKQ1gefm5mIFiaQWGhqKqhri4uKM3kVpDAkJ0Ws0GrxJAtHR0XNnz559bzV0qVQKx48fh+joaEwZqBbEYjGmCpQeUxYWFgZ0On23QCBoXBEBDofz9fz8fL6fnx8JebFp0yaj76Cm0tXVBampqdDf34+B1tXVYYSOHDlilnt8fDxQqdTYpqamGqMpiI2NJQ8ODt6RyWQMOp2OQ56h7iWTybClUqmAx+Nhd5E89+zZg3mMeoKbG/qXzBubzQYmk0kRCAQKkypAGxwOxxYAMpRKZYRarXYi6OeoH77/2qaq5QX+0KFDmKeoD5gzJE0ikbh4RC6XA5fL1SmVSoJZFRg26XR638zMzOasBFrf/u1jIRRbLfz1Gg+dgxZQ066FO/0Oi00oISEBi4bB0D+xa9euZTilpaVIqlMSicRhNQJYs2exWHfJdtYdP8UMZw1P4EE+rYHWPgJ4O/8J30RZwvNXFlBQqwUbzzisSxqstrYWXFxcICgoaBkOqhm9Xv9La2vrV+YI6IODg3va2toY6FDRd+yJ9NBBNHhAcIYKarI3whOpBXSN2sKAloX9hp6enth76JcrKyuDsbExQCSW2pUrV6CkpEQbFBTke/v27WFTBJDny5pSStLhmhMs0cHC3xRwOd0Gnr+yhLJOL9jgGr4oN9RgmpubMQIxMTGQn5+/7P2enh5AKWKz2RdaW1u/NVY3OAsLi2d4PH5Gq9V+tPSAl5eX1NP+D5fy74mwkahd3Hr4zBLO18/8F/YODRQXFxv9jOh0Ovq0msVicZipojV4jSJQ/c+AsKyVsVisyo+p0vjcRDyQ7TQr3igV4OBCMwXrBW8a8pxEIt0SiURcc4pZGvaFaeNfIxKJsyQSSU4kEq2DPtA5ZR4kgLvTDGyw0oFy1hLaHltAdN4YZGVlwdL2rdVq4cCBA2gQqRcKhTHmwNHeqiNZZGRkoEajYY/0P/zZlUzAf/EJCaruTcPvvS8xBSxVwdDQEBQWFs6TyeTL1dXVKyreaA2YYshkMlump6dDAgMD8Q4OC/JFgwda6BNCMwDqiMh0Oh02DwwMDLxkMpkJOTk5d1fz3LBvNAIIXC6Xb5+cnHRAkw+aB1Fr9vPzW/HuzZs30ZCqs7KyKqmoqFiYYt7CzKYgKiqKOj09fXhubu5TlUrFoFAoThEREfil3y6KREtLy6qpXE0Fa+LM5XLpcrn8Rx6Ptx/NAciQ9svLy98NAQQYHh7+mZ2dnYDP52Og2dnZ6rq6Ops1eWDk0LqY+/j4POPz+W7Xrl1D03KtSCT6/J0SYLPZlyQSSZpOp5vj8/nOPB5v6p0SQGBIKRQK5bxQKLy+XnB072+HtI8zN1mH+gAAAABJRU5ErkJggg==",Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB/lBMVEUAAAACAAAEAAAGAAADAAAFAAAKAAAHAAAQAAABAAACAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAAAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAABAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAADAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAADAAAEAAAEAAAEAAAEAAAEAAAEAAAEAAD///+W3QZCAAAAqHRSTlMAAAAAAAAAAAAAAQoWHBsBEjt6vtTd1bx8QBUPWMTy9MhcAS6w+Pm1MwJI2d5RAknk5wEy2+jO6f7r0OU1ELP8cJnh0crL0+PmnWsRVfc8BigiFCMqB2LC9kVKEj77aFJGzx6/lwG7eVvtMS/sIRvcJtJEEwu5BAOLCnaW8wXaw6DH/Yg0OZBee7fwHvH6c2XJkjbGFhlPUzjgOp8tK+rWuDUOxR0pzW3NoAbKAAAAAWJLR0SpJw8GBAAAAAd0SU1FB+gCEwk0EkntIW4AAAIlSURBVDjLY2AgATBycfPw8vFw8zNhk2XiFxAUEhYRFRUTl5CUwlDDxCQtIyu3AgrkFRQFmFlQ5JWUVVRXIAE1dQ0uJBVMmlraK9CAjq4e3BomVn2DFRjAUNcIagYLk7HJihWmZuYWMDkLSyvrFStEbZgYIQbY2q1YYe8greFo7eTs4urm7uFpY+sFVC3uzQIxwMcX6HA/Jhb/gMAgW1up4JBQJiYtoJt9w1hBKpgEwoGmRkSi+JwpSg0oqBANVhAD8n9sHKqCeJACuQSgIAuzEMhdiUmoCqSSQaIpqSwMTNxpIHens6KEHAtTRixQOJmbCajWDcjKzEILfKbsHKCwiBRQAa8OkGUQjK4g1x0oLMrHxMCSlw9keRSgKwgwBArn84GsKATFXwK6gqIIoLBVMVBBSSnIvZ5lqI4srwCJJleyMLCwVoGYHjHI3mBhS7AEiVYrAQ1mkqwBsZ0lyxDRW6tfB044+kzgoK5fkdPQ2GTe3CJVzgIynae1LRMcq67FTOAwaVeT7yjoXGHRJQ4KTpbu0h5IxPf2sYOtZRLoXOHbHzJBzX5iOchKTQlowhAWYIIG6yTRFZOnTJ02fQpEw4wesPzMWdAEw8DCMc3QfvacYmlNiIK55iD5eTIMcH8x6U0TtZg3f8FUJoQCJx89pLBjZFjYqbrCKQmuQE18lhJq/LMs6l/svASiYGn+suW2LOh5i4XTdm4oWJClsiWIi4WBagAAZejSV585JrMAAAAASUVORK5CYII=",kt="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1745163196952'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='2577'%20data-spm-anchor-id='a313x.search_index.0.i2.58913a81ag2QCw'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='32'%20height='32'%3e%3cpath%20d='M898.96%20765.38h-77.17V418.11c0-154.94-114.87-283.22-263.85-305.05%200.11-1.26%200.73-2.35%200.73-3.63%200-25.16-20.4-45.56-45.56-45.56-25.16%200-45.56%2020.4-45.56%2045.56%200%201.29%200.63%202.37%200.73%203.63-148.98%2021.83-263.85%20150.11-263.85%20305.05v347.26h-77.17c-21.31%200-38.58%2017.28-38.58%2038.59s17.28%2038.59%2038.58%2038.59h252.75c9.46%2065.27%2065.25%20115.75%20133.1%20115.75s123.64-50.48%20133.1-115.75h252.75c21.31%200%2038.58-17.28%2038.58-38.59s-17.27-38.58-38.58-38.58zM513.11%20881.13c-25.15%200-46.61-16.13-54.58-38.58h109.16c-7.97%2022.45-29.43%2038.58-54.58%2038.58z%20m231.51-115.75H281.6V418.11c0-127.66%20103.85-231.51%20231.51-231.51s231.51%20103.85%20231.51%20231.51v347.27z'%20fill='%23e3d5b8'%20p-id='2578'%3e%3c/path%3e%3c/svg%3e",xt=["onTouchstart","onTouchend"],Vt={class:"barrage-text"},Dt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},Mt=["src"],Tt={style:{"vertical-align":"middle"}},Bt=me({__name:"meme-dialog",props:be({memeArr:{},loading:{type:Boolean},emptyText:{}},{modelValue:{},modelModifiers:{}}),emits:be(["refresh"],["update:modelValue"]),setup(c,{emit:n}){const l=Ce(),i=Ue(c,"modelValue"),s=n,k=Pe(qe,He,2e3);async function y(v){const x=v.content,B=k(x);if(!(!B||B==="limitedSuccess")){if(Oe(),await Fe(v.category,v.id)){s("refresh");return}Ee()}}const g=u([]);l.tagsLoaded.then(()=>{g.value=l.memeTags});const w=v=>{v.touchStartTime=Date.now()},T=v=>{Date.now()-v.touchStartTime>100&&(v.popoverVisible=!0,setTimeout(()=>{v.popoverVisible=!1},1500))};return(v,x)=>{const B=d("el-tag"),D=d("el-table-column"),M=d("el-popover"),H=d("el-button"),Y=d("el-table"),I=d("el-dialog"),h=Ze("loading");return p(),E("div",null,[e(I,{draggable:"",modelValue:i.value,"onUpdate:modelValue":x[0]||(x[0]=a=>i.value=a),class:"dialog-main"},{header:t(()=>[je(v.$slots,"default",{},void 0,!0)]),default:t(()=>[Ae((p(),q(Y,{data:v.memeArr,stripe:"","empty-text":v.emptyText,"cell-class-name":"hover-pointer",onRowClick:y},{default:t(()=>[e(D,{align:"center",width:"60"},{default:t(a=>[e(B,{round:"",effect:"plain"},{default:t(()=>[R(Q(a.$index+1),1)]),_:2},1024)]),_:1}),e(D,{prop:"content"},{default:t(a=>[e(M,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:t(()=>[o("div",{style:{cursor:"pointer"},onTouchstart:r=>w(a.row),onTouchend:r=>T(a.row)},[o("span",Vt,Q(a.row.content),1)],40,xt)]),default:t(()=>[o("div",Dt,[(p(!0),E(oe,null,re(V(Ke)(a.row.tags,g.value),(r,A)=>(p(),E("div",{key:A,style:{"margin-right":"8px"}},[e(B,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:t(()=>[r.iconUrl?(p(),E("img",{key:0,src:r.iconUrl,style:{width:"16px",height:"16px","object-fit":"cover","vertical-align":"middle"}},null,8,Mt)):L("",!0),o("span",Tt,Q(r.label),1)]),_:2},1024)]))),128))])]),_:2},1032,["visible"])]),_:1}),e(D,{align:"center",width:"100"},{default:t(a=>[e(H,{type:"primary",class:"copy-btn",onClick:ve(r=>y(a.row),["stop"])},{default:t(()=>[x[1]||(x[1]=R(" 复制 ( ",-1)),e(ze,{num:a.row.copyCount},null,8,["num"]),x[2]||(x[2]=R(" ) ",-1))]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"])),[[h,v.loading]])]),_:3},8,["modelValue"])])}}}),De=ee(Bt,[["__scopeId","data-v-7e763dd3"]]);var te=(c=>(c[c.ID=0]="ID",c[c.COPY=1]="COPY",c))(te||{});const St={class:"advanced-search"},Ut={class:"title"},It={class:"title-left"},Rt={class:"collapse-text"},Kt={class:"collapsible-content"},Qt={class:"time-container"},Yt={class:"tags-container"},zt={class:"selected-tags"},Pt={key:0,class:"tags"},Ot={class:"tag-icon-wrapper"},Ft=["src"],Ht={class:"tag-label"},qt={key:1,class:"empty-tips"},Lt={class:"all-tags"},Jt={class:"tags"},Nt={class:"tag-icon-wrapper"},Wt=["src"],Gt={class:"tag-label"},Xt={class:"empty-state"},Zt=["innerHTML"],jt={class:"popover-details"},$t={class:"tag-list"},eo={class:"tag-icon-wrapper"},to=["src"],oo={class:"tag-label"},lo={class:"submit-time"},ao={key:0,class:"pagination-container"},Me="正在搜索中...坐和放宽...",Te=20,so=me({__name:"search-dialog",props:be({searchKey:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const n=Ue(c,"modelValue"),l=c,i=he(),s=Ce(),{memeTags:k}=gt(s),y=u([]),g=u(!1),w=u(Me),T=u(te.ID),v=u(1),x=u(0);function B(){y.value=[],v.value=1,x.value=0,w.value=Me}async function D(f,m=te.ID,z=1,P,N){if(!f.trim())return;const{_failure:Z,flatData:J}=await at({barrage:f,sort:m,pageNum:z,tags:P==null?void 0:P.join(","),submitTime:N,pageSize:Te});if(Z||!J||J.list.length<=0){y.value=[],x.value=0,v.value=1,w.value="没有找到搜索结果。想要补充更多烂梗？请去首页投稿！";return}x.value=J.total,v.value=z,y.value=J.list.map(W=>({id:W.id.toString(),content:W.barrage,tags:W.tags,submitTime:W.submitTime,copyCount:+W.cnt}))}const M=dt(async(f,m=te.ID,z=1,P,N)=>{if(f.trim()){g.value=!0;try{await D(f,m,z,P,N)}finally{g.value=!1}}},300);function H(f){T.value=f}const Y=u(!0),I=u([]),h=u([]),a=u();let r=!1;function A(){Y.value=!Y.value}function U(){h.value=[],I.value=[...k.value],a.value=void 0}function K(){if(h.value.length===0&&!a.value)return;U();const f=[];M(l.searchKey,T.value,1,f,void 0)}function F(f){return f.getTime()<new Date("2024-09-24").getTime()}function j(f){h.value.find(m=>m.dictValue===f.dictValue)||(h.value.push(f),I.value=I.value.filter(m=>m.dictValue!==f.dictValue))}function X(f){h.value=h.value.filter(m=>m.dictValue!==f.dictValue),I.value.find(m=>m.dictValue===f.dictValue)||I.value.push(f)}const S=Pe(qe,He,2e3);async function de(f){const m=S(f.content);if(!(!m||m==="limitedSuccess")){Oe();try{if(await Fe("",f.id)){const P=y.value.findIndex(N=>N.id===f.id);P!==-1&&(y.value[P].copyCount+=1)}else Ee()}catch(z){console.error("更新复制计数失败:",z),Ee()}}}function b(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const _=ne(()=>{if(!l.searchKey||!y.value.length)return y.value;const f=new RegExp(b(l.searchKey),"gi");return y.value.map(m=>({...m,highlightedContent:m.content.replace(f,z=>`<span style="background-color: yellow">${z}</span>`)}))});return ie(n,f=>{f||(B(),U())}),ie(()=>l.searchKey,f=>{f.trim()&&(B(),M(f))},{immediate:!0}),ie(v,(f,m)=>{if(f!==m&&l.searchKey.trim()){const z=h.value.map(P=>P.dictValue);M(l.searchKey,T.value,f,z,a.value)}}),ie(k,f=>{r||!f||f.length===0||(r=!0,I.value=[...f])}),ie([h,a,T],([f,m,z],[P,N,Z])=>{if(P===void 0&&N===void 0&&Z===void 0)return;B();const J=f.map(W=>W.dictValue);M(l.searchKey,z,1,J,m)},{deep:!0}),(f,m)=>{const z=d("el-icon"),P=d("el-button"),N=d("el-date-picker"),Z=d("el-tag"),J=d("el-table-column"),W=d("el-popover"),_e=d("el-table"),we=d("el-pagination"),O=d("el-dialog");return p(),E("div",null,[e(O,{draggable:"",modelValue:n.value,"onUpdate:modelValue":m[6]||(m[6]=C=>n.value=C),class:"dialog-main"},{header:t(()=>[...m[7]||(m[7]=[o("span",{class:"search-tips"},"烂梗搜索结果:",-1)])]),default:t(()=>[o("div",St,[o("div",Ut,[o("div",It,[m[8]||(m[8]=o("span",{class:"title-text"},"高级筛选",-1)),e(P,{text:"",onClick:A,class:"collapse-btn"},{default:t(()=>[o("span",Rt,Q(Y.value?"展开":"收起"),1),e(z,null,{default:t(()=>[(p(),q($e(Y.value?"ArrowDown":"ArrowUp")))]),_:1})]),_:1}),T.value===V(te).ID?(p(),q(P,{key:0,text:"",type:"info",onClick:m[0]||(m[0]=C=>H(V(te).COPY)),size:V(i)?"small":"default"},{default:t(()=>[R(Q(V(i)?"复制数排序":"点击按复制次数排序"),1)]),_:1},8,["size"])):T.value===V(te).COPY?(p(),q(P,{key:1,text:"",type:"info",onClick:m[1]||(m[1]=C=>H(V(te).ID)),size:V(i)?"small":"default"},{default:t(()=>[R(Q(V(i)?"时间排序":"点击按id(时间)排序"),1)]),_:1},8,["size"])):L("",!0)]),e(P,{text:"",type:"danger",onClick:K},{default:t(()=>[R(Q(V(i)?"清空筛选":"清空已选高级搜索"),1)]),_:1})]),e(Ie,{name:"collapse"},{default:t(()=>[Ae(o("div",Kt,[o("div",Qt,[e(N,{class:"time-picker",modelValue:a.value,"onUpdate:modelValue":m[2]||(m[2]=C=>a.value=C),type:"daterange","range-separator":"到","value-format":"YYYY-MM-DD","start-placeholder":"起始","end-placeholder":"结束","disabled-date":F},null,8,["modelValue"])]),o("div",Yt,[o("div",zt,[m[9]||(m[9]=o("div",{class:"tags-title"},"已选标签:",-1)),h.value.length>0?(p(),E("div",Pt,[(p(!0),E(oe,null,re(h.value,C=>(p(),q(Z,{class:"tag1",key:C.dictValue,round:"",onClick:se=>X(C)},{default:t(()=>[o("div",Ot,[C.iconUrl?(p(),E("img",{key:0,src:C.iconUrl,class:"tag-icon"},null,8,Ft)):L("",!0),o("span",Ht,Q(C.dictLabel),1),e(z,null,{default:t(()=>[e(V(it))]),_:1})])]),_:2},1032,["onClick"]))),128))])):L("",!0),h.value.length===0?(p(),E("div",qt,"暂无已选标签(点击下面标签进行筛选)")):L("",!0)]),o("div",Lt,[m[10]||(m[10]=o("div",{class:"tags-title"},"所有标签:",-1)),o("div",Jt,[(p(!0),E(oe,null,re(I.value,C=>(p(),q(Z,{class:"tag1",key:C.dictValue,round:"",onClick:se=>j(C)},{default:t(()=>[o("div",Nt,[C.iconUrl?(p(),E("img",{key:0,src:C.iconUrl,class:"tag-icon"},null,8,Wt)):L("",!0),o("span",Gt,Q(C.dictLabel),1),e(z,null,{default:t(()=>[e(V(rt))]),_:1})])]),_:2},1032,["onClick"]))),128))])])])],512),[[fe,!Y.value]])]),_:1})]),e(_e,{data:_.value,stripe:"","cell-class-name":"hover-pointer","row-key":"id",lazy:!0},{empty:t(()=>[o("div",Xt,[w.value!=="没有找到搜索结果。想要补充更多烂梗？请去首页投稿！"?(p(),q(z,{key:0,class:"loading-icon"},{default:t(()=>[e(V(ut))]),_:1})):L("",!0),o("span",null,Q(w.value),1)])]),default:t(()=>[e(J,{align:"center",width:"70"},{default:t(C=>[ke([C.$index],()=>(p(),E("div",{class:"row-number"},[R(Q(C.row.id),1)])),m,3)]),_:1}),e(J,{prop:"content"},{default:t(C=>[e(W,{placement:"top",width:"auto",trigger:"hover"},{reference:t(()=>[o("div",{class:"barrage-text",innerHTML:C.row.highlightedContent||C.row.content},null,8,Zt)]),default:t(()=>[o("div",jt,[o("div",$t,[(p(!0),E(oe,null,re(V(Ke)(C.row.tags,V(k)),se=>(p(),E("div",{key:se.label},[e(Z,{round:"",effect:"dark",class:"tag-item"},{default:t(()=>[o("div",eo,[se.iconUrl?(p(),E("img",{key:0,src:se.iconUrl,class:"tag-icon"},null,8,to)):L("",!0),o("span",oo,Q(se.label),1)])]),_:2},1024)]))),128))]),o("div",lo,"投稿时间: "+Q(V(lt)(C.row.submitTime)),1)])]),_:2},1024)]),_:1}),e(J,{align:"center",width:"100"},{default:t(C=>[ke([C.row.id,C.row.copyCount],()=>(p(),E("div",null,[e(P,{type:"primary",class:"copy-btn",onClick:ve(se=>de(C.row),["stop"])},{default:t(()=>[m[11]||(m[11]=R(" 复制 ( ",-1)),e(ze,{num:C.row.copyCount},null,8,["num"]),m[12]||(m[12]=R(" ) ",-1))]),_:2},1032,["onClick"])])),m,4)]),_:1})]),_:1},8,["data"]),x.value>0?(p(),E("div",ao,[e(we,{"current-page":v.value,"onUpdate:currentPage":m[5]||(m[5]=C=>v.value=C),"page-size":Te,total:x.value,layout:V(i)?"prev, pager, next":"total, prev, pager, next, jumper",size:"small",background:""},null,8,["current-page","total","layout"])])):L("",!0)]),_:1},8,["modelValue"])])}}}),no=ee(so,[["__scopeId","data-v-e6879610"]]),Ne="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1569580729849'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1939'%20width='200'%20height='200'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c/style%3e%3c/defs%3e%3cpath%20d='M513.3%20958.5c-142.2%200-397.9-222.1-401.6-440.5V268c1.7-39.6%2031.7-72.3%2071.1-77.3%2049-4.6%2097.1-16.5%20142.7-35.3%2047.8-14%2091.9-38.3%20129.4-71.1%2030.3-24.4%2072.9-26.3%20105.3-4.6%2039.9%2030.7%2083.8%2055.9%20130.5%2074.6%2048.6%2014.7%2098.2%2025.9%20148.4%2033.7%2038.5%207.6%2067.1%2040.3%2069.5%2079.5%203.3%2084.9%202.5%20169.9-2.6%20254.7-33.7%20281.6-253.7%20436.4-392.7%20436.3z%20m-0.1-813.7c-7.2-0.2-14.3%202-20%206.4-39.7%2035.2-86.8%2061.1-137.7%2075.7-46.8%2019.2-96.2%2031-146.6%2035.2-11%203.2-18.8%2013-19.5%2024.4v230.1c3.5%20180.3%20223.3%20361%20323.9%20361s287.3-120.2%20317.6-360.5c7.3-142.7%200-228.6%200-229.6-1.3-13.3-11-24.3-24-27.3-49.6-7.7-98.6-19-146.5-33.7-46.3-19.5-89.7-45.3-129-76.7-5.8-3.8-12.7-5.5-19.5-4.9l1.3-0.1z'%20fill='%23C6CCDA'%20p-id='1940'%3e%3c/path%3e%3cpath%20d='M750.1%20428L490.7%20673.2c-11.7%2011.1-29.5%2012.9-43.1%204.2l-6.8-5.8-141.2-149.4c-9.3-9.3-12.7-22.9-9-35.5%203.8-12.6%2014.1-22.1%2027-24.8%2012.9-2.7%2026.1%201.9%2034.6%2011.9L469%20597.5l233.7-221c14.6-12.8%2036.8-11.6%2049.9%202.7%2013.2%2014.2%2011.5%2035.3-2.5%2048.8'%20fill='%23C6CCDA'%20p-id='1941'%3e%3c/path%3e%3c/svg%3e",io=`MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKoR8mX0rGKLqzcWmOzbfj64K8ZIgOdH
nzkXSOVOZbFu/TJhZ7rFAN+eaGkl3C4buccQd/EjEsj9ir7ijT7h96MCAwEAAQ==`,ro=`MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAqhHyZfSsYourNxaY
7Nt+PrgrxkiA50efORdI5U5lsW79MmFnusUA355oaSXcLhu5xxB38SMSyP2KvuKN
PuH3owIDAQABAkAfoiLyL+Z4lf4Myxk6xUDgLaWGximj20CUf+5BKKnlrK+Ed8gA
kM0HqoTt2UZwA5E2MzS4EI2gjfQhz5X28uqxAiEA3wNFxfrCZlSZHb0gn2zDpWow
cSxQAgiCstxGUoOqlW8CIQDDOerGKH5OmCJ4Z21v+F25WaHYPxCFMvwxpcw99Ecv
DQIgIdhDTIqD2jfYjPTY8Jj3EDGPbH2HHuffvflECt3Ek60CIQCFRlCkHpi7hthh
YhovyloRYsM+IS9h/0BzlEAuO0ktMQIgSPT3aFAgJYwKpqRYKlLDVcflZFCKY7u3
UP8iWi1Qw0Y=`;function uo(c){const n=new Le;return n.setPublicKey(io),n.encrypt(c)}function co(c){const n=new Le;return n.setPrivateKey(ro),n.decrypt(c)}const Ao={key:0},mo={key:1},po={class:"slider-container"},go={class:"slider-button"},fo={__name:"resetPassword",props:{closeDialog:{type:Function,required:!0}},setup(c){const n=c,l=u(),i=u({username:"",password:"",confirmPassword:"",emailCode:""}),k={username:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入新密码"},{min:6,max:20,message:"密码长度必须介于 6 和 20 之间，且数字和英文混合",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/,message:"密码必须是数字和英文混合",trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"请再次输入新密码"},{required:!0,validator:(h,a,r)=>{i.value.password!==a?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}],emailCode:[{required:!0,trigger:"change",message:"请输入邮箱验证码"}]},y=u(!1),g=u("发送邮箱验证码"),w=u(!1);let T=null;const v=u(!1),x=u(0),B=u(!1),D=u(!1);function M(){if(!i.value.username){G.info("请先输入邮箱");return}v.value=!0,x.value=0,B.value=!1,D.value=!1}function H(h){h===100&&(B.value=!0,D.value=!0,setTimeout(()=>{v.value=!1,Y()},500))}function Y(){if(!i.value.username){G.info("请先输入邮箱");return}w.value=!0;let h=10;g.value=`${h}分钟 后重试`,T=setInterval(()=>{h--,h<=0?(clearInterval(T),w.value=!1,g.value="发送邮箱验证码"):g.value=`邮箱中已有验证码，或请 ${h}分钟 后重试`},1e3*60*10),ae.get("/login/getMailCode",{params:{toEMail:i.value.username}}).then(a=>{a.code===200?G.success("验证码已发送，请查收邮箱"):(ue.alert(a.msg||"邮箱不存在！或其他错误，请联系开发者","系统提示",{confirmButtonText:"OK"}),clearInterval(T),w.value=!1,g.value="发送邮箱验证码")}).catch(()=>{clearInterval(T),w.value=!1,g.value="发送邮箱验证码"})}function I(){l.value.validate(h=>{h&&(y.value=!0,ae.post("/resetPassword",i.value).then(a=>{a.code===200?ue.alert("密码重置成功！请使用新密码登录","系统提示",{type:"success"}).then(()=>{n.closeDialog()}).catch(()=>{}):(G.error(a.msg),y.value=!1)}).catch(a=>{ue.alert(a.message,"系统提示",{type:"success"}),y.value=!1}))})}return(h,a)=>{const r=d("el-button"),A=d("el-input"),U=d("el-form-item"),K=d("el-form"),F=d("el-icon"),j=d("el-slider"),X=d("el-dialog");return p(),E("div",null,[e(K,{ref_key:"resetPasswordRef",ref:l,model:i.value,rules:k,class:"reset-form"},{default:t(()=>[a[7]||(a[7]=o("h3",{class:"title"},"重置密码",-1)),e(U,{prop:"username"},{default:t(()=>[e(A,{modelValue:i.value.username,"onUpdate:modelValue":a[0]||(a[0]=S=>i.value.username=S),type:"text",size:"large",clearable:"","prefix-icon":"Avatar","auto-complete":"off",placeholder:"请输入注册邮箱"},{append:t(()=>[e(r,{type:"primary",disabled:w.value,size:"small",style:{padding:"0","font-weight":"500"},onClick:M},{default:t(()=>[...a[6]||(a[6]=[R("发送邮箱验证码",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(U,{prop:"emailCode"},{default:t(()=>[e(A,{modelValue:i.value.emailCode,"onUpdate:modelValue":a[1]||(a[1]=S=>i.value.emailCode=S),type:"text",maxlength:"4",size:"large",clearable:"",placeholder:"请输入邮箱验证码"},null,8,["modelValue"])]),_:1}),e(U,{prop:"password"},{default:t(()=>[e(A,{modelValue:i.value.password,"onUpdate:modelValue":a[2]||(a[2]=S=>i.value.password=S),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"新密码",onKeyup:le(I,["enter"])},null,8,["modelValue"])]),_:1}),e(U,{prop:"confirmPassword"},{default:t(()=>[e(A,{modelValue:i.value.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=S=>i.value.confirmPassword=S),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"确认新密码",onKeyup:le(I,["enter"])},null,8,["modelValue"])]),_:1}),e(U,{style:{width:"100%"}},{default:t(()=>[e(r,{loading:y.value,size:"large",type:"primary",style:{width:"100%"},onClick:ve(I,["prevent"])},{default:t(()=>[y.value?(p(),E("span",mo,"重置中...")):(p(),E("span",Ao,"重置密码"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),e(X,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=S=>v.value=S),title:"安全验证",width:"300px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},{default:t(()=>[o("div",po,[a[8]||(a[8]=o("div",{class:"slider-text"},"请滑动至最右侧完成验证",-1)),e(j,{modelValue:x.value,"onUpdate:modelValue":a[4]||(a[4]=S=>x.value=S),min:0,max:100,step:1,"show-tooltip":!1,disabled:B.value,onChange:H},{button:t(()=>[o("div",go,[D.value?(p(),q(F,{key:1},{default:t(()=>[e(V(Ye))]),_:1})):(p(),q(F,{key:0},{default:t(()=>[e(V(Qe))]),_:1}))])]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue"])])}}},vo=ee(fo,[["__scopeId","data-v-36784b01"]]),ho={class:"login-box"},_o={class:"login-code"},wo=["src"],yo={key:0},bo={key:1},Eo={__name:"login",props:{onRegister:{type:Function,required:!0},closeDialog:{type:Function,required:!0}},setup(c){const n=c,l=u(""),i=u(!1),s=u({username:"",password:"",rememberMe:!1,code:"",uuid:""}),k=et({username:[{required:!0,message:"请输入邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"change"}]}),y=u(),g=u(!1),w=he(),T=u("400px");function v(){w.value&&(T.value="95%")}v();function x(){y.value.validate(a=>{a&&(i.value=!0,s.value.rememberMe?($.set("username",s.value.username,{expires:525600}),$.set("password",uo(s.value.password),{expires:525600}),$.set("rememberMe",s.value.rememberMe,{expires:525600})):($.remove("username"),$.remove("password"),$.remove("rememberMe")),ae.post("/login",s.value).then(r=>{r.code===200?(G.success("登录成功"),ge.value.show=!0,ct(r.token,r.refreshToken,15*24*60*60),Y()):(i.value=!1,G.error(r.msg))}).catch(()=>{i.value=!1,B.value&&D()}))})}const B=u(!0);function D(){ae.get("/captchaImage").then(a=>{B.value=a.captchaEnabled===void 0?!0:a.captchaEnabled,B.value&&(l.value="data:image/gif;base64,"+a.img,s.value.uuid=a.uuid)})}function M(){const a=$.get("username"),r=$.get("password"),A=$.get("rememberMe");s.value={username:a===void 0?s.value.username:a,password:r===void 0?s.value.password:co(r),rememberMe:A===void 0?!1:!!A}}M(),D();function H(){typeof n.onRegister=="function"?n.onRegister():console.error("onRegister is not a function")}function Y(){n.closeDialog()}function I(){g.value=!0}function h(){g.value=!1}return(a,r)=>{const A=d("el-input"),U=d("el-form-item"),K=d("el-checkbox"),F=d("el-button"),j=d("el-form"),X=d("el-dialog");return p(),E("div",null,[o("div",ho,[r[7]||(r[7]=o("div",{class:"title"},"登 录",-1)),e(j,{model:s.value,ref_key:"formRef",ref:y,rules:k},{default:t(()=>[e(U,{prop:"username"},{default:t(()=>[e(A,{"prefix-icon":"Avatar",size:"large",clearable:"",modelValue:s.value.username,"onUpdate:modelValue":r[0]||(r[0]=S=>s.value.username=S),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),e(U,{prop:"password"},{default:t(()=>[e(A,{"show-password":"",size:"large","prefix-icon":"Lock",modelValue:s.value.password,"onUpdate:modelValue":r[1]||(r[1]=S=>s.value.password=S),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),e(U,{prop:"code"},{default:t(()=>[e(A,{modelValue:s.value.code,"onUpdate:modelValue":r[2]||(r[2]=S=>s.value.code=S),size:"large",clearable:"","auto-complete":"off",placeholder:"请输入验证码",style:{width:"63%"}},{prefix:t(()=>[...r[5]||(r[5]=[o("img",{src:Ne,style:{width:"16px"}},null,-1)])]),_:1},8,["modelValue"]),o("div",_o,[o("img",{src:l.value,onClick:D,class:"login-code-img",onKeyup:le(x,["enter"])},null,40,wo)])]),_:1}),e(K,{modelValue:s.value.rememberMe,"onUpdate:modelValue":r[3]||(r[3]=S=>s.value.rememberMe=S),style:{margin:"0px 0px 5px 0px"}},{default:t(()=>[...r[6]||(r[6]=[R("记住密码",-1)])]),_:1},8,["modelValue"]),o("span",{style:{"margin-left":"35%",cursor:"pointer",color:"blue"},onClick:H},"还没有账号？去注册 >"),o("span",{style:{"margin-left":"75%",cursor:"pointer",color:"blue"},onClick:I},"重置密码 >"),e(U,null,{default:t(()=>[e(F,{loading:i.value,type:"primary",style:{width:"100%"},onClick:x},{default:t(()=>[i.value?(p(),E("span",bo,"登 录 中...")):(p(),E("span",yo,"登 录"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),e(X,{"align-center":!0,modelValue:g.value,"onUpdate:modelValue":r[4]||(r[4]=S=>g.value=S),draggable:!0,width:T.value,modal:!1,"append-to-body":!0},{default:t(()=>[Ae(e(vo,{closeDialog:h},null,512),[[fe,g.value]])]),_:1},8,["modelValue","width"])])}}},Co=ee(Eo,[["__scopeId","data-v-69a7757c"]]),ko={class:"register-code"},xo=["src"],Vo={key:0},Do={key:1},Mo={class:"slider-container"},To={class:"slider-button"},Bo={__name:"register",setup(c){const n=u(),l=u({username:"",nickName:"",password:"",confirmPassword:"",code:"",uuid:"",emailCode:""}),s={username:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"},{min:6,max:20,message:"用户密码长度必须介于 6 和 20 之间，且数字和英文混合",trigger:"blur"},{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,20}$/,message:"密码必须是数字和英文混合",trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"请再次输入您的密码"},{required:!0,validator:(r,A,U)=>{l.value.password!==A?U(new Error("两次输入的密码不一致")):U()},trigger:"blur"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}],emailCode:[{required:!0,trigger:"change",message:"请输入邮箱验证码"}]},k=u(""),y=u(!1),g=u(!0),w=u("发送邮箱验证码"),T=u(!1);let v=null;const x=u(!1),B=u(0),D=u(!1),M=u(!1);function H(){if(!l.value.username){G.info("请先输入邮箱");return}x.value=!0,B.value=0,D.value=!1,M.value=!1}function Y(r){r===100&&(D.value=!0,M.value=!0,setTimeout(()=>{x.value=!1,I()},500))}function I(){if(!l.value.username){G.info("请先输入邮箱");return}T.value=!0;let r=10;w.value=`${r}分钟 后重试`,v=setInterval(()=>{r--,r<=0?(clearInterval(v),T.value=!1,w.value="发送邮箱验证码"):w.value=`邮箱中已有验证码，或请 ${r}分钟 后重试`},1e3*60*10),ae.get("/login/getMailCode",{params:{toEMail:l.value.username}}).then(A=>{A.code===200?G.success("验证码已发送，请查收邮箱"):(ue.alert(A.msg||"邮箱不存在！ 或其他错误，请联系开发者","系统提示",{confirmButtonText:"OK"}),clearInterval(v),T.value=!1,w.value="发送邮箱验证码")}).catch(()=>{clearInterval(v),T.value=!1,w.value="发送邮箱验证码"})}function h(){n.value.validate(r=>{r&&(y.value=!0,ae.post("/register",l.value).then(A=>{const U=l.value.username;A.code===200?ue.alert("<font color='red'>恭喜你，您的账号 "+U+" 注册成功！</font>","系统提示",{dangerouslyUseHTMLString:!0,type:"success"}).then(()=>{}).catch(()=>{}):(G.error(A.msg),y.value=!1,g&&a())}).catch(()=>{y.value=!1,g&&a()}))})}function a(){ae.get("/captchaImage").then(r=>{g.value=r.captchaEnabled===void 0?!0:r.captchaEnabled,g.value&&(k.value="data:image/gif;base64,"+r.img,l.value.uuid=r.uuid)})}return a(),(r,A)=>{const U=d("el-button"),K=d("el-input"),F=d("el-form-item"),j=d("el-form"),X=d("el-icon"),S=d("el-slider"),de=d("el-dialog");return p(),E("div",null,[e(j,{ref_key:"registerRef",ref:n,model:l.value,rules:s,class:"register-form"},{default:t(()=>[A[10]||(A[10]=o("h3",{class:"title"},"注册",-1)),e(F,{prop:"username"},{default:t(()=>[e(K,{modelValue:l.value.username,"onUpdate:modelValue":A[0]||(A[0]=b=>l.value.username=b),type:"text",size:"large",clearable:"","prefix-icon":"Avatar","auto-complete":"off",placeholder:"邮箱-用于登录"},{append:t(()=>[e(U,{type:"primary",disabled:T.value,size:"small",style:{padding:"0","font-weight":"500"},onClick:H},{default:t(()=>[...A[8]||(A[8]=[R("发送邮箱验证码",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(F,null,{default:t(()=>[e(K,{modelValue:l.value.nickName,"onUpdate:modelValue":A[1]||(A[1]=b=>l.value.nickName=b),type:"text",maxlength:"10",size:"large",clearable:"",placeholder:"昵称--平台昵称--后续不可更改"},null,8,["modelValue"])]),_:1}),e(F,{prop:"emailCode"},{default:t(()=>[e(K,{modelValue:l.value.emailCode,"onUpdate:modelValue":A[2]||(A[2]=b=>l.value.emailCode=b),type:"text",maxlength:"4",size:"large",clearable:"",placeholder:"请输入邮箱验证码"},null,8,["modelValue"])]),_:1}),e(F,{prop:"password"},{default:t(()=>[e(K,{modelValue:l.value.password,"onUpdate:modelValue":A[3]||(A[3]=b=>l.value.password=b),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"密码",onKeyup:le(h,["enter"])},null,8,["modelValue"])]),_:1}),e(F,{prop:"confirmPassword"},{default:t(()=>[e(K,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":A[4]||(A[4]=b=>l.value.confirmPassword=b),type:"password",size:"large","show-password":"","prefix-icon":"Lock","auto-complete":"off",placeholder:"确认密码",onKeyup:le(h,["enter"])},null,8,["modelValue"])]),_:1}),g.value?(p(),q(F,{key:0,prop:"code"},{default:t(()=>[e(K,{size:"large",modelValue:l.value.code,"onUpdate:modelValue":A[5]||(A[5]=b=>l.value.code=b),"auto-complete":"off",clearable:"",placeholder:"请输入右侧验证码",style:{width:"63%"},onKeyup:le(h,["enter"])},{prefix:t(()=>[...A[9]||(A[9]=[o("img",{src:Ne,style:{width:"16px"}},null,-1)])]),_:1},8,["modelValue"]),o("div",ko,[o("img",{src:k.value,onClick:a,class:"register-code-img"},null,8,xo)])]),_:1})):L("",!0),e(F,{style:{width:"100%"}},{default:t(()=>[e(U,{loading:y.value,size:"large",type:"primary",style:{width:"100%"},onClick:ve(h,["prevent"])},{default:t(()=>[y.value?(p(),E("span",Do,"注 册 中...")):(p(),E("span",Vo,"注 册"))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),e(de,{modelValue:x.value,"onUpdate:modelValue":A[7]||(A[7]=b=>x.value=b),title:"安全验证",width:"300px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":""},{default:t(()=>[o("div",Mo,[A[11]||(A[11]=o("div",{class:"slider-text"},"请滑动至最右侧完成验证",-1)),e(S,{modelValue:B.value,"onUpdate:modelValue":A[6]||(A[6]=b=>B.value=b),min:0,max:100,step:1,"show-tooltip":!1,disabled:D.value,onChange:Y},{button:t(()=>[o("div",To,[M.value?(p(),q(X,{key:1},{default:t(()=>[e(V(Ye))]),_:1})):(p(),q(X,{key:0},{default:t(()=>[e(V(Qe))]),_:1}))])]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue"])])}}},So=ee(Bo,[["__scopeId","data-v-7a08e4c9"]]),Uo={class:"avatar-wrapper"},Io=["innerHTML"],Ro={__name:"userHome",setup(c){const n=At(),l=u(!1),i=u(!1),s=he(),k=u(!1);function y(){l.value=!0,i.value=!1}let g="400px";function w(){s.value&&(g="95%")}w();function T(){ue.confirm("确定退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{mt(),ge.show=!1}).catch(()=>{})}function v(){l.value=!1,i.value=!0}function x(){l.value=!1}function B(){}return ie(()=>n.loginVisible,D=>{l.value=D}),(D,M)=>{const H=d("User"),Y=d("el-icon"),I=d("caret-bottom"),h=d("el-dropdown-item"),a=d("router-link"),r=d("el-dropdown-menu"),A=d("el-dropdown"),U=d("el-dialog");return p(),E(oe,null,[e(A,{onCommand:B,class:"right-menu-item hover-effect",trigger:"hover"},{dropdown:t(()=>[e(r,null,{default:t(()=>[e(a,{to:"/me-post"},{default:t(()=>[e(h,null,{default:t(()=>[...M[4]||(M[4]=[R("我的帖子",-1)])]),_:1})]),_:1}),e(a,{to:"/me-memes"},{default:t(()=>[e(h,null,{default:t(()=>[...M[5]||(M[5]=[R("我的投稿",-1)])]),_:1})]),_:1}),V(ge).show?L("",!0):(p(),q(h,{key:0,command:"login",divided:""},{default:t(()=>[o("span",{onClick:y},"登录/注册")]),_:1})),e(a,{to:"/userInfo"},{default:t(()=>[e(h,null,{default:t(()=>[...M[6]||(M[6]=[R("个人中心",-1)])]),_:1})]),_:1}),e(h,{command:"login"},{default:t(()=>[o("span",{onClick:M[0]||(M[0]=K=>k.value=!0)},"隐私政策")]),_:1}),V(ge).show?(p(),q(h,{key:1,divided:"",command:"logout"},{default:t(()=>[o("span",{onClick:T},"退出登录")]),_:1})):L("",!0)]),_:1})]),default:t(()=>[o("div",Uo,[e(Y,{size:"32"},{default:t(()=>[e(H)]),_:1}),e(Y,null,{default:t(()=>[e(I)]),_:1})])]),_:1}),e(U,{"align-center":!0,modelValue:l.value,"onUpdate:modelValue":M[1]||(M[1]=K=>l.value=K),draggable:!0,width:V(g),modal:!1,"append-to-body":!0},{default:t(()=>[Ae(e(Co,{onRegister:v,closeDialog:x},null,512),[[fe,l.value]])]),_:1},8,["modelValue","width"]),e(U,{"align-center":!0,modelValue:i.value,"onUpdate:modelValue":M[2]||(M[2]=K=>i.value=K),draggable:!0,width:V(g),modal:!1,"append-to-body":!0},{default:t(()=>[Ae(e(So,null,null,512),[[fe,i.value]])]),_:1},8,["modelValue","width"]),e(U,{modelValue:k.value,"onUpdate:modelValue":M[3]||(M[3]=K=>k.value=K),title:"社区规范与隐私政策",style:{position:"fixed",top:"0",left:"0",right:"0",bottom:"0",margin:"auto"},width:V(g),modal:!1,"append-to-body":!0},{default:t(()=>[o("div",{innerHTML:V(vt)},null,8,Io)]),_:1},8,["modelValue","width"])],64)}}},Ko=ee(Ro,[["__scopeId","data-v-2e331c24"]]),Qo={class:"header"},Yo={class:"header-content"},zo={class:"logo-link"},Po={class:"elinput-mobile"},Oo={class:"header-actions"},Fo={class:"elinput"},Ho={class:"user-message"},qo={class:"unread-badge"},Lo={class:"icon-img"},Jo={class:"dialog-header"},No={class:"dialog-header"},Be="我还没有加载完喔~~",Wo="https://cdn.hguofichp.cn/power.png",Go=me({__name:"header-bar",setup(c){const n=he(),l=Je(),i=u(!1),s=u(!1),k=u([]),y=u(!0),g=u(!0);async function w(){const b=await st();b&&(k.value=b,y.value=!1)}function T(){s.value=!0,v.value=!1,y.value=!0,w()}const v=u(!1),x=u([]),B=u(!0);async function D(){const b=await nt();b&&(x.value=b,B.value=!1)}function M(){s.value=!1,v.value=!0,B.value=!0,D()}const H=ne(()=>!(n.value&&l.path!=="/home"));w();const Y=u(0);setInterval(()=>{const b=k.value.length;Y.value=(Y.value+1)%b},5e3);const I=u(""),h=u(""),a=u(!1);function r(){if(I.value.trim()===""){G.warning("请输入搜索内容");return}a.value=!0,h.value=I.value}function A(b){var _;b.preventDefault(),b.stopPropagation(),r(),(_=b.target)==null||_.blur()}const U=ne(()=>n.value?"100%":"35%");ne(()=>n.value?"90%":"35%");const K=u(0),F=u(0),j=ne(()=>K.value+F.value),X=u(!1);async function S(){try{const b=await ae.get("/machine/SysMessage/getMsgNum");b.code===200&&(K.value=b.data.likeAndStatementNum,F.value=b.data.commentNum,X.value=b.data.readFlag)}catch(b){console.error("获取消息数量失败:",b)}}Re(()=>{S(),setInterval(()=>{S()},10*60*1e3),setTimeout(()=>{i.value=!0,setInterval(()=>{i.value=!0},2*60*60*1e3)},60*60*1e3),setTimeout(()=>{g.value=!1},5e3)});const de=()=>{window.open("https://www.wjx.cn/vm/rQUgnS0.aspx#")};return u(!1),(b,_)=>{const f=d("el-icon"),m=d("el-button"),z=d("el-input"),P=d("el-tooltip"),N=d("el-image"),Z=d("el-dropdown-item"),J=d("router-link"),W=d("el-dropdown-menu"),_e=d("el-dropdown"),we=d("el-dialog");return p(),E("div",Qo,[o("div",Yo,[o("div",zo,[_[8]||(_[8]=o("a",{href:"https://www.douyu.com/6657",target:"_blank"},[o("img",{src:wt,alt:"大🐖头",class:"logo-img"}),o("p",{class:"header-title"},"斗鱼玩机器烂梗库")],-1)),o("div",Po,[e(z,{modelValue:I.value,"onUpdate:modelValue":_[0]||(_[0]=O=>I.value=O),type:"search",placeholder:"输入以搜索烂梗...",clearable:"",onKeyup:le(A,["enter","native"])},{append:t(()=>[e(m,{type:"primary",onClick:r},{default:t(()=>[e(f,null,{default:t(()=>[e(V(xe))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),o("div",Oo,[H.value?(p(),E("img",{key:0,src:yt,alt:"热门",class:"hot-barrage-img",onClick:T})):L("",!0),H.value?(p(),E("div",{key:1,onClick:T,class:"hot-barrage"},[e(Ie,{name:"fade"},{default:t(()=>{var O,C;return[(p(),E("span",{key:Y.value,class:"hot-barrage-span"},"热门："+Q(((C=(O=k.value)==null?void 0:O[Y.value])==null?void 0:C.content)||""),1))]}),_:1})])):L("",!0),o("div",Fo,[e(z,{modelValue:I.value,"onUpdate:modelValue":_[1]||(_[1]=O=>I.value=O),type:"search",placeholder:"输入以搜索烂梗...",clearable:"",onKeyup:le(A,["enter","native"])},{append:t(()=>[e(m,{type:"primary",onClick:r},{default:t(()=>[e(f,null,{default:t(()=>[e(V(xe))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(m,{type:"primary",onClick:de,class:"complaint-button"},{default:t(()=>[..._[9]||(_[9]=[R(" 上传照片 ",-1),o("br",null,null,-1),R(" 建议/提交BUG ",-1)])]),_:1}),e(P,{effect:"light",content:"接程序设计，广告，商务，详情联系邮箱 he20020928@foxmail.com",placement:"bottom"},{default:t(()=>[..._[10]||(_[10]=[o("img",{src:bt,alt:"heihei",class:"icon-container icon-img"},null,-1)])]),_:1}),_[12]||(_[12]=tt('<a class="icon-container" href="https://sb6657.cn/#/Tampermonkey" data-v-55f7bc17><img src="https://pic.imgdb.cn/item/6704f830d29ded1a8c738f70.png" alt="油猴" class="icon-img" data-v-55f7bc17></a><a class="icon-container" href="https://yuba.douyu.com/feed/2639094748291342931" target="_blank" data-v-55f7bc17><img src="'+Et+'" alt="douyu" class="icon-img" data-v-55f7bc17></a><a class="icon-container" href="https://github.com/SEhzm/sb6657/" target="_blank" data-v-55f7bc17><img src="'+Ct+'" alt="github" class="icon-img" data-v-55f7bc17></a>',3)),e(P,{visible:g.value,"onUpdate:visible":_[3]||(_[3]=O=>g.value=O),content:"如果你喜欢这个网站，可以点我进行赞赏或GitHub点个star~",placement:"bottom",effect:"light"},{default:t(()=>[e(N,{class:"icon-container icon-img",src:Wo,fit:"cover",onClick:_[2]||(_[2]=O=>i.value=!0)})]),_:1},8,["visible"]),e(_e,{trigger:"hover"},{dropdown:t(()=>[e(W,null,{default:t(()=>[e(J,{to:"/me-msg"},{default:t(()=>[e(Z,null,{default:t(()=>[R("评论 ("+Q(F.value)+")",1)]),_:1}),e(Z,null,{default:t(()=>[R("赞和表态 ("+Q(K.value)+")",1)]),_:1})]),_:1})]),_:1})]),default:t(()=>[o("div",Ho,[_[11]||(_[11]=o("div",{class:"message-icon"},[o("img",{src:kt,alt:"msg"}),o("div",null,"消息")],-1)),o("span",qo,Q(j.value||"0"),1)])]),_:1}),o("div",Lo,[e(Ko)])])]),e(De,{modelValue:s.value,"onUpdate:modelValue":_[4]||(_[4]=O=>s.value=O),memeArr:k.value,loading:y.value,emptyText:Be,onRefresh:w},{default:t(()=>[o("div",Jo,[_[14]||(_[14]=o("div",null,"24h热门烂梗",-1)),o("div",null,[e(m,{onClick:M},{default:t(()=>[..._[13]||(_[13]=[R("查看近七天热门",-1)])]),_:1})])])]),_:1},8,["modelValue","memeArr","loading"]),e(De,{modelValue:v.value,"onUpdate:modelValue":_[5]||(_[5]=O=>v.value=O),memeArr:x.value,loading:B.value,emptyText:Be,onRefresh:D},{default:t(()=>[o("div",No,[_[16]||(_[16]=o("div",null,"七天热门烂梗",-1)),o("div",null,[e(m,{onClick:T},{default:t(()=>[..._[15]||(_[15]=[R("查看近24h热门",-1)])]),_:1})])])]),_:1},8,["modelValue","memeArr","loading"]),e(no,{modelValue:a.value,"onUpdate:modelValue":_[6]||(_[6]=O=>a.value=O),searchKey:h.value},null,8,["modelValue","searchKey"]),e(we,{modelValue:i.value,"onUpdate:modelValue":_[7]||(_[7]=O=>i.value=O),title:"谢谢你",width:U.value},{default:t(()=>[..._[17]||(_[17]=[o("img",{src:"http://cdn.hguofichp.cn/zfb.jpg",alt:"",width:"100%"},null,-1)])]),_:1},8,["modelValue","width"])])}}}),Xo=ee(Go,[["__scopeId","data-v-55f7bc17"]]),Zo={class:"footer"},jo={class:"content"},$o={class:"date-font"},el=me({__name:"footer-bar",setup(c){const n=u(0),l=new Date("2026-02-16"),i=new Date;n.value=Math.ceil((l.getTime()-i.getTime())/(1e3*3600*24));const s=new Date("2024-02-07"),k=ne(()=>{const g=new Date().getTime()-s.getTime();return Math.floor(g/(1e3*60*60*24))});return(y,g)=>(p(),E("div",Zo,[o("div",jo,[o("div",$o,[g[0]||(g[0]=R("距服务器到期还有",-1)),o("span",null,Q(n.value),1),g[1]||(g[1]=R("天",-1))]),o("div",null,[g[2]||(g[2]=o("a",{href:"https://ipw.cn/ipv6webcheck/?site=sb6657.cn",title:"",target:"_blank",style:{color:"black"}},[o("img",{style:{display:"inline-block","vertical-align":"middle",width:"150px"},alt:"",src:"https://static.ipw.cn/icon/ipv6-s5.svg"})],-1)),R(" 本站已运行"+Q(k.value)+"天 ",1)])])]))}}),tl=ee(el,[["__scopeId","data-v-c95cf16c"]]),We=ft("guibin",{state:()=>({Oni:""}),actions:{updateOni(c){this.Oni=c}}}),ol=We();class ll{constructor(n,l){ce(this,"timer",null);ce(this,"ws",null);ce(this,"rid");ce(this,"msgHandler");this.rid=n,this.msgHandler=l,"WebSocket"in window&&this.connect()}connect(){const n=sl(2,5);this.ws=new WebSocket(`wss://danmuproxy.douyu.com:850${n}`),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{this.ws.send(ye(`type@=loginreq/roomid@=${this.rid}`)),this.ws.send(ye(`type@=joingroup/rid@=${this.rid}/gid@=-9999/`)),this.timer=window.setInterval(()=>{this.ws.send(ye("type@=mrkl/"))},4e4)},this.ws.onerror=()=>{this.close()},this.ws.onmessage=l=>{const i=new FileReader;i.onload=()=>{const s=String(i.result).split("\0");for(let k=0;k<s.length;k++)s[k].length>12&&this.msgHandler(s[k])},i.readAsText(new Blob([l.data]))},this.ws.onclose=()=>{this.close(),this.reconnect()}}reconnect(){setTimeout(()=>{this.connect()},3e3)}close(){this.timer!==null&&(clearInterval(this.timer),this.timer=null),this.ws&&(this.ws.close(),this.ws=null)}}function ye(c){let l=al(c);const i=l.length+4+4+2+1+1+1,s=new Uint8Array(i),k=new Uint8Array(l.length);for(let w=0;w<k.length;w++)k[w]=l[w];const y=new Uint32Array([l.length+4+2+1+1+1]),g=new Uint32Array([689]);return s.set(new Uint8Array(y.buffer),0),s.set(new Uint8Array(y.buffer),4),s.set(new Uint8Array(g.buffer),8),s.set(k,12),s}function al(c){const n=[],l=c.length;for(let i=0;i<l;i++){const s=c.charCodeAt(i);s>=65536&&s<=1114111?(n.push(s>>18&7|240),n.push(s>>12&63|128),n.push(s>>6&63|128),n.push(s&63|128)):s>=2048&&s<=65535?(n.push(s>>12&15|224),n.push(s>>6&63|128),n.push(s&63|128)):s>=128&&s<=2047?(n.push(s>>6&31|192),n.push(s&63|128)):n.push(s&255)}return n}function sl(c,n){return Math.floor(Math.random()*(n-c+1))+c}function pe(c,n,l){const i=c.indexOf(n);if(i===-1)return"";const s=c.indexOf(l,i+n.length);return s===-1?"":c.substring(i+n.length,s)}function nl(c){const n=c.match(/type@=(.*?)(\/|@)/),l=pe(c,"oni/vn@=","/");if(l&&ol.updateOni(l),n&&n[1]==="rss"){pe(c,"rid@=","/");const i=pe(c,"ss@=","/"),s=pe(c,"ivl@=","/");console.log(i),i==="1"&&s==="0"&&il()}}function il(){if(!("Notification"in window)){alert("当前浏览器不支持开播通知");return}Notification.permission!=="granted"?Notification.requestPermission().then(c=>{c==="granted"?Se():alert("你拒绝了通知权限，无法收到开播通知，请在网址左侧打开权限")}):Se()}function Se(){const c=new Notification("来自sb6657.cn开播提醒",{body:"6657直播间已开播，快去观看吧！"});c.onclick=()=>{window.focus(),window.open("https://www.douyu.com/6657","_blank")}}const rl={class:"tab"},ul={class:"tab-container"},dl=["onClick"],cl={class:"main-content"},Al={class:"sidebar"},ml={class:"sidebar-icon"},pl=["src"],gl={class:"content"},fl={class:"version"},vl={class:"GuiBin"},hl=me({__name:"MainLayout",setup(c){const n=Je(),l=ht(),i=We();Ce().setMemeTags();const k=ne(()=>i.Oni),y=u();Re(()=>{const w=document.querySelector("#global-loading");w&&(w.classList.add("fade-out"),setTimeout(()=>w.remove(),500)),y.value=new ll(6979222,nl)});function g(w){l.push(w)}return(w,T)=>{const v=d("el-menu-item"),x=d("el-menu"),B=d("router-view");return p(),E(oe,null,[o("div",null,[e(Xo),o("div",rl,[o("div",ul,[(p(!0),E(oe,null,re(V(Ve),(D,M)=>(p(),E("div",{class:ot(`tab1 ${D.path===V(n).path?"selected":"none"}`),key:D.path,onClick:H=>g(D.path)},Q(D.text),11,dl))),128))])]),o("div",cl,[o("div",Al,[e(x,{router:"",class:"sidebar-el-menu","default-active":w.$route.path},{default:t(()=>[(p(!0),E(oe,null,re(V(Ve),(D,M)=>(p(),q(v,{key:D.path,index:D.path},{default:t(()=>[o("div",ml,[o("img",{src:D.icon,alt:""},null,8,pl)]),o("span",null,Q(D.text),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),o("div",gl,[e(B)])]),e(tl)]),e(V(_t),{to:"/update"},{default:t(()=>[o("span",fl,"版本: "+Q(V(pt)),1)]),_:1}),T[0]||(T[0]=o("div",{class:"GuangGaoWei"},[o("span",{style:{display:"flex","font-size":"large",color:"white"}},"广告位招租")],-1)),o("div",vl,"当前直播间贵宾数:"+Q(k.value),1)],64)}}}),Fl=ee(hl,[["__scopeId","data-v-edbc3a29"]]);export{Fl as default};
