import{n as z,o as R,p as A,b as N,l as q,a as k,e as I,k as w,c as L,d as $,r as j,q as D,v as O}from"./element-plus.C3kSHAgf.js";import{u as W,b as Z}from"./vue-router.DkBAQHKx.js";import{M as H,_ as J}from"./index.Cz9wgtNn.js";import{e as G,f as K,c as X,a as Y,p as ee,t as te,l as oe,b as ae}from"./setMeme.DtxqKU7U.js";import{d as P,az as le,Z as ne,o as E,M as U,O as l,a as g,U as e,S as p,k as re,r as f,w as se,c as ie,P as ue,F as ce}from"./@vue.kwc71ESp.js";import"./lodash-es.CiJSjksT.js";import"./@vueuse.Bmvu7DnR.js";import"./@element-plus.CQ2moJ0T.js";import"./@popperjs.D9SI2xQl.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.CdCgAjqw.js";import"./async-validator.DKvM95Vc.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.B6fDCfyv.js";import"./@floating-ui.8uccrNCM.js";import"./axios.CCb-kr4I.js";const me={class:"dialog-footer"},pe=P({__name:"submission-dialog",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(M){const i=le(M,"modelValue"),h={category:[{required:!0,message:"请选择分栏",trigger:"blur"}],content:[{required:!0,message:"请输入弹幕",trigger:"blur"}]},a=ne({category:"",content:""});async function c(){return a.content===""?(w.error("烂梗内容不能为空"),!1):a.category===""?(w.error("分类不能为空"),!1):await G(a.category,a.content)?(w.success("投稿成功，审核完成后展示(一天内)"),!0):(w.error("投稿失败，必要时请及时反馈bug"),!1)}async function v(){await c()&&(i.value=!1,a.content="",a.category="")}async function b(){await c()&&(a.content="")}return(m,o)=>{const r=z,V=R,y=A,C=N,d=q,_=k,n=I;return E(),U(n,{modelValue:i.value,"onUpdate:modelValue":o[3]||(o[3]=t=>i.value=t),draggable:"",title:"投稿弹幕",width:"82%"},{footer:l(()=>[g("div",me,[e(_,{onClick:o[2]||(o[2]=t=>i.value=!1)},{default:l(()=>o[4]||(o[4]=[p("关闭")])),_:1}),e(_,{type:"primary",onClick:v},{default:l(()=>o[5]||(o[5]=[p("投稿并关闭")])),_:1}),e(_,{type:"primary",onClick:b},{default:l(()=>o[6]||(o[6]=[p("连续投稿")])),_:1})])]),default:l(()=>[e(d,{model:a,"label-width":"100px",rules:h,"label-position":"right"},{default:l(()=>[e(y,{label:"分栏","label-width":100,prop:"category"},{default:l(()=>[e(V,{modelValue:a.category,"onUpdate:modelValue":o[0]||(o[0]=t=>a.category=t),placeholder:"选择上传的分栏"},{default:l(()=>[e(r,{label:"喷玩机器篇",value:"machine_penWJQ"}),e(r,{label:"木柜子篇",value:"machine_mygo"}),e(r,{label:"直播间互喷篇",value:"machine_ZbjHuPen"}),e(r,{label:"喷选手篇",value:"machine_penPlayer"}),e(r,{label:"+1",value:"machine_p1"}),e(r,{label:"群魔乱舞篇",value:"machine_QMLW"}),e(r,{label:"QUQU",value:"machine_QUQU"})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"弹幕内容",prop:"content"},{default:l(()=>[e(C,{maxlength:"255",modelValue:a.content,"onUpdate:modelValue":o[1]||(o[1]=t=>a.content=t),autocomplete:"off",autosize:{minRows:2,maxRows:4},"show-word-limit":"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),de={class:"cardTable",style:{position:"relative"}},_e={class:"pagination-wrapper"},x=50,fe=P({__name:"memes-view",setup(M){const i=W(),h=Z(),a=re(()=>H.find(n=>n.path===i.path)),c=f(!0),v=f([]),b=f(0),m=f(1);async function o(n){var u;const t=(u=a.value)==null?void 0:u.category;if(!t){h.push("/404");return}const s=await K(t,n,x);s&&(v.value=s.memeArr,b.value=s.total,c.value=!1)}o(1),se(()=>i.path,()=>{console.log("当前页面path:",i.path),m.value=1,c.value=!0,o(1)});const r=()=>{window.scrollTo({top:0,behavior:"smooth"})},V=n=>{m.value=n,r(),o(n)},y=te(ae,oe,2e3);async function C(n){const t=n.content,s=y(t);if(!(!s||s==="limitedSuccess")){if(X(),await Y(n.category,n.id,m.value,x)){await o(m.value);return}ee()}}const d=f(!1),_=()=>{d.value=!0};return(n,t)=>{const s=k,u=L,T=$,S=j,B=D,F=O;return E(),ie(ce,null,[g("div",null,[g("div",de,[e(s,{type:"primary",class:"handleAdd",onClick:_},{default:l(()=>t[1]||(t[1]=[p("烂梗投稿")])),_:1}),ue((E(),U(T,{stripe:"",data:v.value,"empty-text":"我还没有加载完喔~~",class:"eldtable","header-cell-style":{color:"#ff0000",fontSize:"13px",whitespace:"normal !important"},"cell-style":{cursor:"Pointer"},onRowClick:C},{default:l(()=>[e(u,{width:"58",prop:"id",label:"序号"}),e(u,{prop:"content","min-width":"90",label:"弹幕"}),e(u,{label:"",align:"center",width:"85"},{default:l(()=>[e(s,{type:"primary",label:"操作"},{default:l(()=>t[2]||(t[2]=[p("复制")])),_:1})]),_:1}),e(u,{prop:"copyCount",label:"复制次数",width:"55"})]),_:1},8,["data"])),[[F,c.value]])]),g("div",_e,[g("div",null,[e(S,{background:"red",layout:"prev, pager, next, jumper","current-page":m.value,total:b.value,"pager-count":4,"page-size":x,onCurrentChange:V},null,8,["current-page","total"])])])]),e(pe,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=Q=>d.value=Q)},null,8,["modelValue"]),e(B,{right:50,bottom:50},{default:l(()=>t[3]||(t[3]=[p("UP")])),_:1})],64)}}}),Be=J(fe,[["__scopeId","data-v-2d269702"]]);export{Be as default};
