import{d as oe,h as l,f as se,U as ne,al as r,ar as le,c as _,o as c,a as e,R as s,Q as $,a6 as R,J as n,K as re,I as x,O as k,P as i,u as h,L as W,W as ie}from"./@vue.BltuATdo.js";import{V as ce,n as j}from"./@element-plus.D0bpsst8.js";import{h as F,_ as de}from"./index.B4Mr7ZV4.js";import{f as ue,t as me}from"./flip-num.BkpjeUo1.js";import{c as pe,a as _e,p as he,l as ve,b as ge}from"./setMeme.C4UhU9RD.js";import{u as fe,g as ye,e as we}from"./time.Bm-xCisx.js";import{a as y}from"./element-plus.BELI2msV.js";import"./pinia.DfSVr1RC.js";import"./axios.ngrFHoWO.js";import"./js-cookie.Cz0CWeBA.js";import"./vue-router.BFvkXMb7.js";import"./lodash-es.CDeyng3v.js";import"./@vueuse.BO4JNAXw.js";import"./@popperjs.D_chPuIy.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.BKG3DVjA.js";import"./async-validator.9PlIezaS.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.BQoi3Ox2.js";import"./@floating-ui.D0iZPv2f.js";const be={class:"match-library"},Te={class:"match-list"},Ce={class:"card-content"},xe={class:"image-container"},ke=["src"],Le={class:"match-info"},Se={class:"match-header"},ze={class:"match-name"},Me={class:"match-details"},Ve={class:"match-location"},Pe={class:"match-time"},Ee={class:"time-item"},Ne={class:"time-item"},Be={class:"pagination-container"},De={class:"memes-view"},Ue={class:"card-table"},Ie=["onTouchstart","onTouchend"],$e={class:"barrage-text"},Re={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},We=["src"],je={style:{"vertical-align":"middle"}},Fe={style:{position:"absolute",bottom:"0",right:"0","font-size":"11px","min-width":"170px"}},Je={class:"pagination-wrapper"},Ke=oe({__name:"matchLib",setup(Oe){const L=fe(),S=l([]),z=l(0),v=l(1),J=l(20),w=l(!1),g=l(null),M=l([]),f=l(!1),V=l(0),b=l(50),m=l(1),P=l([]),K=me(ge,ve,2e3),E=l(window.innerWidth<=768),N=()=>{E.value=window.innerWidth<=768},B=async()=>{try{const t=await F.get("/machine/getMatchList",{params:{pageNum:v.value,pageSize:J.value}});t.code===200?(S.value=t.data.list,z.value=t.data.total):y.error(t.msg||"Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•")}catch(t){y.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñËµõ‰∫ãÂàóË°®Â§±Ë¥•:",t)}},O=t=>{v.value=t,B()},Q=t=>{g.value=t,w.value=!0,m.value=1,T(1)},T=async t=>{if(g.value){f.value=!0;try{const o=await F.get("/machine/matchPageList",{params:{pageNum:t,pageSize:b.value,matchId:g.value.id}});o.code===200?(M.value=o.data.list,V.value=o.data.total):y.error(o.msg||"Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•")}catch(o){y.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•"),console.error("Ëé∑ÂèñÁÉÇÊ¢óÂàóË°®Â§±Ë¥•:",o)}finally{f.value=!1}}},D=async t=>{const o=t.barrage,u=K(o);if(!(!u||u==="limitedSuccess")){pe();try{if(await _e("match",t.id,m.value,b.value)){await T(m.value);return}}catch(p){console.error("Â§çÂà∂Ê¨°Êï∞+1Â§±Ë¥•:",p)}he()}},q=t=>{m.value=t,T(t)};L.tagsLoaded.then(()=>{P.value=L.memeTags});const A=t=>{t.touchStartTime=Date.now()},G=t=>{Date.now()-t.touchStartTime>100&&(t.popoverVisible=!0,setTimeout(()=>{t.popoverVisible=!1},1500))};return se(()=>{B(),window.addEventListener("resize",N)}),ne(()=>{window.removeEventListener("resize",N)}),(t,o)=>{var I;const u=r("el-tag"),p=r("el-icon"),H=r("el-card"),U=r("el-pagination"),C=r("el-table-column"),X=r("el-popover"),Y=r("el-button"),Z=r("el-table"),ee=r("el-dialog"),te=le("loading");return c(),_("div",be,[o[3]||(o[3]=e("div",{class:"card"},[e("span",null,"ÊäïÁ®øÊó∂ÂãæÈÄâÂÖ≥ËÅîËµõ‰∫ãÂ∫ìÂ∞ÜÂä†ÂÖ•Êüê‰∏ÄËµõ‰∫ãÂàõ‰ΩúÁöÑÁÉÇÊ¢óÔºåÁõÆÂâçÂè™Êî∂ÂΩïÂ§ßÂûãËµõ‰∫ã"),e("p",null,"È°µÈù¢‰ªÖÂ±ïÁ§∫Êî∂ÂΩï‰∫éËµõ‰∫ãÊúüÈó¥Âàõ‰ΩúÁöÑÁÉÇÊ¢ó")],-1)),e("div",Te,[(c(!0),_($,null,R(S.value,a=>(c(),x(H,{key:a.id,class:"match-card","body-style":{padding:"0px"},onClick:d=>Q(a)},{default:n(()=>[e("div",Ce,[e("div",xe,[e("img",{src:a.matchesImg,class:"match-image"},null,8,ke)]),e("div",Le,[e("div",Se,[e("h3",ze,i(a.matchesName),1),s(u,{size:"small",type:"success",class:"match-level"},{default:n(()=>[k(i(a.level),1)]),_:2},1024)]),e("div",Me,[e("div",Ve,[s(p,null,{default:n(()=>[s(h(ce))]),_:1}),e("span",null,i(a.matchesLocation),1)]),e("div",Pe,[e("div",Ee,[s(p,null,{default:n(()=>[s(h(j))]),_:1}),e("span",null,"ÂºÄÂßãÔºö"+i(a.startTime),1)]),e("div",Ne,[s(p,null,{default:n(()=>[s(h(j))]),_:1}),e("span",null,"ÁªìÊùüÔºö"+i(a.endTime),1)])])])])])]),_:2},1032,["onClick"]))),128))]),e("div",Be,[s(U,{"current-page":v.value,"onUpdate:currentPage":o[0]||(o[0]=a=>v.value=a),total:z.value,layout:"total,prev, pager, next",onCurrentChange:O},null,8,["current-page","total"])]),s(ee,{modelValue:w.value,"onUpdate:modelValue":o[1]||(o[1]=a=>w.value=a),title:(I=g.value)==null?void 0:I.matchesName,width:E.value?"100%":"75%",class:"match-dialog","destroy-on-close":""},{default:n(()=>[e("div",De,[e("div",Ue,[re((c(),x(Z,{data:M.value,stripe:"","cell-class-name":"hover-pointer","empty-text":"ÊöÇÊó†ÁÉÇÊ¢óÔºåÂø´Êù•ÊäïÁ®øÂêßÔºÅ",onRowClick:D},{default:n(()=>[s(C,{align:"center",width:"60"},{default:n(a=>[s(u,{round:"",effect:"plain"},{default:n(()=>[k(i(a.row.id),1)]),_:2},1024)]),_:1}),s(C,{prop:"barrage"},{default:n(a=>[s(X,{placement:"top",width:"auto",trigger:"hover",visible:a.row.popoverVisible},{reference:n(()=>[e("div",{style:{cursor:"pointer"},onTouchstart:d=>A(a.row),onTouchend:d=>G(a.row)},[e("span",$e,i(a.row.barrage),1)],40,Ie)]),default:n(()=>[e("div",Re,[(c(!0),_($,null,R(h(ye)(a.row.tags,P.value),(d,ae)=>(c(),_("div",{key:ae,style:{"margin-right":"8px"}},[s(u,{round:"",effect:"dark",style:{fontSize:"16px",cursor:"pointer"}},{default:n(()=>[d.iconUrl?(c(),_("img",{key:0,src:d.iconUrl,style:{width:"16px",height:"22px","object-fit":"cover","vertical-align":"middle"}},null,8,We)):W("",!0),e("span",je,i(d.label),1)]),_:2},1024)]))),128)),e("span",Fe," ÊäïÁ®øÊó∂Èó¥: "+i(h(we)(a.row.submitTime)),1)])]),_:2},1032,["visible"])]),_:1}),s(C,{align:"center",width:"100"},{default:n(a=>[s(Y,{type:"primary",class:"copy-btn",onClick:ie(d=>D(a.row),["stop"])},{default:n(()=>[o[2]||(o[2]=k(" Â§çÂà∂ üåà",-1)),s(ue,{num:a.row.cnt},null,8,["num"])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,f.value]]),e("div",Je,[f.value?W("",!0):(c(),x(U,{key:0,background:"",layout:"prev, pager, next, jumper","current-page":m.value,total:V.value,"pager-count":3,"page-size":b.value,onCurrentChange:q},null,8,["current-page","total","page-size"]))])])])]),_:1},8,["modelValue","title","width"])])}}}),mt=de(Ke,[["__scopeId","data-v-ae2f28fa"]]);export{mt as default};
