import{E as r,c as D,d as z,e as N,a as M,b as Q,f as U,g as $,h as j,v as H}from"./element-plus.jwEUB1AR.js";import{d as L,r as c,Z as R,o as b,c as S,a as s,S as k,T as Z,U as e,O as n,a9 as q,P as A,M as F,R as x,ai as G}from"./@vue.kwc71ESp.js";import{h as g,_ as J}from"./index.BXo1qHxE.js";import"./lodash-es.CiJSjksT.js";import"./@vueuse.Bmvu7DnR.js";import"./@element-plus.CQ2moJ0T.js";import"./@popperjs.D9SI2xQl.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.CdCgAjqw.js";import"./async-validator.DKvM95Vc.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.B6fDCfyv.js";import"./@floating-ui.8uccrNCM.js";import"./axios.CCb-kr4I.js";import"./vue-router.DkBAQHKx.js";const W={class:"card pickHome"},X={class:"step"},Y={class:"context"},tt={class:"pickSum"},et={style:{display:"flex"}},at={key:1,class:"pagination-wrapper"},ot=L({__name:"test",setup(lt){const i=c(!1),C=c(0),p=c(localStorage.getItem("pickCnt"));(()=>{localStorage.getItem("pickCnt")===null&&(localStorage.setItem("pickCnt","3"),p.value="3")})();const d=c(!0),v=c(),l=R({tableData:[],total:0,pageSize:10,currentPage:1}),y=()=>{i.value=!0,g.post("/machine/hotTop20/Query",{QueryBarrage:v.value}).then(a=>{var t,o;l.total=((t=a.data)==null?void 0:t.total)||0,l.tableData=((o=a.data)==null?void 0:o.list)||[],d.value=!1})},T=a=>{if(p.value<=0){r.alert("你已经投过三次票了!","等待下一轮投票吧!",{confirmButtonText:"OK"});return}g.post("/machine/hotTop20/pick",{barrageId:a.id,barrage:a.barrage}).then(t=>{t.code==600?r.alert("你已经提名过这条烂梗!","换一条提名吧!",{confirmButtonText:"OK"}):t.code==500?r.alert("你已经投过三次票了!","等待下一轮投票吧!",{confirmButtonText:"OK"}):(r.alert(a.barrage,"你投了一票",{confirmButtonText:"OK"}),p.value-=1,localStorage.setItem("pickCnt",p.value.toString()))}).catch(t=>{r.alert("慢点哟","别别别, 你的手速太快辣",{confirmButtonText:"OK"})})},f=(a=1)=>{d.value=!0,g.get("/machine/hotTop20/loadTop20").then(t=>{var o,u;l.total=((o=t.data)==null?void 0:o.total)||0,l.tableData=((u=t.data)==null?void 0:u.list)||[],d.value=!1}),g.get("/machine/hotTop20/pickSum").then(t=>{console.log(t),C.value=t.data})};f();const B=a=>{l.currentPage=a,f(a)},E=()=>{i.value=!i.value};return(a,t)=>{const o=D,u=z,P=G("Search"),w=N,h=M,I=Q,m=U,K=$,O=j,V=H;return b(),S("div",W,[s("div",X,[s("span",{onClick:E},[s("p",Y,[t[2]||(t[2]=k("2024年度TOP20烂梗评选")),s("span",tt,"总提名数："+Z(C.value),1)]),e(u,{active:1,"finish-status":"success"},{default:n(()=>[e(o,{title:"提名top100",description:"12.11 - 12.17"}),e(o,{title:"提名top50",description:"12.18 - 12.24"}),e(o,{title:"评选",description:"12.25 - 12. 31"}),e(o,{title:"公布",description:"2025.01.01"})]),_:1})]),s("div",et,[e(I,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=_=>v.value=_),placeholder:"先在这搜索烂梗再提名",clearable:"",onKeydown:q(y,["enter"])},{append:n(()=>[e(h,{type:"primary",onClick:y},{default:n(()=>[e(w,null,{default:n(()=>[e(P)]),_:1})]),_:1})]),_:1},8,["modelValue"]),s("span",{onClick:t[1]||(t[1]=_=>i.value=!0)},[e(h,{class:"loadBtn",type:"primary",label:"",onClick:f},{default:n(()=>t[3]||(t[3]=[k("看看提名榜")])),_:1})])])]),i.value?A((b(),F(K,{key:0,stripe:"",data:l.tableData,"empty-text":"你等了这么久,应该是没有这条烂梗,期待投稿",class:"eldtable","header-cell-style":{color:"#ff0000",fontSize:"13px",whitespace:"normal !important"},"cell-style":{}},{default:n(()=>[e(m,{width:"50",prop:"id",label:"序号"}),e(m,{prop:"barrage","min-width":"90",label:"　　　　　　　　　　　　　目前的提名榜"}),e(m,{label:"",align:"center",width:"85"},{default:n(_=>[e(h,{type:"primary",label:"",onClick:st=>T(_.row)},{default:n(()=>t[4]||(t[4]=[k("提名")])),_:2},1032,["onClick"])]),_:1}),e(m,{prop:"pickCnt",label:"提名次数",width:"55"})]),_:1},8,["data"])),[[V,d.value]]):x("",!0),i.value?(b(),S("div",at,[s("div",null,[e(O,{background:"",layout:"prev, pager, next, jumper",total:l.total,"pager-count":4,"page-size":l.pageSize,onCurrentChange:B},null,8,["total","page-size"])])])):x("",!0)])}}}),yt=J(ot,[["__scopeId","data-v-72ceb6c7"]]);export{yt as default};
